var __awaiter=this&&this.__awaiter||function(thisArg,_arguments,P,generator){function adopt(value){return value instanceof P?value:new P(function(resolve){resolve(value)})}return new(P||(P=Promise))(function(resolve,reject){function fulfilled(value){try{step(generator.next(value))}catch(e){reject(e)}}function rejected(value){try{step(generator["throw"](value))}catch(e){reject(e)}}function step(result){result.done?resolve(result.value):adopt(result.value).then(fulfilled,rejected)}step((generator=generator.apply(thisArg,_arguments||[])).next())})},$$calysto,Calysto;(function(Calysto){var Tasks;(function(Tasks){class CPromise{constructor(executor){if(this.executor=executor,this.executor){try{this.executor(value=>this.notifyResolved(value),value=>this.notifyRejected(value))}catch(ex){this.notifyRejected(ex)}}}notifyResolved(value){this._isResolved=!0;this._resolveValue=value,this.notifyNext()}notifyRejected(value){this._isRejected=!0;this._rejectValue=value,this.notifyNext()}notifyNext(){this._nextPromise&&!this._isNextNotified&&(this._isRejected&&this._nextPromise._onPreviousFailed?(this._isNextNotified=!0,this._nextPromise._onPreviousFailed(this._rejectValue),this._nextPromise.notifyNext()):this._isResolved&&this._nextPromise._onPreviousSuccess&&(this._isNextNotified=!0,this._nextPromise._onPreviousSuccess(this._resolveValue),this._nextPromise.notifyNext()))}then(onResolved,onRejected){let next=new CPromise;next._onPreviousSuccess=previousValue=>{try{if(previousValue&&previousValue.then){let p1=previousValue;p1.then(v1=>next._onPreviousSuccess(v1),e1=>next._onPreviousFailed(e1));return}onResolved||(onResolved=x=>x);let currValue=onResolved(previousValue);if(currValue&&currValue.then){let currPromise=currValue;currPromise.then(value=>{next.notifyResolved(value)},err=>{next.notifyRejected(err)})}else next.notifyResolved(currValue)}catch(e1){next.notifyRejected(e1)}};next._onPreviousFailed=previsousError=>{try{onRejected||(onRejected=x=>{throw x;});let currErr=onRejected(previsousError);if(currErr&&currErr.then){let currPromise=currErr;currPromise.then(value=>{next.notifyResolved(value)},err=>{next.notifyRejected(err)})}else next.notifyResolved(currErr)}catch(e1){next.notifyRejected(e1)}},this._nextPromise=next,this.notifyNext();return next}catch(fn){return this.then(v=>v,fn||(x=>x))}finally(fn){return this.then(fn?x=>{fn();return x}:x=>x,fn?x=>{fn();throw x;}:x=>x)}static resolve(value){return new CPromise(resolve=>{resolve(value)})}static reject(value){return new CPromise((resolve,reject)=>{reject(value)})}}Tasks.CPromise=CPromise;window.Promise||(window.Promise=CPromise)})(Tasks=Calysto.Tasks||(Calysto.Tasks={}))})(Calysto||(Calysto={})),function(Calysto){var Tasks;(function(Tasks){class TaskState{get IsCancelled(){return this._isCancelled}Watchdog(timeoutMs){this._timer=setTimeout(()=>{this.Cancel(),this._onError&&this._onError("Timeout")},timeoutMs)}Cancel(){clearTimeout(this._timer);this._isCancelled=true}OnError(fn){this._onError=fn}NotifyError(err){this.Cancel();this._onError&&this._onError(err)}OnSuccess(fn){this._onSuccess=fn}NotifySuccess(value){this.Cancel();this._onSuccess&&this._onSuccess(value)}}Tasks.TaskState=TaskState})(Tasks=Calysto.Tasks||(Calysto.Tasks={}))}(Calysto||(Calysto={})),function(Calysto){var Tasks;(function(Tasks){var TaskUtility;(function(TaskUtility){function SleepAsync(durationMs){return __awaiter(this,void 0,void 0,function*(){return new Promise(resolve=>{setTimeout(()=>resolve(!0),durationMs)})})}function RunAsync(executor){return __awaiter(this,void 0,void 0,function*(){return new Promise((resolve,reject)=>{let state=new Tasks.TaskState;state.OnError(err=>reject(err));state.OnSuccess(value=>resolve(value)),executor(state)})})}TaskUtility.SleepAsync=SleepAsync;TaskUtility.RunAsync=RunAsync})(TaskUtility=Tasks.TaskUtility||(Tasks.TaskUtility={}))})(Tasks=Calysto.Tasks||(Calysto.Tasks={}))}(Calysto||(Calysto={})),function(Calysto){var Resources;(function(Resources){var Images;(function(Images){Images.Arrows_ArrowBlackDown="~/Images/Arrows/ArrowBlackDown.png";Images.Arrows_ArrowBlackUp="~/Images/Arrows/ArrowBlackUp.png",Images.Arrows_ArrowWhiteDown="~/Images/Arrows/ArrowWhiteDown.png",Images.Arrows_ArrowWhiteUp="~/Images/Arrows/ArrowWhiteUp.png",Images.Pictures_facebook_icon="~/Images/Pictures/facebook-icon.png",Images.Pictures_Google_Plus_icon="~/Images/Pictures/Google-Plus-icon.png",Images.Pictures_NoPhoto100="~/Images/Pictures/NoPhoto100.gif",Images.Pictures_NoPhoto200="~/Images/Pictures/NoPhoto200.gif",Images.Pictures_NoPhoto300="~/Images/Pictures/NoPhoto300.gif",Images.Pictures_NoPhoto50="~/Images/Pictures/NoPhoto50.gif",Images.WindowButtons_btnClose="~/Images/WindowButtons/btnClose.gif",Images.WindowButtons_btnCloseHover="~/Images/WindowButtons/btnCloseHover.gif",Images.WindowButtons_btnCloseInactive="~/Images/WindowButtons/btnCloseInactive.gif",Images.WindowButtons_btnMaximized="~/Images/WindowButtons/btnMaximized.gif",Images.WindowButtons_btnMaximizedHover="~/Images/WindowButtons/btnMaximizedHover.gif",Images.WindowButtons_btnMaximizedInactive="~/Images/WindowButtons/btnMaximizedInactive.gif",Images.WindowButtons_btnMinimize="~/Images/WindowButtons/btnMinimize.gif",Images.WindowButtons_btnMinimizeHover="~/Images/WindowButtons/btnMinimizeHover.gif",Images.WindowButtons_btnMinimizeInactive="~/Images/WindowButtons/btnMinimizeInactive.gif",Images.WindowButtons_btnResize="~/Images/WindowButtons/btnResize.gif",Images.WindowButtons_btnResizeHover="~/Images/WindowButtons/btnResizeHover.gif",Images.WindowButtons_btnResizeInactive="~/Images/WindowButtons/btnResizeInactive.gif",Images.WindowButtons_btnToolClose="~/Images/WindowButtons/btnToolClose.gif",Images.WindowButtons_btnToolCloseHover="~/Images/WindowButtons/btnToolCloseHover.gif",Images.Horoscope_Icons_aquarius_128="~/Images/Horoscope/Icons/aquarius_128.png",Images.Horoscope_Icons_aries_128="~/Images/Horoscope/Icons/aries_128.png",Images.Horoscope_Icons_cancer_128="~/Images/Horoscope/Icons/cancer_128.png",Images.Horoscope_Icons_capricorn_128="~/Images/Horoscope/Icons/capricorn_128.png",Images.Horoscope_Icons_gemini_128="~/Images/Horoscope/Icons/gemini_128.png",Images.Horoscope_Icons_leo_128="~/Images/Horoscope/Icons/leo_128.png",Images.Horoscope_Icons_libra_128="~/Images/Horoscope/Icons/libra_128.png",Images.Horoscope_Icons_pisces_128="~/Images/Horoscope/Icons/pisces_128.png",Images.Horoscope_Icons_sagittarius_128="~/Images/Horoscope/Icons/sagittarius_128.png",Images.Horoscope_Icons_scorpio_128="~/Images/Horoscope/Icons/scorpio_128.png",Images.Horoscope_Icons_taurus_128="~/Images/Horoscope/Icons/taurus_128.png",Images.Horoscope_Icons_virgo_128="~/Images/Horoscope/Icons/virgo_128.png",Images.Horoscope_Signs_aquarius_zodiac_sign="~/Images/Horoscope/Signs/aquarius_zodiac_sign.png",Images.Horoscope_Signs_aries_zodiac_sign="~/Images/Horoscope/Signs/aries_zodiac_sign.png",Images.Horoscope_Signs_cancer_zodiac_sign="~/Images/Horoscope/Signs/cancer_zodiac_sign.png",Images.Horoscope_Signs_capricorn_zodiac_sign="~/Images/Horoscope/Signs/capricorn_zodiac_sign.png",Images.Horoscope_Signs_gemini_zodiac_sign="~/Images/Horoscope/Signs/gemini_zodiac_sign.png",Images.Horoscope_Signs_leo_zodiac_sign="~/Images/Horoscope/Signs/leo_zodiac_sign.png",Images.Horoscope_Signs_libra_zodiac_sign="~/Images/Horoscope/Signs/libra_zodiac_sign.png",Images.Horoscope_Signs_pisces_zodiac_sign="~/Images/Horoscope/Signs/pisces_zodiac_sign.png",Images.Horoscope_Signs_sagittarius_zodiac_sign="~/Images/Horoscope/Signs/sagittarius_zodiac_sign.png",Images.Horoscope_Signs_scorpio_zodiac_sign="~/Images/Horoscope/Signs/scorpio_zodiac_sign.png",Images.Horoscope_Signs_taurus_zodiac_sign="~/Images/Horoscope/Signs/taurus_zodiac_sign.png",Images.Horoscope_Signs_virgo_zodiac_sign="~/Images/Horoscope/Signs/virgo_zodiac_sign.png",Images.Icons_Ajax2Preloader_Ajax12TrailBlack="~/Images/Icons/Ajax2Preloader/Ajax12TrailBlack.gif",Images.Icons_Ajax2Preloader_Ajax14FlowerBlack="~/Images/Icons/Ajax2Preloader/Ajax14FlowerBlack.gif",Images.Icons_Ajax2Preloader_Ajax14TrailBlack="~/Images/Icons/Ajax2Preloader/Ajax14TrailBlack.gif",Images.Icons_Ajax2Preloader_Ajax16ArcBlack="~/Images/Icons/Ajax2Preloader/Ajax16ArcBlack.gif",Images.Icons_Ajax2Preloader_Ajax16ArrowsBlack="~/Images/Icons/Ajax2Preloader/Ajax16ArrowsBlack.gif",Images.Icons_Ajax2Preloader_Ajax16DotBlack="~/Images/Icons/Ajax2Preloader/Ajax16DotBlack.gif",Images.Icons_Ajax2Preloader_Ajax24DotBlack="~/Images/Icons/Ajax2Preloader/Ajax24DotBlack.gif",Images.Icons_Ajax2Preloader_Ajax24DotBlue="~/Images/Icons/Ajax2Preloader/Ajax24DotBlue.gif",Images.Icons_Ajax2Preloader_Ajax24DotRed="~/Images/Icons/Ajax2Preloader/Ajax24DotRed.gif",Images.Icons_Ajax2Preloader_Ajax32SandClock="~/Images/Icons/Ajax2Preloader/Ajax32SandClock.png",Images.Icons_Ajax2Preloader_FB_black_small="~/Images/Icons/Ajax2Preloader/FB_black_small.gif",Images.Icons_Ajax2Preloader_skype_black2white="~/Images/Icons/Ajax2Preloader/skype_black2white.GIF",Images.Icons_Ajax2Preloader_skype_blue2white="~/Images/Icons/Ajax2Preloader/skype_blue2white.GIF",Images.Icons_Ajax2Preloader_skype_green2white="~/Images/Icons/Ajax2Preloader/skype_green2white.GIF",Images.Icons_Ajax2Preloader_skype_red2white="~/Images/Icons/Ajax2Preloader/skype_red2white.GIF",Images.Icons_Ajax2Preloader_skype_white2black="~/Images/Icons/Ajax2Preloader/skype_white2black.GIF",Images.Icons_Smiley_angry="~/Images/Icons/Smiley/angry.gif",Images.Icons_Smiley_applause="~/Images/Icons/Smiley/applause.gif",Images.Icons_Smiley_bigGrin="~/Images/Icons/Smiley/bigGrin.gif",Images.Icons_Smiley_bigHug="~/Images/Icons/Smiley/bigHug.gif",Images.Icons_Smiley_confused="~/Images/Icons/Smiley/confused.gif",Images.Icons_Smiley_cool="~/Images/Icons/Smiley/cool.gif",Images.Icons_Smiley_crying="~/Images/Icons/Smiley/crying.gif",Images.Icons_Smiley_dancing="~/Images/Icons/Smiley/dancing.gif",Images.Icons_Smiley_devil="~/Images/Icons/Smiley/devil.gif",Images.Icons_Smiley_dontTellAnyone="~/Images/Icons/Smiley/dontTellAnyone.gif",Images.Icons_Smiley_happy="~/Images/Icons/Smiley/happy.gif",Images.Icons_Smiley_hurryUp="~/Images/Icons/Smiley/hurryUp.gif",Images.Icons_Smiley_kiss="~/Images/Icons/Smiley/kiss.gif",Images.Icons_Smiley_laughing="~/Images/Icons/Smiley/laughing.gif",Images.Icons_Smiley_notWorthy="~/Images/Icons/Smiley/notWorthy.gif",Images.Icons_Smiley_party="~/Images/Icons/Smiley/party.gif",Images.Icons_Smiley_rockOn="~/Images/Icons/Smiley/rockOn.gif",Images.Icons_Smiley_rollingOnTheFloor="~/Images/Icons/Smiley/rollingOnTheFloor.gif",Images.Icons_Smiley_sad="~/Images/Icons/Smiley/sad.gif",Images.Icons_Smiley_surprise="~/Images/Icons/Smiley/surprise.gif",Images.Icons_Smiley_thinking="~/Images/Icons/Smiley/thinking.gif",Images.Icons_Smiley_thumbsDown="~/Images/Icons/Smiley/thumbsDown.gif",Images.Icons_Smiley_tongue="~/Images/Icons/Smiley/tongue.gif",Images.Icons_Smiley_winking="~/Images/Icons/Smiley/winking.gif",Images.WindowButtons_Original_PNG_btnClose="~/Images/WindowButtons/Original_PNG/btnClose.png",Images.WindowButtons_Original_PNG_btnCloseHover="~/Images/WindowButtons/Original_PNG/btnCloseHover.png",Images.WindowButtons_Original_PNG_btnCloseInactive="~/Images/WindowButtons/Original_PNG/btnCloseInactive.png",Images.WindowButtons_Original_PNG_btnMaximized="~/Images/WindowButtons/Original_PNG/btnMaximized.png",Images.WindowButtons_Original_PNG_btnMaximizedHover="~/Images/WindowButtons/Original_PNG/btnMaximizedHover.png",Images.WindowButtons_Original_PNG_btnMaximizedInactive="~/Images/WindowButtons/Original_PNG/btnMaximizedInactive.png",Images.WindowButtons_Original_PNG_btnMinimize="~/Images/WindowButtons/Original_PNG/btnMinimize.png",Images.WindowButtons_Original_PNG_btnMinimizeHover="~/Images/WindowButtons/Original_PNG/btnMinimizeHover.png",Images.WindowButtons_Original_PNG_btnMinimizeInactive="~/Images/WindowButtons/Original_PNG/btnMinimizeInactive.png",Images.WindowButtons_Original_PNG_btnResize="~/Images/WindowButtons/Original_PNG/btnResize.png",Images.WindowButtons_Original_PNG_btnResizeHover="~/Images/WindowButtons/Original_PNG/btnResizeHover.png",Images.WindowButtons_Original_PNG_btnResizeInactive="~/Images/WindowButtons/Original_PNG/btnResizeInactive.png",Images.WindowButtons_Original_PNG_btnToolClose="~/Images/WindowButtons/Original_PNG/btnToolClose.png",Images.WindowButtons_Original_PNG_btnToolCloseHover="~/Images/WindowButtons/Original_PNG/btnToolCloseHover.png",Images.Icons_s32_aha_Apply="~/Images/Icons/s32/aha/Apply.png",Images.Icons_s32_aha_Back="~/Images/Icons/s32/aha/Back.png",Images.Icons_s32_aha_Cancel="~/Images/Icons/s32/aha/Cancel.png",Images.Icons_s32_aha_Close="~/Images/Icons/s32/aha/Close.png",Images.Icons_s32_aha_Danger="~/Images/Icons/s32/aha/Danger.png",Images.Icons_s32_aha_Delete="~/Images/Icons/s32/aha/Delete.png",Images.Icons_s32_aha_EditPage="~/Images/Icons/s32/aha/EditPage.png",Images.Icons_s32_aha_Error="~/Images/Icons/s32/aha/Error.png",Images.Icons_s32_aha_Forward="~/Images/Icons/s32/aha/Forward.png",Images.Icons_s32_aha_GoDown="~/Images/Icons/s32/aha/GoDown.png",Images.Icons_s32_aha_GoUp="~/Images/Icons/s32/aha/GoUp.png",Images.Icons_s32_aha_Help="~/Images/Icons/s32/aha/Help.png",Images.Icons_s32_aha_Info="~/Images/Icons/s32/aha/Info.png",Images.Icons_s32_aha_No="~/Images/Icons/s32/aha/No.png",Images.Icons_s32_aha_Ok="~/Images/Icons/s32/aha/Ok.png",Images.Icons_s32_aha_Pencil="~/Images/Icons/s32/aha/Pencil.png",Images.Icons_s32_aha_Picture="~/Images/Icons/s32/aha/Picture.png",Images.Icons_s32_aha_Play="~/Images/Icons/s32/aha/Play.png",Images.Icons_s32_aha_Refresh="~/Images/Icons/s32/aha/Refresh.png",Images.Icons_s32_aha_Settings="~/Images/Icons/s32/aha/Settings.png",Images.Icons_s32_aha_Show="~/Images/Icons/s32/aha/Show.png",Images.Icons_s32_aha_Stop="~/Images/Icons/s32/aha/Stop.png",Images.Icons_s32_aha_StopPlaying="~/Images/Icons/s32/aha/StopPlaying.png",Images.Icons_s32_aha_Warning="~/Images/Icons/s32/aha/Warning.png",Images.Icons_s32_aha_Wrong="~/Images/Icons/s32/aha/Wrong.png",Images.Icons_s32_fatcow_film="~/Images/Icons/s32/fatcow/film.png",Images.Icons_s16_silk_icons_accept="~/Images/Icons/s16/silk/icons/accept.png",Images.Icons_s16_silk_icons_add="~/Images/Icons/s16/silk/icons/add.png",Images.Icons_s16_silk_icons_anchor="~/Images/Icons/s16/silk/icons/anchor.png",Images.Icons_s16_silk_icons_application="~/Images/Icons/s16/silk/icons/application.png",Images.Icons_s16_silk_icons_application_edit="~/Images/Icons/s16/silk/icons/application_edit.png",Images.Icons_s16_silk_icons_brick_edit="~/Images/Icons/s16/silk/icons/brick_edit.png",Images.Icons_s16_silk_icons_cancel="~/Images/Icons/s16/silk/icons/cancel.png",Images.Icons_s16_silk_icons_cross="~/Images/Icons/s16/silk/icons/cross.png",Images.Icons_s16_silk_icons_date="~/Images/Icons/s16/silk/icons/date.png",Images.Icons_s16_silk_icons_delete="~/Images/Icons/s16/silk/icons/delete.png",Images.Icons_s16_silk_icons_disconnect="~/Images/Icons/s16/silk/icons/disconnect.png",Images.Icons_s16_silk_icons_disk="~/Images/Icons/s16/silk/icons/disk.png",Images.Icons_s16_silk_icons_error="~/Images/Icons/s16/silk/icons/error.png",Images.Icons_s16_silk_icons_exclamation="~/Images/Icons/s16/silk/icons/exclamation.png",Images.Icons_s16_silk_icons_eye="~/Images/Icons/s16/silk/icons/eye.png",Images.Icons_s16_silk_icons_feed="~/Images/Icons/s16/silk/icons/feed.png",Images.Icons_s16_silk_icons_help="~/Images/Icons/s16/silk/icons/help.png",Images.Icons_s16_silk_icons_hourglass="~/Images/Icons/s16/silk/icons/hourglass.png",Images.Icons_s16_silk_icons_lock_break="~/Images/Icons/s16/silk/icons/lock_break.png",Images.Icons_s16_silk_icons_magifier_zoom_out="~/Images/Icons/s16/silk/icons/magifier_zoom_out.png",Images.Icons_s16_silk_icons_magnifier="~/Images/Icons/s16/silk/icons/magnifier.png",Images.Icons_s16_silk_icons_magnifier_zoom_in="~/Images/Icons/s16/silk/icons/magnifier_zoom_in.png",Images.Icons_s16_silk_icons_male="~/Images/Icons/s16/silk/icons/male.png",Images.Icons_s16_silk_icons_map="~/Images/Icons/s16/silk/icons/map.png",Images.Icons_s16_silk_icons_page_add="~/Images/Icons/s16/silk/icons/page_add.png",Images.Icons_s16_silk_icons_page_edit="~/Images/Icons/s16/silk/icons/page_edit.png",Images.Icons_s16_silk_icons_page_white="~/Images/Icons/s16/silk/icons/page_white.png",Images.Icons_s16_silk_icons_picture="~/Images/Icons/s16/silk/icons/picture.png",Images.Icons_s16_silk_icons_pictures="~/Images/Icons/s16/silk/icons/pictures.png",Images.Icons_s16_silk_icons_picture_add="~/Images/Icons/s16/silk/icons/picture_add.png",Images.Icons_s16_silk_icons_plugin="~/Images/Icons/s16/silk/icons/plugin.png",Images.Icons_s16_silk_icons_plugin_edit="~/Images/Icons/s16/silk/icons/plugin_edit.png",Images.Icons_s16_silk_icons_stop="~/Images/Icons/s16/silk/icons/stop.png",Images.Icons_s16_silk_icons_thumb_down="~/Images/Icons/s16/silk/icons/thumb_down.png",Images.Icons_s16_silk_icons_thumb_up="~/Images/Icons/s16/silk/icons/thumb_up.png",Images.Icons_s16_silk_icons_tick="~/Images/Icons/s16/silk/icons/tick.png",Images.Icons_s16_silk_icons_time="~/Images/Icons/s16/silk/icons/time.png",Images.Icons_s16_silk_icons_user="~/Images/Icons/s16/silk/icons/user.png",Images.Icons_s16_silk_icons_zoom="~/Images/Icons/s16/silk/icons/zoom.png",Images.Icons_s16_silk_icons_zoom_in="~/Images/Icons/s16/silk/icons/zoom_in.png",Images.Icons_s16_silk_icons_zoom_out="~/Images/Icons/s16/silk/icons/zoom_out.png"})(Images=Resources.Images||(Resources.Images={}))})(Resources=Calysto.Resources||(Calysto.Resources={}))}(Calysto||(Calysto={})),function(Calysto){var Constants;(function(Constants){Constants.AppConstants={EmailRegexPattern:"^[\\w\\.\\+\\-_']+[@][\\w\\+\\-_']+?[\\.][\\w\\.\\+\\-_']+$",BroadcastMethodName:"$broadcast-message$"}})(Constants=Calysto.Constants||(Calysto.Constants={}))}(Calysto||(Calysto={})),function(Calysto){var Constants;(function(Constants){var WsjsHeaderConstants;(function(WsjsHeaderConstants){WsjsHeaderConstants.XAjaxHeaderKey=`calysto-x-ajax`;WsjsHeaderConstants.XAjaxHeaderValue=`calysto-ajax`,WsjsHeaderConstants.XExceptionHeaderValue=`calysto-exception`,WsjsHeaderConstants.XTypeHeaderKey=`calysto-x-type`,WsjsHeaderConstants.XTypeHeaderBinaryFrameValue=`calysto-binary-frame`,WsjsHeaderConstants.XCalystoAjaxFormKey=`calysto-x-ajax-form`,WsjsHeaderConstants.XCalystoAjaxFormValue=`calysto-yes`,WsjsHeaderConstants.XCalystoAjaxLoadKey=`calysto-x-ajax-load`,WsjsHeaderConstants.XCalystoAjaxLoadValue=`calysto-yes`,WsjsHeaderConstants.XCalystoResponseContainerKey=`calysto-x-container`,WsjsHeaderConstants.XCalystoResponseContainerValue=`calysto-yes`})(WsjsHeaderConstants=Constants.WsjsHeaderConstants||(Constants.WsjsHeaderConstants={}))})(Constants=Calysto.Constants||(Calysto.Constants={}))}(Calysto||(Calysto={})),function(Calysto){var Constants;(function(Constants){Constants.PredefinedCultures={"en-US":{Name:"en-US",NativeName:"English (United States)",DisplayName:"English (United States)",EnglishName:"English (United States)",ThreeLetterISOLanguageName:"eng",ThreeLetterWindowsLanguageName:"ENU",TwoLetterISOLanguageName:"en",DateTimeFormat:{ShortestDayNames:["Su","Mo","Tu","We","Th","Fr","Sa"],AbbreviatedDayNames:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],DayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],AbbreviatedMonthNames:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec",""],MonthNames:["January","February","March","April","May","June","July","August","September","October","November","December",""],FirstDayOfWeek:0,LongDatePattern:"dddd, MMMM d, yyyy",LongTimePattern:"h:mm:ss tt",MonthDayPattern:"MMMM d",ShortDatePattern:"M/d/yyyy",ShortTimePattern:"h:mm tt",GeneralLongTimePattern:"M/d/yyyy h:mm:ss tt",GeneralShortTimePattern:"M/d/yyyy h:mm tt"},NumberFormat:{CurrencySymbol:"$",NumberDecimalSeparator:".",NumberGroupSeparator:",",PerMilleSymbol:"‰",PercentSymbol:"%",CurrencyPositivePattern:0,CurrencyPositivePatternString:"{CurrencySymbol}{Value}"},Region:{CurrencyEnglishName:"US Dollar",CurrencyNativeName:"US Dollar",CurrencySymbol:"$",DisplayName:"United States",EnglishName:"United States",IsMetric:!1,ISOCurrencySymbol:"USD",Name:"US",NativeName:"United States",ThreeLetterISORegionName:"USA",ThreeLetterWindowsRegionName:"USA",TwoLetterISORegionName:"US"}},"hr-HR":{Name:"hr-HR",NativeName:"hrvatski (Hrvatska)",DisplayName:"Croatian (Croatia)",EnglishName:"Croatian (Croatia)",ThreeLetterISOLanguageName:"hrv",ThreeLetterWindowsLanguageName:"HRV",TwoLetterISOLanguageName:"hr",DateTimeFormat:{ShortestDayNames:["ne","po","ut","sr","če","pe","su"],AbbreviatedDayNames:["ned","pon","uto","sri","čet","pet","sub"],DayNames:["nedjelja","ponedjeljak","utorak","srijeda","četvrtak","petak","subota"],AbbreviatedMonthNames:["sij","vlj","ožu","tra","svi","lip","srp","kol","ruj","lis","stu","pro",""],MonthNames:["siječanj","veljača","ožujak","travanj","svibanj","lipanj","srpanj","kolovoz","rujan","listopad","studeni","prosinac",""],FirstDayOfWeek:1,LongDatePattern:"d. MMMM yyyy.",LongTimePattern:"H:mm:ss",MonthDayPattern:"d. MMMM",ShortDatePattern:"d.M.yyyy.",ShortTimePattern:"H:mm",GeneralLongTimePattern:"d.M.yyyy. H:mm:ss",GeneralShortTimePattern:"d.M.yyyy. H:mm"},NumberFormat:{CurrencySymbol:"kn",NumberDecimalSeparator:",",NumberGroupSeparator:".",PerMilleSymbol:"‰",PercentSymbol:"%",CurrencyPositivePattern:3,CurrencyPositivePatternString:"{Value} {CurrencySymbol}"},Region:{CurrencyEnglishName:"Croatian Kuna",CurrencyNativeName:"hrvatska kuna",CurrencySymbol:"kn",DisplayName:"Croatia",EnglishName:"Croatia",IsMetric:!0,ISOCurrencySymbol:"HRK",Name:"HR",NativeName:"Hrvatska",ThreeLetterISORegionName:"HRV",ThreeLetterWindowsRegionName:"HRV",TwoLetterISORegionName:"HR"}}}})(Constants=Calysto.Constants||(Calysto.Constants={}))}(Calysto||(Calysto={})),function(Calysto){var Constants;(function(Constants){var CalystoDomAttributes;(function(CalystoDomAttributes){CalystoDomAttributes.CalystoId=`calysto-id`;CalystoDomAttributes.CalystoValidatorMsgFor=`calysto-validator-msg-for`,CalystoDomAttributes.CalystoSummaryMsgFor=`calysto-summary-msg-for`,CalystoDomAttributes.CalystoErrorMsgFor=`calysto-error-msg-for`,CalystoDomAttributes.CalystoType=`calysto-type`,CalystoDomAttributes.CalystoGetter=`calysto-getter`,CalystoDomAttributes.CalystoSetter=`calysto-setter`,CalystoDomAttributes.CalystoFormat=`calysto-format`,CalystoDomAttributes.CalystoValidationFn=`calysto-validation-fn`,CalystoDomAttributes.CalystoBind=`calysto-bind`,CalystoDomAttributes.CalystoBindEvents=`calysto-bind-events`,CalystoDomAttributes.CalystoListen=`calysto-listen`,CalystoDomAttributes.CalystoUid=`calysto-uid`,CalystoDomAttributes.CalystoIsRepeater=`calysto-isrepeater`,CalystoDomAttributes.CalystoIsGroup=`calysto-isgroup`,CalystoDomAttributes.CalystoGetConvert=`calysto-getconvert`,CalystoDomAttributes.CalystoSetConvert=`calysto-setconvert`,CalystoDomAttributes.CalystoFormTarget=`calysto-form-target`,CalystoDomAttributes.CalystoFormHandler=`calysto-form-handler`,CalystoDomAttributes.CalystoFormMode=`calysto-form-mode`,CalystoDomAttributes.CalystoFormDestination=`calysto-form-dest`,CalystoDomAttributes.CalystoAppendVersion=`calysto-append-version`,CalystoDomAttributes.CalystoSpinnerDelay=`calysto-spinner-delay`,CalystoDomAttributes.CalystoTimeout=`calysto-timeout`,CalystoDomAttributes.CalystoControllerAction=`calysto-controller-action`,CalystoDomAttributes.CalystoScriptRun=`calysto-script-run`})(CalystoDomAttributes=Constants.CalystoDomAttributes||(Constants.CalystoDomAttributes={}))})(Constants=Calysto.Constants||(Calysto.Constants={}))}(Calysto||(Calysto={})),function(Calysto){var Constants;(function(Constants){var CalystoAjaxHandlerConstants;(function(CalystoAjaxHandlerConstants){CalystoAjaxHandlerConstants.HandlerPath=`calysto-hndlaxd`;CalystoAjaxHandlerConstants.ScriptResourceRequest=`calysto-sclisx`,CalystoAjaxHandlerConstants.ElmahRequest=`calysto-exiaqn`,CalystoAjaxHandlerConstants.TypeServiceRequest=`calysto-tmoynd`,CalystoAjaxHandlerConstants.AjaxGetParamName=`calysto-ghqiu`})(CalystoAjaxHandlerConstants=Constants.CalystoAjaxHandlerConstants||(Constants.CalystoAjaxHandlerConstants={}))})(Constants=Calysto.Constants||(Calysto.Constants={}))}(Calysto||(Calysto={})),function(Calysto){var Constants;(function(Constants){var BaseXCharsTable;(function(BaseXCharsTable){BaseXCharsTable.RandomRFCTable64=`csIYaqGWdtJZ6mCS2iyO7nDT0gwM-1hxNeuK_brHX9pFV3jzP8oEUfvL!5lBR4kAQ`;BaseXCharsTable.StandardBase64RFC=`ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=`,BaseXCharsTable.JavaScriptRFCTable64=`0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ_!-`,BaseXCharsTable.Table36JavaScriptRFC=`0123456789abcdefghijklmnopqrstuvwxyz`})(BaseXCharsTable=Constants.BaseXCharsTable||(Constants.BaseXCharsTable={}))})(Constants=Calysto.Constants||(Calysto.Constants={}))}(Calysto||(Calysto={})),function(Calysto){var Globalization;(function(Globalization){class ResxExcelProvider{get DataRows(){var _a;return(_a=this._dataRows)!==null&&_a!==void 0?_a:this._dataRows=this.Table.Rows.AsEnumerable().ToDictionary(o=>o[0])}GetDefaultSearchColumns(){return null}GetSearchColumns(searchColumnsOrder){if(typeof searchColumnsOrder=="string"){return[searchColumnsOrder]};if(searchColumnsOrder){return searchColumnsOrder};if(this.GetDefaultSearchColumns){let defaultCols=this.GetDefaultSearchColumns();if(defaultCols){return defaultCols}}let curr1=Calysto.Globalization.CultureInfo.CurrentCulture.Name;searchColumnsOrder=[this.Table.Columns[1]];this.Table.Columns.Contains(curr1)&&searchColumnsOrder.unshift(curr1);return searchColumnsOrder}static FromJson(json){let provider=new ResxExcelProvider;provider.Table=json;return provider}GetString(propertyName,searchColumnsOrder){let item1=this.DataRows.GetValueOrDefault(propertyName),cols1=this.GetSearchColumns(searchColumnsOrder);if(item1&&cols1){for(let col1 of cols1){let index1=this.Table.Columns.indexOf(col1);if(index1<0){throw Error(`Resx column ${col1} doesn't exist.`);}let item2=item1[index1];if(!!item2){return item2}}throw Error(`Resx property ${propertyName} with cell ${cols1.join(" | ")} not found.`);}throw Error(`Resx property ${propertyName} not found.`);}}Globalization.ResxExcelProvider=ResxExcelProvider})(Globalization=Calysto.Globalization||(Calysto.Globalization={}))}(Calysto||(Calysto={})),function(Calysto){var Resources;(function(Resources){class CalystoLang{static get Cancel(){return CalystoLang.ResourceProvider.GetString("Cancel")}static get Close(){return CalystoLang.ResourceProvider.GetString("Close")}static get Day(){return CalystoLang.ResourceProvider.GetString("Day")}static get Error(){return CalystoLang.ResourceProvider.GetString("Error")}static get Information(){return CalystoLang.ResourceProvider.GetString("Information")}static get JavascriptEngineIsOutdatedInformation(){return CalystoLang.ResourceProvider.GetString("JavascriptEngineIsOutdatedInformation")}static get Message(){return CalystoLang.ResourceProvider.GetString("Message")}static get MethodInvocationFobidden(){return CalystoLang.ResourceProvider.GetString("MethodInvocationFobidden")}static get Month(){return CalystoLang.ResourceProvider.GetString("Month")}static get NewVersionFoundPageIsReloading(){return CalystoLang.ResourceProvider.GetString("NewVersionFoundPageIsReloading")}static get No(){return CalystoLang.ResourceProvider.GetString("No")}static get OK(){return CalystoLang.ResourceProvider.GetString("OK")}static get Open(){return CalystoLang.ResourceProvider.GetString("Open")}static get PageIsReloadingPleaseWait(){return CalystoLang.ResourceProvider.GetString("PageIsReloadingPleaseWait")}static get PleaseConfirm(){return CalystoLang.ResourceProvider.GetString("PleaseConfirm")}static get Question(){return CalystoLang.ResourceProvider.GetString("Question")}static get Reload(){return CalystoLang.ResourceProvider.GetString("Reload")}static get Save(){return CalystoLang.ResourceProvider.GetString("Save")}static get Success(){return CalystoLang.ResourceProvider.GetString("Success")}static get Today(){return CalystoLang.ResourceProvider.GetString("Today")}static get Warning(){return CalystoLang.ResourceProvider.GetString("Warning")}static get Week(){return CalystoLang.ResourceProvider.GetString("Week")}static get Year(){return CalystoLang.ResourceProvider.GetString("Year")}static get Yes(){return CalystoLang.ResourceProvider.GetString("Yes")}}CalystoLang.ResourceProvider=Calysto.Globalization.ResxExcelProvider.FromJson({__calystotype:"Calysto_DataTable",TotalCount:null,TableName:"",Columns:["property","en-US","hr-HR"],Rows:[["Cancel","Cancel","Otkaži"],["Close","Close","Zatvori"],["Day","Day","Dan"],["Error","Error","Greška"],["Information","Information","Informacija"],["JavascriptEngineIsOutdatedInformation","Javascript engine is outdated.\r\nClick:\r\n    - Reload to reload page and new engine\r\n    - Cancel to keep the current page","Pronađena je novija verzija stranice.\nKliknite:\n    - Osvježi za osvježavanje i dohvat nove verzije\n    - Otkaži za zadržavanje na trenutnoj verziji"],["Message","Message","Poruka"],["Month","Month","Mjesec"],["NewVersionFoundPageIsReloading","New version found, page is reloading...","Pronađena je novija verzija, stranica se osvježava..."],["No","No","Ne"],["OK","OK","U redu"],["Open","Open","Otvori"],["PageIsReloadingPleaseWait","Please wait, page is reloading...","Molimo pričekajte, stranica se osvježava..."],["PleaseConfirm","Please confirm","Molimo potvrdite"],["Question","Question","Pitanje"],["Reload","Reload","Osvježi"],["Save","Save","Spremi"],["Success","Success","Uspješno"],["Today","Today","Danas"],["Warning","Warning","Upozorenje"],["Week","Week","Tjedan"],["Year","Year","Godina"],["Yes","Yes","Da"],["MethodInvocationFobidden","Invocation forbidden","Nemate dozvolu za ovu akciju"]]});Resources.CalystoLang=CalystoLang})(Resources=Calysto.Resources||(Calysto.Resources={}))}(Calysto||(Calysto={})),function(Calysto){let DataBinder;(function(DataBinder){function RemoveRoot(prop){return(prop||"").replace(reRoot,"")}function SplitToParts(prop){return RemoveRoot(prop+"").Split([".","[","]"])}function TryGetValue(dataObj,dataProperty,refOut){if(!dataObj||!refOut||arguments.length!=3){throw new Error("Calysto.DataBinder.TryGetValue() requires 3 arguments");}for(var cnt=0,arr=SplitToParts(dataProperty),val=dataObj,prop;arr.length>0&&(prop=arr.shift());){if(cnt++>RecursionLimit){throw new Error("Calysto.DataBinder.TryGetValue() recursion limit");}let isIndex=!1;if(reNum.test(prop)&&(prop=parseInt(prop,10),isIndex=!0),val==null||val==undefined){return!1};try{if(isIndex&&Calysto.Collections.HasInnerArray(val)){val=Calysto.Collections.GetInnerArray(val)[prop]}else if(prop in val){val=val[prop]}else return!1}catch(e){return!1}}refOut.SetValue(val);return!0}function GetValue(dataObj,dataProperty){if(arguments.length<2){throw new Error("Calysto.DataBinder.GetValue() requires 2 arguments");}var refOut=new Calysto.BoxValue;TryGetValue(dataObj,dataProperty,refOut);return refOut.GetValue()}function SetValue(dataObj,dataProperty,value){if(!dataObj||!dataProperty||arguments.length<3){throw new Error("Calysto.DataBinder.SetValue() requires 3 arguments");}for(var cnt=0,arr=SplitToParts(dataProperty),prop,obj=dataObj,tmp=obj;arr.length>0&&(prop=arr.shift());){if(cnt++>RecursionLimit){throw new Error("Calysto.DataBinder.SetValue() recursion limit");}let isIndex=!1;reNum.test(prop)&&(prop=parseInt(prop,10),isIndex=!0);arr.length>0?(tmp=isIndex&&Calysto.Collections.HasInnerArray(obj)?Calysto.Collections.GetInnerArray(obj)[prop]:obj[prop],obj=tmp?tmp:obj[prop]={}):isIndex&&Calysto.Collections.HasInnerArray(obj)?Calysto.Collections.GetInnerArray(obj)[prop]=value:obj[prop]=value}}var reNum=new RegExp("^[\\d]+$"),reRoot=new RegExp("^[\\@]+[\\.]*"),RecursionLimit=100;DataBinder.TryGetValue=TryGetValue;DataBinder.GetValue=GetValue,DataBinder.SetValue=SetValue})(DataBinder=Calysto.DataBinder||(Calysto.DataBinder={}))}(Calysto||(Calysto={})),function(Calysto){var Globalization;(function(Globalization){function GetPredefinedCultures(){return Calysto.Constants.PredefinedCultures}class DateTimeFormat{constructor(){this.ShortestDayNames=["Su","Mo","Tu","We","Th","Fr","Sa"];this.AbbreviatedDayNames=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],this.DayNames=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],this.AbbreviatedMonthNames=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec",""],this.MonthNames=["January","February","March","April","May","June","July","August","September","October","November","December",""],this.LongDatePattern="dddd, MMMM d, yyyy",this.LongTimePattern="h:mm:ss tt",this.MonthDayPattern="MMMM d",this.ShortDatePattern="M/d/yyyy",this.ShortTimePattern="h:mm tt",this.GeneralLongTimePattern="M/d/yyyy h:mm:ss tt",this.GeneralShortTimePattern="M/d/yyyy h:mm tt"}}class NumberFormat{constructor(){this.CurrencySymbol="$";this.NumberDecimalSeparator=".",this.NumberGroupSeparator=",",this.PerMilleSymbol="‰",this.PercentSymbol="%",this.CurrencyPositivePattern=0,this.CurrencyPositivePatternString="{CurrencySymbol}{Value}"}}class Region{constructor(){this.CurrencyEnglishName="US Dollar";this.CurrencyNativeName="US Dollar",this.CurrencySymbol="$",this.DisplayName="United States",this.EnglishName="United States",this.IsMetric=false,this.ISOCurrencySymbol="USD",this.Name="en-US",this.NativeName="United States",this.ThreeLetterISORegionName="USA",this.ThreeLetterWindowsRegionName="USA",this.TwoLetterISORegionName="US"}}let _currentCulture;class CultureInfo{constructor(){this.Name="en-US";this.NativeName="English (United States)",this.DisplayName="English (United States)",this.EnglishName="English (United States)",this.ThreeLetterISOLanguageName="eng",this.ThreeLetterWindowsLanguageName="ENU",this.TwoLetterISOLanguageName="en",this.DateTimeFormat=new DateTimeFormat,this.NumberFormat=new NumberFormat,this.Region=new Region}static get Cultures(){return GetPredefinedCultures()}static get USCulture(){return GetPredefinedCultures()["en-US"]}static get HRCulture(){return GetPredefinedCultures()["hr-HR"]}static get CurrentCulture(){return _currentCulture||Calysto.Core.Constants.CurrentCulture||CultureInfo.USCulture}static set CurrentCulture(culture){if(culture&&culture.Name&&(CultureInfo===null||CultureInfo===void 0?void 0:CultureInfo.Cultures[culture.Name])){_currentCulture=culture}else throw Error("Invalid culture provided.");}}Globalization.CultureInfo=CultureInfo})(Globalization=Calysto.Globalization||(Calysto.Globalization={}))}(Calysto||(Calysto={})),function(Calysto){class Core{static get Constants(){return __calystoeueinhywsx||{}}static get IsDebugDefined(){return Calysto.Core.Constants.IsDebugDefined}static get IsLocallyHosted(){return Calysto.Core.Constants.IsLocallyHosted}static get IsTddSpecific(){return Calysto.Core.Constants.IsTddSpecific}static RegisterGlobalNs(path){Calysto.DataBinder.SetValue(window,path,{})}static ExportGlobal(obj,path,mayOverwrite){if(!path&&typeof obj=="function"&&(path=obj.name,!path)){let str1=obj+"",match1=str1.match("function[\\s]+([^\\(\\)]+)");match1&&(path=match1[1])}if(!path){throw new Error("ExportGlobal error: path can not be empty.");}if(!mayOverwrite&&Calysto.DataBinder.GetValue(window,path)){throw new Error('ExportGlobal error: path "'+path+'" aready exists in window.');}else Calysto.DataBinder.SetValue(window,path,obj)}}Calysto.Core=Core}(Calysto||(Calysto={})),function(Calysto){Calysto.AttrName=Calysto.Constants.CalystoDomAttributes}(Calysto||(Calysto={})),function(Calysto){class BoxValue{constructor(){}SetValue(value){this._value=value;this._hasValue=true}GetValue(){return this._value}GetValueOrDefault(defaultValue){return this.HasValue()?this.GetValue():defaultValue}HasValue(){return!!this._hasValue}RemoveValue(){this._value=undefined;this._hasValue=false}}Calysto.BoxValue=BoxValue;class BoxValueObservable extends BoxValue{constructor(){super();this.OnSetValue=(new Calysto.MulticastDelegate).OnAdd(f=>{this.HasValue()&&f(this.GetValue())}).AsFunc(this)}SetValue(value){this._value=value;this._hasValue=true,this.OnSetValue.Invoke(f=>f(value))}}Calysto.BoxValueObservable=BoxValueObservable}(Calysto||(Calysto={})),function(Calysto){var Utility;(function(Utility){var Generators;(function(Generators){function GetRndCharsFromTable(table,finalLength){if(!(finalLength>0)){throw new Error("Invalid finalLength in Calysto.Utility.Generators.GetRndCharsFromTable(...)");}let tlen=table.length;if(!(tlen>0)){throw new Error("Invalid tlen in Calysto.Utility.Generators.GetRndCharsFromTable(...)");}let arr=[];while(tlen>0&&arr.length<finalLength){arr.push(table.charAt(Math.floor(Math.random()*tlen)))};return arr.join("")}function GetRndChars(finalLength,letterFirst=true,smallLetters=true,capitalLetters=true,numbers=true,specialChars=true){let arr=[],table="";letterFirst&&arr.push(GetRndCharsFromTable(_smallLetters+_capitalLetters,1));smallLetters&&(table+=_smallLetters),capitalLetters&&(table+=_capitalLetters),numbers&&(table+=_nums),specialChars&&(table+=_special),arr.push(GetRndCharsFromTable(table,finalLength));return arr.join("")}function GeneratePassword(length){return GetRndChars(length,!0,!0,!0,!0,!1)}function GenerateStrongPassword(length){return GetRndChars(length,!0,!0,!0,!0,!0)}function GenerateNumericPassword(length){return GetRndCharsFromTable(_nums,length)}function GenerateLabel(length){return GetRndChars(length,!0,!0,!0,!0,!1)}const _smallLetters="abcdefghijklmnopqrstuvwxyz",_capitalLetters="ABCDEFGHIJKLMNOPQRSTUVWXYZ",_nums="0123456789",_special="!@#$%^&*()_+=-~/][><.,?>:;'}{";Generators.GeneratePassword=GeneratePassword;Generators.GenerateStrongPassword=GenerateStrongPassword,Generators.GenerateNumericPassword=GenerateNumericPassword,Generators.GenerateLabel=GenerateLabel})(Generators=Utility.Generators||(Utility.Generators={}))})(Utility=Calysto.Utility||(Calysto.Utility={}))}(Calysto||(Calysto={})),function(Calysto){var ArraySorter;(function(ArraySorter){function GetKeyValue(item,keySelector){return keySelector?keySelector(item):item}function SortArray(arr,keySelector,descending){var arr1=arr.Select(item=>({item:item,sortKey:GetKeyValue(item,keySelector),typeNum:0,typeStr:"notset"})).Select(m=>{let key=m.sortKey;var sortType;if(key===undefined){sortType=SortTypeEnum.Undefined}else if(key===null){sortType=SortTypeEnum.Null}else if(key.constructor==Date){sortType=SortTypeEnum.Date}else switch(typeof key){case"string":sortType=SortTypeEnum.String;break;case"number":sortType=isNaN(key)?SortTypeEnum.NaN:SortTypeEnum.Number;break;case"boolean":sortType=SortTypeEnum.Boolean;break;default:sortType=SortTypeEnum.Object}m.typeNum=sortType;m.typeStr=sortType+"";return m}),groupsArr=[],groupsDic={},final;arr1.ForEach(m=>{let group=groupsDic[m.typeStr];group||(groupsDic[m.typeStr]=group=[],group.typeNum=m.typeNum,groupsArr.push(group));group.push(m)});groupsArr.sort((a,b)=>a.typeNum<b.typeNum?-1:a.typeNum>b.typeNum?1:0),groupsArr.ForEach(g=>g.sort((a,b)=>a.sortKey<b.sortKey?-1:a.sortKey>b.sortKey?1:0)),final=[],groupsArr.ForEach(g=>g.ForEach(m=>final.push(m.item))),descending&&final.reverse();return final}let SortTypeEnum;(function(SortTypeEnum){SortTypeEnum[SortTypeEnum.Undefined=1]="Undefined";SortTypeEnum[SortTypeEnum.Null=2]="Null",SortTypeEnum[SortTypeEnum.NaN=3]="NaN",SortTypeEnum[SortTypeEnum.Boolean=4]="Boolean",SortTypeEnum[SortTypeEnum.Number=5]="Number",SortTypeEnum[SortTypeEnum.Date=6]="Date",SortTypeEnum[SortTypeEnum.String=7]="String",SortTypeEnum[SortTypeEnum.Object=8]="Object"})(SortTypeEnum||(SortTypeEnum={}));ArraySorter.SortArray=SortArray})(ArraySorter=Calysto.ArraySorter||(Calysto.ArraySorter={}))}(Calysto||(Calysto={})),function(Calysto){var Enum;(function(Enum){function GetValue(objEnum,name){var val=objEnum[name];if(Calysto.Type.TypeInspector.IsNumber(val)){return val};throw new Error("enum name not found: "+name);}function GetValues(objEnum){var arr=[];Calysto.Collections.ForEachOwnProperties(objEnum,(name,value)=>{typeof value=="number"&&arr.push(value)});return arr}function HasValue(objEnum,value){var val=objEnum[value];return Calysto.Type.TypeInspector.IsString(val)?!0:!1}function HasName(objEnum,name){var val=objEnum[name];return Calysto.Type.TypeInspector.IsNumber(val)?!0:!1}function GetName(objEnum,value){var val=objEnum[value];if(Calysto.Type.TypeInspector.IsString(val)){return val};throw new Error("enum value not found: "+value);}function GetNames(objEnum){var arr=[];Calysto.Collections.ForEachOwnProperties(objEnum,(name,value)=>{typeof value=="string"&&arr.push(value)});return arr}Enum.GetValue=GetValue;Enum.GetValues=GetValues,Enum.HasValue=HasValue,Enum.HasName=HasName,Enum.GetName=GetName,Enum.GetNames=GetNames})(Enum=Calysto.Enum||(Calysto.Enum={}))}(Calysto||(Calysto={})),function(Calysto){class CalystoEnumerable{constructor(getEnumerator){if(typeof getEnumerator!="function"){throw new Error("GetEnumerator is not function");}this._getEnumerator=getEnumerator}GetEnumerator(){if(this._getEnumerator){return this._getEnumerator()};throw new Error("GetEnumerator is not defined");}AsEnumerable(){return this}AsIterableIterator(){let context1=this,box1=new Calysto.BoxValue,aa=function*(){let en1=context1.GetEnumerator();while(en1.YieldNext(box1)){yield en1.Current}};return aa()}ToArray(){for(var arr=[],en1=this.GetEnumerator(),refOut=new Calysto.BoxValue;en1.YieldNext(refOut)&&refOut.HasValue();){arr.push(refOut.GetValue()),refOut.RemoveValue()};return arr}AsDomQuery(){return new Calysto.DomQuery(()=>this.GetEnumerator())}ToList(){return new Calysto.List(this.ToArray())}Count(){return this.ToArray().length}ToDictionary(keySelector,valueSelector){typeof keySelector!="function"&&(keySelector=Calysto.Utility.Expressions.CompileLambdaExpression(keySelector));typeof valueSelector!="function"&&(valueSelector=Calysto.Utility.Expressions.CompileLambdaExpression(valueSelector));var dic2=new Calysto.Dictionary;this.ForEach(item=>dic2.Add(keySelector(item),valueSelector(item)));return dic2}ToRawObject(keySelector,valueSelector){typeof keySelector!="function"&&(keySelector=Calysto.Utility.Expressions.CompileLambdaExpression(keySelector));typeof valueSelector!="function"&&(valueSelector=Calysto.Utility.Expressions.CompileLambdaExpression(valueSelector));var dic={};this.ForEach(item=>dic[keySelector(item)+""]=valueSelector(item));return dic}ToStringJoined(separator){var arr=this.ToArray();return arr.join(separator||"")}ForEach(action){var arr,n;for(typeof action=="string"&&(action=Calysto.Utility.Expressions.CompileLambdaNoReturnCheck(action)),arr=this.ToArray(),n=0;n<arr.length;n++){action(arr[n],n)};return CalystoEnumerable.From(arr)}Skip(count){return CalystoEnumerable.From(()=>function*(__this){let currindex=-1;for(let item of __this.AsIterableIterator()){if(++currindex<count){continue}else yield item}}(this))}Take(count){return CalystoEnumerable.From(()=>function*(__this){let currindex=-1;for(let item of __this.AsIterableIterator()){if(++currindex<count){yield item}else break}}(this))}Single(){var el=this.Take(2).ToArray();if(el.length==1){return el[0]};if(el.length==0){throw new Error("Error in .Single(), sequence contains no elements");}else throw new Error("Error in .Single(), sequence contains more than single element");}Exact(count){if(!(count>=0)){throw new Error("Exact(count) requires count parameter >= 0");}var arr=this.ToArray();if(arr.length!=count){throw new Error("Error in .Exact(), sequence contains "+arr.length+" elements. Required is "+count+" elements.");}return CalystoEnumerable.From(arr)}Sum(selector){var val=null;this.Select(selector||(o=>o)).ForEach(o=>{Calysto.Type.TypeInspector.IsNumber(o)&&(val=(val||0)+o)});return val}Average(selector){var val=null,count=0;this.Select(selector||(o=>o)).ForEach(o=>{Calysto.Type.TypeInspector.IsNumber(o)&&(val=(val||0)+o,count++)});return count>0?val/count:0}Min(selector){var val=null;this.Select(selector||(o=>o)).ForEach(o=>{(Calysto.Type.TypeInspector.IsNumber(o)||Calysto.Type.TypeInspector.IsDate(o))&&(val==null||o<val)&&(val=o)});return val}Max(selector){var val=null;this.Select(selector||(o=>o)).ForEach(o=>{(Calysto.Type.TypeInspector.IsNumber(o)||Calysto.Type.TypeInspector.IsDate(o))&&(val==null||o>val)&&(val=o)});return val}Concat(secondSource){return CalystoEnumerable.From(()=>function*(__this){for(let item of __this.AsIterableIterator()){yield item};for(let item of secondSource.AsEnumerable().AsIterableIterator()){yield item}}(this))}Intersect(secondSource,predicate,excludeIntersection=false){if(!secondSource||!predicate){throw new Error("Intersect(secondSource, predicate) requires secondSource and predicate parameters");}var secondArr=secondSource.ToArray();typeof predicate=="string"&&(predicate=Calysto.Utility.Expressions.CompileLambdaExpression(predicate));return this.Where(item1=>!excludeIntersection==secondArr.Where(item2=>predicate(item1,item2)).Any())}Except(secondSource,predicate){return this.Intersect(secondSource,predicate,!0)}Join(innerSource,outerKeySelector,innerKeySelector,resultSelector){let innerDic=innerSource.AsEnumerable().ToDictionary(o=>innerKeySelector(o));return this.Select(outer=>{let res1=new Calysto.BoxValue,innerRef=new Calysto.BoxValue;innerDic.TryGetValue(outerKeySelector(outer),innerRef)&&res1.SetValue(resultSelector(outer,innerRef.GetValue()));return res1}).Where(o=>o.HasValue()).Select(o=>o.GetValue())}TakeWhile(predicate){if(!predicate){throw new Error("TakeWhile(predicate) requires predicate");}typeof predicate!="function"&&(predicate=Calysto.Utility.Expressions.CompileLambdaExpression(predicate));return CalystoEnumerable.From(()=>function*(__this){let currindex=-1;for(let item of __this.AsIterableIterator()){if(predicate(item,++currindex)){yield item}else break}}(this))}SkipWhile(predicate){if(!predicate){throw new Error("SkipWhile(predicate) requires predicate");}typeof predicate!="function"&&(predicate=Calysto.Utility.Expressions.CompileLambdaExpression(predicate));return CalystoEnumerable.From(()=>function*(__this){let takeRest=!1,currindex=-1;for(let item of __this.AsIterableIterator()){if(takeRest){yield item}else if(predicate(item,++currindex)){continue}else{takeRest=!0;yield item}}}(this))}Reverse(){return new CalystoEnumerable(()=>{var items=this.ToArray();items.reverse();return Calysto.CalystoEnumerator.From(items)})}FirstOrDefault(defaultValue){var arr=this.Take(1).ToArray();return arr.length==1?arr.pop():defaultValue}First(){var el=this.Take(1).ToArray();if(el.length==1){return el[0]};throw new Error("Error in .First(), sequence contains no elements");}LastOrDefault(defaultValue){var el=this.ToArray();return el.length>0?el[el.length-1]:defaultValue}Last(){var el=this.ToArray();if(el.length>0){return el[el.length-1]};throw new Error("Error in .Last(), sequence contains no elements");}Any(predicate){typeof predicate!="function"&&(predicate=Calysto.Utility.Expressions.CompileLambdaExpression(predicate));predicate=predicate||(()=>true);var arr=this.Where(predicate).Take(1).ToArray();return arr.length==1}All(predicate){return!this.Where((o,index)=>!predicate(o,index)).Any()}Where(predicate){typeof predicate!="function"&&(predicate=Calysto.Utility.Expressions.CompileLambdaExpression(predicate));return CalystoEnumerable.From(()=>function*(__this){let index=-1;for(let item of __this.AsIterableIterator()){if(predicate(item,++index)){yield item}else continue}}(this))}Select(selector){typeof selector!="function"&&(selector=Calysto.Utility.Expressions.CompileLambdaExpression(selector));return CalystoEnumerable.From(()=>function*(__this){let index=-1;for(let item of __this.AsIterableIterator()){yield selector(item,++index)}}(this))}Cast(){return this}SelectMany(selector){typeof selector!="function"&&(selector=Calysto.Utility.Expressions.CompileLambdaExpression(selector));return CalystoEnumerable.From(()=>function*(__this){let sel1=selector||(x=>x);for(let item of __this.AsIterableIterator()){if(item){let collection1=sel1(item);if(collection1){let enumerable2=CalystoEnumerable.From(collection1);for(let item2 of enumerable2.AsIterableIterator()){yield item2}}}}}(this))}Distinct(keySelector){typeof keySelector!="function"&&(keySelector=Calysto.Utility.Expressions.CompileLambdaExpression(keySelector));return CalystoEnumerable.From(()=>function*(__this){let sel1=keySelector||(x=>x),set=new Set;for(let item of __this.AsIterableIterator()){let key=sel1(item);if(!set.has(key)){set.add(key);yield item}}}(this))}Cycle(take){if(!take){throw new Error("Cycle requires take parameter");}return CalystoEnumerable.From(()=>function*(__this){let servedItems=0,abort=!1;do for(let item of __this.AsIterableIterator()){if(servedItems<take){yield item;servedItems++}else{abort=!0;break}}while(!abort&&servedItems>0&&servedItems<take)}(this))}GroupBy(keySelector){typeof keySelector!="function"&&(keySelector=Calysto.Utility.Expressions.CompileLambdaExpression(keySelector));let dic=new Calysto.Dictionary,srcen=this.ToArray();for(let item of srcen){let key=keySelector(item),arr;dic.ContainsKey(key)?arr=dic.GetValue(key):dic.Add(key,arr=[]);arr.push(item)}return dic.GetItems().AsEnumerable().Select(o=>new CalystoGroupingGroup(o.Key,()=>o.Value.AsEnumerable().GetEnumerator()))}OrderBy(keySelector,descending=false){typeof keySelector!="function"&&(keySelector=Calysto.Utility.Expressions.CompileLambdaExpression(keySelector));let groups=this.GroupBy(keySelector).ToArray();var sorted=groups.OrderBy(group=>group.Key,descending);return new CalystoOrderedEnumerable(()=>sorted.AsEnumerable().GetEnumerator())}OrderByDescending(keySelector){typeof keySelector!="function"&&(keySelector=Calysto.Utility.Expressions.CompileLambdaExpression(keySelector));return this.OrderBy(keySelector,!0)}static From(source){return new CalystoEnumerable(()=>Calysto.CalystoEnumerator.From(source))}static Range(start,count){return CalystoEnumerable.From(function*(){let taken=0;while(taken<count){yield start;start++;taken++}})}static Repeat(item,count){return CalystoEnumerable.From(function*(){let taken=0;while(taken<count){yield item;taken++}})}}Calysto.CalystoEnumerable=CalystoEnumerable;class CalystoGroupingGroup extends CalystoEnumerable{constructor(Key,getEnumerator){super(getEnumerator);this.Key=Key}}class CalystoOrderedEnumerable extends CalystoEnumerable{constructor(getGroupsEnumerator){super(()=>this.GetFlatEnumerable().GetEnumerator());this.getGroupsEnumerator=getGroupsEnumerator}GetFlatEnumerable(){return this.GetGroupsEnumerable().SelectMany(group=>group)}GetGroupsEnumerable(){return new CalystoEnumerable(this.getGroupsEnumerator)}ThenBy(keySelector,descending=false){let miniGroups=new CalystoEnumerable(this.getGroupsEnumerator).SelectMany(group=>group.OrderBy(keySelector,descending).GetGroupsEnumerable());return new CalystoOrderedEnumerable(()=>miniGroups.GetEnumerator())}ThenByDescending(keySelector){return this.ThenBy(keySelector,!0)}}}(Calysto||(Calysto={})),function(Calysto){var Collections;(function(Collections){function SelectFlatten(){for(var tmpObj,arr2,n2,res2,arrRes=[],n1=0;n1<arguments.length;n1++){if(tmpObj=arguments[n1],tmpObj==undefined){continue}else if(tmpObj.GetEnumerator&&tmpObj.ToArray){for(arr2=tmpObj.ToArray(),n2=0;n2<arr2.length;n2++){res2=SelectFlatten(arr2[n2]),arrRes.AddRange(res2)}}else if(tmpObj.tagName&&tmpObj.nodeType||tmpObj.nodeType==Calysto.Utility.Dom.NodeTypeEnum.TEXT_NODE){arrRes.push(tmpObj)}else if(tmpObj.length>=0){if(typeof tmpObj=="string"){arrRes.push(tmpObj)}else for(n2=0;n2<tmpObj.length;n2++){res2=SelectFlatten(tmpObj[n2]),arrRes.AddRange(res2)}}else arrRes.push(tmpObj)};return arrRes}function ForEach(array,delegate,context){if(typeof array=="string"){throw new Error("ForEach does not accept string");}if(array&&array.length>0){for(var nn=0;nn<array.length;nn++){delegate.call(context,array[nn],nn)}}}function ForEachNodeList(array,delegate,context){if(array&&array.length>0){for(var nn=0;nn<array.length;nn++){delegate.call(context,array[nn],nn)}}}function ForEachChars(str,delegate,context){if(typeof str!="string"){throw new Error("ForEachChars requires string argument");}if(str&&str.length>0){for(var nn=0;nn<str.length;nn++){delegate.call(context,str.charAt(nn),nn)}}}function GetProperties(obj,ownPropertiesOnly){var arr=[],prop;if(obj){for(prop in obj){(!ownPropertiesOnly||obj.hasOwnProperty(prop))&&arr.push(prop)}};return arr}function GetOwnProperties(obj){return GetProperties(obj,!0)}function ForEachProperties(obj,delegate,context){var index,prop;if(obj){index=0;for(prop in obj){delegate.call(context,prop,obj[prop],index++)}}}function ForEachOwnProperties(obj,delegate,context){var index,prop;if(obj){index=0;for(prop in obj){obj.hasOwnProperty(prop)&&delegate.call(context,prop,obj[prop],index++)}}}function HasInnerArray(obj){return obj&&_innerArray in obj}function GetInnerArray(obj){return HasInnerArray(obj)?obj[_innerArray]:undefined}Collections.SelectFlatten=SelectFlatten;Collections.ForEach=ForEach,Collections.ForEachNodeList=ForEachNodeList,Collections.ForEachChars=ForEachChars,Collections.GetProperties=GetProperties,Collections.GetOwnProperties=GetOwnProperties,Collections.ForEachProperties=ForEachProperties,Collections.ForEachOwnProperties=ForEachOwnProperties;let _innerArray="InnerArray";Collections.HasInnerArray=HasInnerArray;Collections.GetInnerArray=GetInnerArray})(Collections=Calysto.Collections||(Calysto.Collections={}))}(Calysto||(Calysto={}));Array.prototype.RemoveAt||function(){Array.prototype.indexOf||(Array.prototype.indexOf=function(item){for(var n=0;n<this.length;n++){if(this[n]===item){return n}};return-1}),Array.prototype.SkipTake=function(skip,take){return this.slice(skip,skip+take)},Array.prototype.ForEach=function(action){typeof action=="string"&&(action=Calysto.Utility.Expressions.CompileLambdaNoReturnCheck(action)),Calysto.Collections.ForEach(this,action);return this},Array.prototype.Where=function(predicate,take){typeof predicate=="string"&&(predicate=Calysto.Utility.Expressions.CompileLambdaExpression(predicate));var a1=[];for(let n=0;n<this.length;n++){if(predicate(this[n],n)&&(a1.push(this[n]),take&&a1.length>=take)){return a1}};return a1},Array.prototype.Select=function(selector){typeof selector=="string"&&(selector=Calysto.Utility.Expressions.CompileLambdaExpression(selector));var a1=[];Calysto.Collections.ForEach(this,(item,index)=>{a1.push(selector(item,index))});return a1},Array.prototype.Reverse=function(){this.reverse();return this},Array.prototype.OrderBy=function(keySelector,descending){typeof keySelector=="string"&&(keySelector=Calysto.Utility.Expressions.CompileLambdaExpression(keySelector));return Calysto.ArraySorter.SortArray(this,keySelector,descending)},Array.prototype.RemoveAt=function(index){this.splice(index,1);return this},Array.prototype.Remove=function(item){var index=this.indexOf(item);return index==0||index>0?this.RemoveAt(index):this},Array.prototype.RemoveBy=function(predicate){typeof predicate=="string"&&(predicate=Calysto.Utility.Expressions.CompileLambdaExpression(predicate));for(let n1=this.length-1;n1>=0;n1--){predicate(this[n1],n1)&&this.splice(n1,1)};return this},Array.prototype.Contains=function(value){let index=this.indexOf(value);return index>0||index===0},Array.prototype.AsEnumerable=function(){return Calysto.CalystoEnumerable.From(this.slice(0))},Array.prototype.ToArray=function(){return this.slice(0)},Array.prototype.Any=function(){return this.length>0},Array.prototype.Add=function(item){this.push(item);return this},Array.prototype.AddRange=function(arr){for(var n1=0;arr&&n1<arr.length;n1++){this.push(arr[n1])};return this},Array.prototype.InsertRange=function(atIndex,arr){for(var n1=arr.length;n1>0;n1--){this.splice(atIndex,0,arr[n1-1])};return this},Array.prototype.Clear=function(){this.splice(0,this.length);return this},Array.prototype.ToStringJoined=function(separator){return this.join(arguments.length>0?separator:"")}}(),function(){var _a,_b;if(!window.Symbol){let fn1=function(){};fn1.iterator={},window.Symbol=fn1}class CalystoMapInternal{constructor(){this._kvArr=[]}get size(){return this._kvArr.length}has(key){return this._kvArr.Where(o=>o.key===key,1).Any()}get(key){return this._kvArr.Where(o=>o.key===key,1).Select(o=>o.value).pop()}set(key,value){let kv=this._kvArr.Where(o=>o.key===key,1).pop();kv?kv.value=value:this._kvArr.push({key:key,value:value});return this}add(key,value){return this.set(key,value||true)}delete(key){let kv=this.get(key);this._kvArr.RemoveBy(o=>o.key==key);return!!kv}clear(){this._kvArr.Clear()}*keys(){for(let item of this._kvArr){yield item.key}}*entries(){for(let item of this._kvArr){yield[item.key,item.value]}}}((_b=(_a=window.Map)===null||_a===void 0?void 0:_a.prototype)===null||_b===void 0?void 0:_b.entries)||(window.Set=CalystoMapInternal,window.Map=CalystoMapInternal)}(Calysto||(Calysto={})),Math.trunc||(Math.trunc=x=>isFinite(x)&&!isNaN(x)?parseInt((x+"").split(".")[0],10):x),typeof Blob=="undefined"||Blob.prototype.SaveFileAs||(Blob.prototype.SaveFileAs=function(filename){var blob=this,el;navigator&&navigator.msSaveOrOpenBlob?navigator.msSaveOrOpenBlob(blob,filename||blob.filename):(el=document.createElement("a"),el.style.position="absolute",el.style.opacity="0",el.href=window.URL.createObjectURL(blob),el.download=filename||blob.filename,document.body.appendChild(el),el.click(),el.parentNode&&el.parentNode.removeChild(el))}),Boolean.prototype.ToStringFormated||(Boolean.prototype.ToStringFormated=function(){return this==true?"true":"false"}),Date.FromLocalISOTString||function(){Date.now=function(){return(new Date).getTime()};var fnPadLeft=function(n,places){for(n+="";n.length<places;){n="0"+n};return n},fnPadRight=function(n,places){for(n+="";n.length<places;){n=n+"0"};return n};Date.ToLocalISOTString=date=>fnPadLeft(date.getFullYear(),4)+"-"+fnPadLeft(date.getMonth()+1,2)+"-"+fnPadLeft(date.getDate(),2)+"T"+fnPadLeft(date.getHours(),2)+":"+fnPadLeft(date.getMinutes(),2)+":"+fnPadLeft(date.getSeconds(),2)+"."+fnPadRight(date.getMilliseconds(),3),Date.FromLocalISOTString=function(dateStr){var m=dateStr.match(new RegExp("[\\d]+","g")),date=new Date(0);m&&(date.setFullYear(parseInt(m[0])),date.setMonth(parseInt(m[1])-1),date.setDate(parseInt(m[2])),date.setHours(parseInt(m[3])),date.setMinutes(parseInt(m[4])),date.setSeconds(parseInt(m[5])),date.setMilliseconds(parseInt(fnPadRight(m[6]||"",3).substr(0,3))||0));return date}}(),typeof Error!="undefined"&&(Error.prototype.AppendErrorDetails=function(additionalInfo,isServerError){var detailsArr=[],htmlArr=[];if(additionalInfo){try{typeof additionalInfo=="string"?detailsArr.push(additionalInfo):"length"in additionalInfo?Calysto.Collections.ForEach(additionalInfo,item=>detailsArr.push(item)):Calysto.Collections.ForEachProperties(additionalInfo,(name,value)=>{name=="errorHtml"?htmlArr.push(value):name=="errorDescription"?detailsArr.push(value):detailsArr.push(name+": "+value)})}catch(ex2){}}this.CalystoException={Message:this.message,Details:detailsArr.join("\r\n"),HtmlDetails:htmlArr.join("<br/>"),IsServerError:!!isServerError};return this}),Function.prototype.BindContext||(Function.prototype.BindContext=function(context){if(arguments.length!=1){throw new Error("BindContext(...) requires 1 argument exactly, current arguments: "+arguments.length);}var method=this,cx=context||this||null;return function(){return method.apply(cx,arguments)}}),function(Calysto){var Utility;(function(Utility){var Expressions;(function(Expressions){function ParsePath(pathExpression){let m1=(pathExpression+"").match(new RegExp("return[\\s]+[\\w]+\\.([\\w\\.\\[\\]_@]+)"));if(m1&&m1[1]){return m1[1]};throw new Error("Invalid path expression: "+pathExpression);}function ParseExpression(expression,checkReturn){var type=typeof expression,fnstr,index1;if(expression){if(type=="function"){if(Calysto.Core.IsDebugDefined&&checkReturn&&(fnstr=(expression+"").substr(0,1e3),!(fnstr.indexOf("return")>0)&&!(fnstr.indexOf("=>")>0))){throw Error("Invalid lambda, missing return in: "+fnstr);}return expression}if(type=="string"){try{if(expression==""){return function(x){return x}};if((index1=expression.indexOf("=>"))>0){var left=expression.substr(0,index1),right=expression.substr(index1+2),parNames=left.match(new RegExp("[\\w$@_]+","ig"))||[],mm;return(mm=right.match(new RegExp("^[\\s]*new[\\s]+(\\{[\\w\\W]*)$")))?new Function(parNames.join(","),"return "+mm[1]+";"):new RegExp("^[\\s]*\\{").test(right)?new Function(parNames.join(","),right+";"):new Function(parNames.join(","),"return "+right+";")}}catch(err1){throw new Error(err1+"\r\nin "+expression);}}}else return function(x){return x};throw new Error("Unsupported expression in Calysto.Utility.Expressions.CompileLambdaExpression("+expression+")");}function CompileLambdaExpression(expression){return ParseExpression(expression,true)}function CompileLambdaNoReturnCheck(expression){return ParseExpression(expression,false)}Expressions.ParsePath=ParsePath,Expressions.CompileLambdaExpression=CompileLambdaExpression,Expressions.CompileLambdaNoReturnCheck=CompileLambdaNoReturnCheck})(Expressions=Utility.Expressions||(Utility.Expressions={}))})(Utility=Calysto.Utility||(Calysto.Utility={}))}(Calysto||(Calysto={})),RegExp.Escape||function(){var reEscape=new RegExp("[ \\\\\\*\\+\\?\\|\\,\\^\\$\\.\\#\\(\\)\\{\\}\\[\\]]","g");RegExp.Escape=function(str){return str.replace(reEscape,"\\$&")}}(),function(Calysto){var Utility;(function(Utility){function Extend(destination,source,mayOverwrite,ownPropertiesOnly){for(var prop in source){(!ownPropertiesOnly||source.hasOwnProperty(prop))&&(!mayOverwrite&&prop in destination||(destination[prop]=source[prop]))};return destination}Utility.Extend=Extend})(Utility=Calysto.Utility||(Calysto.Utility={}))}(Calysto||(Calysto={})),function(Calysto){var Type;(function(Type){let KnownType;(function(KnownType){KnownType[KnownType.String=1]="String",KnownType[KnownType.Boolean=2]="Boolean",KnownType[KnownType.Decimal=3]="Decimal",KnownType[KnownType.Number=4]="Number",KnownType[KnownType.Integer=5]="Integer",KnownType[KnownType.Array=6]="Array",KnownType[KnownType.Function=7]="Function",KnownType[KnownType.DateTime=8]="DateTime",KnownType[KnownType.Date=9]="Date",KnownType[KnownType.Any=10]="Any"})(KnownType=Type.KnownType||(Type.KnownType={}))})(Type=Calysto.Type||(Calysto.Type={}))}(Calysto||(Calysto={})),function(Calysto){var Type;(function(Type){var NumberConverter;(function(NumberConverter){function ToNumberWithCulture(strOrNum,defaultValue,decimalSeparator){if(Type.TypeInspector.IsNumber(strOrNum)){return strOrNum};isNaN(defaultValue)||Type.TypeInspector.IsNullOrUndefined(defaultValue)&&(defaultValue=null),decimalSeparator=decimalSeparator||Calysto.Globalization.CultureInfo.CurrentCulture.NumberFormat.NumberDecimalSeparator;var re=new RegExp("[\\-]*[ ]*[ \\.\\,]?[\\d]+[\\d\\.\\,]*"),m=(strOrNum+"").match(re),str1=m&&m[0]?m[0]:"",str2=str1.replace(new RegExp(RegExp.Escape(decimalSeparator=="."?",":"."),"ig"),"").replace(new RegExp(RegExp.Escape(decimalSeparator),"ig"),".").replace(new RegExp("[ ]*","ig"),""),parsed=parseFloat(str2);return!isNaN(parsed)&&isFinite(parsed)?parsed:defaultValue}function ToNumberOrDefault(strOrNum,defaultValue,decimalSeparator){return ToNumberWithCulture(strOrNum,defaultValue,decimalSeparator)}function ToDecimal(strOrNum,defaultValue,decimalSeparator){return ToNumberWithCulture(strOrNum,defaultValue,decimalSeparator)}function ToInteger(strOrNum,defaultValue){Type.TypeInspector.IsNullOrUndefined(defaultValue)&&(defaultValue=NaN);var num=ToNumberOrDefault(strOrNum,defaultValue);return!isNaN(num)&&isFinite(num)?num>0?Math.floor(num):Math.ceil(num):defaultValue}function ToBoolean(str,defaultValue){return Type.TypeInspector.IsBoolean(str)?str:str=="true"||str=="True"?true:str=="false"||str=="False"?false:str>0?true:str===0?false:Type.TypeInspector.IsNullOrUndefined(defaultValue)?null:defaultValue}function ToString(value,defaultValue){if(Type.TypeInspector.IsNullOrUndefined(value)){if(!Type.TypeInspector.IsNullOrUndefined(defaultValue)){return defaultValue+""}}else return value+"";return""}NumberConverter.ToNumberOrDefault=ToNumberOrDefault,NumberConverter.ToDecimal=ToDecimal,NumberConverter.ToInteger=ToInteger,NumberConverter.ToBoolean=ToBoolean,NumberConverter.ToString=ToString})(NumberConverter=Type.NumberConverter||(Type.NumberConverter={}))})(Type=Calysto.Type||(Calysto.Type={}))}(Calysto||(Calysto={})),function(Calysto){var Type;(function(Type){var TypeConverter;(function(TypeConverter){function ToStringFormated(obj,format){return Type.TypeInspector.IsNullOrUndefined(obj)?"":obj&&obj.ToStringFormated?obj.ToStringFormated(format):ChangeType(obj,"String")}function ChangeType(obj,toType,mayBeNull){var num,dt;if(toType=="Int"){throw new Error("Int is not supported, use Integer instead");}let destType=typeof toType=="string"?Type.TypeDescriptor.FromTypeName(toType,mayBeNull):toType;if(!destType.IsValidKnownType){throw new Error("Invalid destType: "+toType);}if(Type.TypeInspector.IsNullOrUndefined(obj)||destType.KnownTypeName!=Type.KnownType.String&&obj===""){if(destType.IsNullable){return null};throw new Error("Error in ChangeType(). Can not convert null to "+toType);}let currType=Type.TypeDescriptor.FromValue(obj);if(currType.UnderlayingTypeName==destType.UnderlayingTypeName){return obj};switch(destType.KnownTypeName){case Type.KnownType.String:return currType.KnownTypeName==Type.KnownType.String?obj:Type.TypeInspector.IsNullOrUndefined(obj)?"":obj.ToStringFormated?obj.ToStringFormated():obj&&obj.join?"["+obj.join(",")+"]":obj+"";case Type.KnownType.Boolean:if(currType.KnownTypeName==Type.KnownType.Boolean){return obj};if(obj===true||obj=="true"||obj=="True"||obj=="1"){return true};if(obj===false||obj=="false"||obj=="False"||obj=="0"){return false};if(typeof obj=="number"){return obj===0?false:true};throw new Error("Can not create boolean from: "+obj);case Type.KnownType.Decimal:case Type.KnownType.Number:case Type.KnownType.Integer:if(!Type.TypeInspector.IsNumber(obj)){let re1=new RegExp("^[\\+\\-]*[\\s]*[\\d\\,\\.]+$");if(!re1.test(obj+"")){throw new Error("Can not create number from: "+obj);}}if(num=Type.NumberConverter.ToDecimal(obj),Type.TypeInspector.IsNumber(num)){return destType.KnownTypeName==Type.KnownType.Integer?parseInt(num):num};throw new Error("Can not create number from: "+obj);case Type.KnownType.DateTime:case Type.KnownType.Date:if(typeof obj=="string"){try{if(dt=Calysto.DateTime.ParseDateTime(obj,undefined,true),!dt){throw new Error("Can not create DateTime from "+obj);}return dt&&destType.KnownTypeName==Type.KnownType.Date?dt.ToSystemDate():dt}catch(e){}}throw new Error("Can not create DateTime from "+obj);case Type.KnownType.Function:return Calysto.Utility.Expressions.CompileLambdaExpression(obj);case Type.KnownType.Array:return obj.Trim(["[","]"]).Split([","]).Select(o=>o.Trim())}throw new Error("Can not create "+toType+" from "+obj);}function TryChangeType(obj,toType,refOut){try{refOut.SetValue(ChangeType(obj,toType));return true}catch(e1){}return false}TypeConverter.ToStringFormated=ToStringFormated,TypeConverter.ChangeType=ChangeType,TypeConverter.TryChangeType=TryChangeType})(TypeConverter=Type.TypeConverter||(Type.TypeConverter={}))})(Type=Calysto.Type||(Calysto.Type={}))}(Calysto||(Calysto={})),function(Calysto){var Type;(function(Type){class TypeDescriptor{get UnderlayingTypeName(){return this._typeName}get KnownTypeName(){return Type.KnownType[this._typeName]}get IsNullable(){return!!this._isNullable}get NullableTypeName(){return this.UnderlayingTypeName+(this.IsNullable?"?":"")}get IsValidKnownType(){return!!this.KnownTypeName}static ResolveKnownTypeFromValue(value){if(Type.TypeInspector.IsNullOrUndefined(value)){return Type.KnownType.Any};if(Type.TypeInspector.IsString(value)){return Type.KnownType.String};if(Type.TypeInspector.IsBoolean(value)){return Type.KnownType.Boolean};if(Type.TypeInspector.IsNumber(value)){return Type.KnownType.Decimal};if(Type.TypeInspector.IsArrayOrDomArray(value)){return Type.KnownType.Array};if(Type.TypeInspector.IsFunction(value)){return Type.KnownType.Function};if(Type.TypeInspector.IsDateTime(value)){return Type.KnownType.DateTime};if(Type.TypeInspector.IsDate(value)){return Type.KnownType.Date};throw new Error("Can not reslove KnownType from value "+value);}static FromTypeName(typeName,isNullable){let tt=new TypeDescriptor;if(tt._isNullable=isNullable===true,tt._typeName=typeName,(typeName||"").indexOf("?")>0){let name=(typeName||"").TrimEnd([" ","?"]);tt._typeName=name,tt._isNullable=true}return tt}static FromValue(value,isNullable){return TypeDescriptor.FromTypeName(Type.KnownType[TypeDescriptor.ResolveKnownTypeFromValue(value)],isNullable||Type.TypeInspector.IsNullOrUndefined(value))}}Type.TypeDescriptor=TypeDescriptor})(Type=Calysto.Type||(Calysto.Type={}))}(Calysto||(Calysto={})),function(Calysto){var Type;(function(Type){var TypeInspector;(function(TypeInspector){function fnTest(arr,fn){if(arr&&arr.length>0){for(var n=0;n<arr.length;n++){if(!fn(arr[n])){return false}};return true}return false}function ContainsProperty(obj,property){return obj&&property&&obj[property]!==undefined}function IsBoolean(){return fnTest(arguments,obj=>typeof obj=="boolean")}function IsNumber(){return fnTest(arguments,obj=>typeof obj!="number"||isNaN(obj)||isFinite(obj))}function IsString(){return fnTest(arguments,obj=>typeof obj=="string")}function IsArray(){return fnTest(arguments,obj=>obj&&obj.push&&obj.pop&&(obj.length>0||obj.length===0))}function IsDomArray(){return fnTest(arguments,obj=>{var type=typeof obj;return obj&&(type=="object"||type=="function")&&!(type.tagName&&type.nodeType)&&(obj.length>0||obj.length===0)&&!IsFunction(obj)})}function IsArrayOrDomArray(){return IsArray.apply(null,arguments)||IsDomArray.apply(null,arguments)}function IsFunction(){return fnTest(arguments,function(obj){return typeof obj=="function"&&"call"in obj&&"apply"in obj})}function IsNullOrUndefined(){return arguments.length==0?true:fnTest(arguments,function(obj){return obj===null||typeof obj=="undefined"?true:typeof obj=="number"&&(isNaN(obj)||!isFinite(obj))?true:false})}function IsValueType(){return IsString.apply(null,arguments)||IsNumber.apply(null,arguments)||IsBoolean.apply(null,arguments)}function IsDateTime(value){return value&&value.constructor==Calysto.DateTime}function IsDate(value){return value&&value.constructor==Date}function Coalesce(){for(var tmp,n=0;n<arguments.length;n++){if(tmp=arguments[n],!IsNullOrUndefined(tmp)){return tmp}}}function AreValuesEqual(obj1,obj2){return obj1===obj2?true:window.JSON?JSON.stringify(obj1)===JSON.stringify(obj2):false}function CalculateHashCode(obj){if(obj===null||obj===void 0?void 0:obj.__$$hash){return obj===null||obj===void 0?void 0:obj.__$$hash};let val1=JSON.stringify(obj);typeof val1!="string"&&(val1=obj+"");try{obj.__$$hash=val1}catch(e){}return val1}TypeInspector.ContainsProperty=ContainsProperty,TypeInspector.IsBoolean=IsBoolean,TypeInspector.IsNumber=IsNumber,TypeInspector.IsString=IsString,TypeInspector.IsArray=IsArray,TypeInspector.IsDomArray=IsDomArray,TypeInspector.IsArrayOrDomArray=IsArrayOrDomArray,TypeInspector.IsFunction=IsFunction,TypeInspector.IsNullOrUndefined=IsNullOrUndefined,TypeInspector.IsValueType=IsValueType,TypeInspector.IsDateTime=IsDateTime,TypeInspector.IsDate=IsDate,TypeInspector.Coalesce=Coalesce,TypeInspector.AreValuesEqual=AreValuesEqual,TypeInspector.CalculateHashCode=CalculateHashCode})(TypeInspector=Type.TypeInspector||(Type.TypeInspector={}))})(Type=Calysto.Type||(Calysto.Type={}))}(Calysto||(Calysto={})),function(Calysto){var Mathm;(function(Mathm){function NewGuid(){var d=(new Date).getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(new RegExp("[xy]","g"),function(c){var r=(d+Math.random()*16)%16|0;d=Math.floor(d/16);return(c=="x"?r:r&7|8).toString(16)})}function Random(minVal,maxVal){if(minVal=Calysto.Type.TypeInspector.IsNumber(minVal)?minVal:0,maxVal=Calysto.Type.TypeInspector.IsNumber(maxVal)?maxVal:1,minVal>maxVal){throw new Error("Invalid range in Calysto.Mathm.Random(...)");}return Math.random()*(maxVal-minVal)+minVal}function RandomInt(minVal,maxVal){return Math.floor(Random(Calysto.Type.TypeInspector.IsNumber(minVal)?minVal:0,Calysto.Type.TypeInspector.IsNumber(maxVal)?maxVal:100))}function RunFunc(funcName,num,decimalPlaces){if(!(decimalPlaces==0||decimalPlaces>0)){throw new Error("Missing decimalPlaces");}var mult=Math.pow(10,decimalPlaces);return Math[funcName](num*mult)/mult}function DecimalFloor(num,decimalPlaces){return RunFunc("floor",num,decimalPlaces)}function DecimalCeil(num,decimalPlaces){return RunFunc("ceil",num,decimalPlaces)}function DecimalRound(num,decimalPlaces){return RunFunc("round",num,decimalPlaces)}function DecimalTrunc(num,decimalPlaces){return RunFunc("trunc",num,decimalPlaces)}Mathm.NewGuid=NewGuid,Mathm.Random=Random,Mathm.RandomInt=RandomInt,Mathm.DecimalFloor=DecimalFloor,Mathm.DecimalCeil=DecimalCeil,Mathm.DecimalRound=DecimalRound,Mathm.DecimalTrunc=DecimalTrunc})(Mathm=Calysto.Mathm||(Calysto.Mathm={}))}(Calysto||(Calysto={})),Number.prototype.ToStringFormated||(Number.prototype.ToStringFormated=function(format){let _tmpthis=this;if(isFinite(_tmpthis)&&!isNaN(_tmpthis)){let minDecPlaces=0,maxDecPlaces=0,isCurrency=false,useThousandsSepator=false,m1;if(format){if(m1=format.toLowerCase().match(new RegExp("([NnCc])([\\d]*)"))){if(useThousandsSepator=true,m1[1]=="c"&&(isCurrency=true),minDecPlaces=maxDecPlaces=!m1[2]?2:parseInt(m1[2],10),m1[3]&&(maxDecPlaces=parseInt(m1[3])),maxDecPlaces>15){throw new Error("Number format, allowed maxDecPlaces is 15, current: "+maxDecPlaces);}}else if(format.indexOf("#")>=0&&(m1=format.match(new RegExp("([\\,\\.]*)([\\#]*)([0]*)([\\,\\.]+)([0]*)([\\#]*)$")))){let thousandSeparator=m1[1];useThousandsSepator=!!thousandSeparator;let decimalSeparator=m1[4];minDecPlaces=(m1[5]||"").length,maxDecPlaces=minDecPlaces+(m1[6]||"").length}else throw new Error("Unsupported number format in Number.ToStringFormated("+format+")");}else maxDecPlaces=15;let rounded=Calysto.Mathm.DecimalRound(_tmpthis,maxDecPlaces),isNegative=rounded<0,parts=(Math.abs(rounded)+"").split("."),intpart=parts[0],decpart=parts[1]||"";while(decpart.length<minDecPlaces){decpart+="0"};if(decpart&&(decpart=Calysto.Globalization.CultureInfo.CurrentCulture.NumberFormat.NumberDecimalSeparator+decpart),useThousandsSepator){let arr=intpart.split(""),chars1=[],tmp1;while(tmp1=arr.pop()){(chars1.length+1)%4==0&&chars1.unshift(Calysto.Globalization.CultureInfo.CurrentCulture.NumberFormat.NumberGroupSeparator),chars1.unshift(tmp1)};intpart=chars1.join("")}let numStr=(isNegative?"-":"")+intpart+decpart;return isCurrency?Calysto.Globalization.CultureInfo.CurrentCulture.NumberFormat.CurrencyPositivePatternString.replace("{CurrencySymbol}",Calysto.Globalization.CultureInfo.CurrentCulture.NumberFormat.CurrencySymbol).replace("{Value}",numStr):numStr}throw new Error("NaN or undefined number can not be formated to string");}),function(){function Trim(str,charsArray,trimStart,trimEnd){if(!str){return str};var restr=trimDefault;charsArray&&(restr="("+fnCreateRegexStr(charsArray)+")+"),arguments.length<4&&(trimEnd=true),arguments.length<3&&(trimStart=true),trimEnd&&trimStart?restr="(^"+restr+")|("+restr+"$)":trimEnd?restr+="$":trimStart&&(restr="^"+restr);return str.replace(new RegExp(restr,"g"),"")}function TakeSplitByWords(str,maxLength,takeLast,elipsis){for(var maxTextLength=maxLength-(elipsis||"").length,currentLength=0,list=[],split,re=new RegExp("([\\w]+)|([^\\w]+)","ig"),matches=[],m,nn;m=re.exec(str);){matches.push(m)};for(takeLast&&matches.reverse(),nn=0;nn<matches.length;nn++){if(m=matches[nn],currentLength+=m[0].length,m[2]){split=(split||"")+m[0];continue}else if(currentLength>maxTextLength){break}else split&&(list.push(split),split=null),list.push(m[0])};elipsis&&list.push(elipsis),takeLast&&list.reverse();return list.join("")}var fnCreateRegexStr=function(strCharArray){var arr,n;if(typeof strCharArray=="string"){return RegExp.Escape(strCharArray)};for(arr=[],n=0;n<strCharArray.length;n++){arr.push(RegExp.Escape(strCharArray[n]))};return arr.join("|")},trimDefault;String.IsNullOrEmpty=function(){var n,tt,type;if(arguments.length==0){return true};for(n=0;n<arguments.length;n++){if(tt=arguments[n],type=typeof tt,!tt||type!="string"&&type!="object"||!(tt.length>0)){return true}};return false},String.IsNullOrWhiteSpace=function(){var n,tt,type;if(arguments.length==0){return true};for(n=0;n<arguments.length;n++){if(tt=arguments[n],type=typeof tt,!tt||type!="string"&&type!="object"||!(tt.length>0)||new RegExp("^[\\s]+$").test(tt)){return true}};return false},String.prototype.ToCharArray=function(){for(var str=this+"",arr=[],n=0;n<str.length;n++){arr.push(str.charAt(n))};return arr},String.prototype.Equals=function(string2,ignoreCase){var string1=this+"";if(string1===string2){return true};if(ignoreCase){string1&&(string1=string1.toLowerCase()),string2&&(string2=string2.toLowerCase());return string1===string2}return false},trimDefault="("+fnCreateRegexStr([" ","\r","\n","\t"])+")+",String.prototype.Trim=function(charsArray){var str=this+"";return charsArray?Trim(str,charsArray,true,true):str.replace(new RegExp("(^[\\s]+)|([\\s]+$)","g"),"")},String.prototype.TrimStart=function(charsArray){var str=this+"";return charsArray?Trim(str,charsArray,true,false):str.replace(new RegExp("(^[\\s]+)","g"),"")},String.prototype.TrimEnd=function(charsArray){var str=this+"";return charsArray?Trim(str,charsArray,false,true):str.replace(new RegExp("([\\s]+$)","g"),"")},String.prototype.EndsWith=function(secondStr,ignoreCase){var str=this+"",re;if(!str||!secondStr){return false};re=new RegExp(fnCreateRegexStr(secondStr)+"$",ignoreCase?"ig":"g");return re.test(str)},String.prototype.StartsWith=function(secondStr,ignoreCase){var str=this+"",re;if(!str||!secondStr){return false};if(ignoreCase){re=new RegExp("^"+fnCreateRegexStr(secondStr),ignoreCase?"ig":"g");return re.test(str)}return str.indexOf(secondStr)==0},String.prototype.Contains=function(secondStr,ignoreCase){var str=this+"",re,index;if(!str||!secondStr){return false};if(ignoreCase){re=new RegExp(fnCreateRegexStr(secondStr),ignoreCase?"ig":"g");return re.test(str)}index=str.indexOf(secondStr);return index>=0},String.prototype.Substring=function(startIndex,length){var str=this+"",maxlen;if(!str){return str};maxlen=str.length-startIndex;return(length||0)>maxlen?str.substr(startIndex):str.substr(startIndex,length)},String.prototype.Remove=function(startIndex){var str=this+"";return str&&str.length>0&&startIndex>=0?str.substr(0,startIndex):""},String.prototype.Repeat=function(count){for(var str=this+"",arr=[],n=0;n<count;n++){arr.push(str)};return arr.join("")},String.prototype.TakeFirst=function(count,elipsis,wordSplit){var str=this+"";return!str||count>str.length?str:wordSplit?TakeSplitByWords(str,count,false,elipsis):str.substr(0,count-(elipsis?elipsis.length:0))+(elipsis||"")},String.prototype.TakeLast=function(count,elipsis,wordSplit){var str=this+"";return!str||count>str.length?str:wordSplit?TakeSplitByWords(str,count,true,elipsis):(elipsis||"")+str.substr(str.length-count+(elipsis?elipsis.length:0),count)},String.prototype.Split=function(splitCharsArr,ignoreCase){var str=this+"";return str?str.split(new RegExp(fnCreateRegexStr(splitCharsArr),ignoreCase?"ig":"g")):[]},String.prototype.ReplaceAll=function(search,replacement,ignoreCase){var str=this+"",re;if(!str){return str};re=new RegExp(fnCreateRegexStr(search),ignoreCase?"ig":"g");return str.replace(re,replacement)},String.prototype.ToNumber=function(){return Calysto.Type.NumberConverter.ToDecimal(this+"")},String.prototype.ToFunc=function(noReturnCheck){return noReturnCheck?Calysto.Utility.Expressions.CompileLambdaNoReturnCheck(this+""):Calysto.Utility.Expressions.CompileLambdaExpression(this+"")},String.prototype.GetHashCode=function(){for(var ch,str=this+"",hash=0,n=0;n<(str||"").length;n++){ch=str.charCodeAt(n),hash=(hash<<5)-hash+ch};return hash&hash},String.prototype.FormatWith=function(obj,placeHolderStart="{",placeHolderEnd="}"){var str=this+"";return obj?str.replace(new RegExp("("+RegExp.Escape(placeHolderStart||"{")+"([\\w_\\-\\.]+)"+RegExp.Escape(placeHolderEnd||"}")+")","g"),function(all,g1,g2){var val=Calysto.DataBinder.GetValue(obj,g2);if(val==undefined){throw new Error("Exception in String.FormatWith(), "+g1+" property not found.");}return val}):str},String.prototype.FormatWith2=function(obj,placeHolderStart="{{",placeHolderEnd="}}"){return(this+"").FormatWith(obj,placeHolderStart,placeHolderEnd)},String.prototype.FormatWith3=function(obj,placeHolderStart="{{{",placeHolderEnd="}}}"){return(this+"").FormatWith(obj,placeHolderStart,placeHolderEnd)},String.prototype.AsEnumerable=function(){return new Calysto.CalystoEnumerable(()=>Calysto.CalystoEnumerator.From(this+""))},String.prototype.ToHtml=function(htmlEncode){return Calysto.Utility.Html.StringToHtml(this+"",htmlEncode)},String.prototype.ToNullIfEmpty=function(trim){let s1=this+"";trim&&(s1=s1.Trim());return String.IsNullOrWhiteSpace(s1)?null:s1}}(),function(Calysto){class TimeParts{constructor(ticks){this.Ticks=ticks||0,this.TotalSeconds=Math.floor(ticks/1e3),this.Hours=Math.floor(this.Ticks/36e5),this.Minutes=Math.floor(this.TotalSeconds/60)%60,this.Seconds=this.TotalSeconds%60,this.Milliseconds=Math.floor(this.Ticks)%1e3}}class TimeSpan{constructor(){this._token=new RegExp("[H]{1,2}|[h]{1,2}|[m]{1,2}|[s]{1,2}|[f]{1,3}","g"),this._ticks=0}static GetTicks(days,hours,minutes,seconds,milliseconds){return 864e5*(days||0)+36e5*(hours||0)+6e4*(minutes||0)+1e3*(seconds||0)+(milliseconds||0)}static Create(days,hours,minutes,seconds,milliseconds){var tt=new Calysto.TimeSpan;tt._ticks=Calysto.TimeSpan.GetTicks(days,hours,minutes,seconds,milliseconds);return tt}static Frommilliseconds(milliseconds){return(new Calysto.TimeSpan).AddMilliseconds(milliseconds)}static FromTicks(milliseconds){return(new Calysto.TimeSpan).AddMilliseconds(milliseconds)}static FromSeconds(seconds){return(new Calysto.TimeSpan).AddSeconds(seconds)}static FromMinutes(minutes){return(new Calysto.TimeSpan).AddMinutes(minutes)}static FromHours(hours){return(new Calysto.TimeSpan).AddHours(hours)}static FromDays(days){return(new Calysto.TimeSpan).AddDays(days)}AddTicks(ticksMs){var tt=new Calysto.TimeSpan;tt._ticks=this._ticks+ticksMs;return tt}AddDays(days){return this.AddTicks(Calysto.TimeSpan.GetTicks(days))}AddHours(hours){return this.AddTicks(Calysto.TimeSpan.GetTicks(0,hours))}AddMinutes(minutes){return this.AddTicks(Calysto.TimeSpan.GetTicks(0,0,minutes))}AddSeconds(seconds){return this.AddTicks(Calysto.TimeSpan.GetTicks(0,0,0,seconds))}AddMilliseconds(milliseconds){return this.AddTicks(milliseconds)}Totalmilliseconds(){return this._ticks}TotalSeconds(){return this._ticks/1e3}TotalMinutes(){return this._ticks/6e4}TotalHours(){return this.TotalMinutes()/60}TotalDays(){return this.TotalHours()/24}ToParts(){return new TimeParts(this._ticks)}pad(val,len=2){for(val=String(val),len=len||2;val.length<len;){val="0"+val};return val}FormatTime(ticks,format){var ms=this.pad(Math.floor(ticks)%1e3,3),totalSeconds=Math.floor(ticks/1e3),hours=Math.floor(ticks/36e5),min=Math.floor(totalSeconds/60)%60,s=totalSeconds%60,flags={H:hours,HH:this.pad(hours),m:min,mm:this.pad(min),s:s,ss:this.pad(s),f:String(ms).substr(0,1),ff:String(ms).substr(0,2),fff:String(ms).substr(0,3)};return format.replace(this._token,function($0){return $0 in flags?flags[$0]:""})}ToStringFormated(format){return this.FormatTime(this._ticks,format||"HH:mm:ss.fff")}}Calysto.TimeSpan=TimeSpan}(Calysto||(Calysto={})),function(Calysto){let DayOfWeek;(function(DayOfWeek){DayOfWeek[DayOfWeek.Sunday=0]="Sunday",DayOfWeek[DayOfWeek.Monday=1]="Monday",DayOfWeek[DayOfWeek.Tuesday=2]="Tuesday",DayOfWeek[DayOfWeek.Wednesday=3]="Wednesday",DayOfWeek[DayOfWeek.Thursday=4]="Thursday",DayOfWeek[DayOfWeek.Friday=5]="Friday",DayOfWeek[DayOfWeek.Saturday=6]="Saturday"})(DayOfWeek=Calysto.DayOfWeek||(Calysto.DayOfWeek={}));let DateFormat;(function(DateFormat){function pad(val,len){for(val=String(val),len=len||2;val.length<len;){val="0"+val};return val}function Format(date,format,utc){var tzone,mtz1;format=format||Calysto.Globalization.CultureInfo.CurrentCulture.DateTimeFormat.GeneralLongTimePattern,format.slice(0,4)=="UTC:"&&(format=format.slice(4),utc=true),mtz1=(date+"").match(_timezone),mtz1&&mtz1.length>0&&(tzone=(mtz1[0]||"").replace(_timezoneClip,""));var get=utc?"getUTC":"get",datum=date[get+"Date"](),dan=date[get+"Day"](),month=date[get+"Month"](),year=date[get+"FullYear"](),hours=date[get+"Hours"](),min=date[get+"Minutes"](),s=date[get+"Seconds"](),L=date[get+"Milliseconds"](),L=pad(Math.floor(L)%1e3,3),o=utc?0:date.getTimezoneOffset(),flags={dddd:i18n.DayNames[dan],ddd:i18n.AbbreviatedDayNames[dan],dd:pad(datum),d:datum,MMMM:i18n.MonthNames[month],MMM:i18n.AbbreviatedMonthNames[month],MM:pad(month+1),M:month+1,yy:String(year).slice(2),yyyy:year,h:hours%12||12,hh:pad(hours%12||12),H:hours,HH:pad(hours),m:min,mm:pad(min),s:s,ss:pad(s),f:String(L).substr(0,1),ff:String(L).substr(0,2),fff:L,t:hours<12?"A":"P",tt:hours<12?"AM":"PM",K:(o>0?"-":"+")+pad(Math.floor(Math.abs(o)/60))+":"+pad(Math.abs(o)%60),Z:utc?"UTC":tzone,S:["th","st","nd","rd"][datum%10>3||datum>=10&&datum<=20?0:datum%10]};return format.replace(_token,function($0){return $0 in flags?flags[$0]:$0.slice(1,$0.length-1)})}function GetInt(parseString,parseFormat,dic,possibleArr){for(var k of possibleArr){if(k in dic){return Calysto.Type.TypeInspector.IsNumber(dic[k])?dic[k]:NaN}};return 0}function TryParseExact(arg,format,refOut,throwError){var _a,args;if(Calysto.Type.TypeInspector.IsDate(arg)){refOut.SetValue(new DateTime(arg));return true}if(Calysto.Type.TypeInspector.IsDateTime(arg)){refOut.SetValue(arg);return true}let str=arg||"";if(format){var f1=format.split(new RegExp("[^\\w]+")),v1=str.split(new RegExp("[^\\d]+")),dic={};for(let n=0;n<f1.length;n++){let val=v1[n];((_a=f1[n])===null||_a===void 0?void 0:_a.StartsWith("f"))&&(val=fnPadRight(val,3)),dic[f1[n]]=parseInt(val)}if(args=[GetInt(str,format,dic,["yyyy","yy"]),GetInt(str,format,dic,["MM","M"]),GetInt(str,format,dic,["dd","d"]),GetInt(str,format,dic,["HH","H"]),GetInt(str,format,dic,["mm","m"]),GetInt(str,format,dic,["ss","s"]),GetInt(str,format,dic,["fff","ff","f"])],args.Where(o=>o==NaN).Any()){if(throwError){throw new Error("Error parsing date from: "+str+", to format: "+format);}else return false};try{refOut.SetValue(Calysto.DateTime.Create.apply(null,args));return true}catch(e){if(throwError){throw e;}}return false}let m=str.match(reg1);if(m){refOut.SetValue(Calysto.DateTime.Create(parseInt(m[1],10),parseInt(m[2],10),parseInt(m[3],10),parseInt(m[4],10),parseInt(m[5],10),parseInt(m[6],10),parseInt(fnPadRight(m[7]||"",3).substr(0,3),10)));return true}if(m=str.match(reg2),m){refOut.SetValue(Calysto.DateTime.Create(parseInt(m[3],10),parseInt(m[2],10),parseInt(m[1],10),parseInt(m[4],10),parseInt(m[5],10),parseInt(m[6],10),parseInt(fnPadRight(m[7]||"",3).substr(0,3),10)));return true}let date;if((date=new Date(Date.parse(str)))&&!isNaN(date.getFullYear())){refOut.SetValue(new Calysto.DateTime(date));return true}if(throwError){throw new Error("Can not parse DateTime from "+str);}return false}var _token=new RegExp('d{1,4}|M{1,4}|yy(?:yy)?|[H]{1,2}|[h]{1,2}|[m]{1,2}|[s]{1,2}|[f]{1,3}|[t]{1,2}|[LloKSZT]|"[^"]*"|\'[^\']*',"g"),_timezone=new RegExp("\b(?:[PMCEA][SDP]T|(?:Pacific|Mountain|Central|Eastern|Atlantic) (?:Standard|Daylight|Prevailing) Time|(?:GMT|UTC)(?:[-+]d{4})?)\b","g"),_timezoneClip=new RegExp("[^-+dA-Z]","g"),i18n;DateFormat.Format=Format;var reg1=new RegExp("([\\d]+)-([\\d]+)-([\\d]+)[T\\s]+([\\d]*)[:]*([\\d]*)[:]*([\\d]*)[\\.]*([\\d]*)([\\+ \\:\\d\\w]*)"),reg2=new RegExp("([\\d]+).([\\d]+).([\\d]+)[\\.]*[T\\s]+([\\d]*)[:]*([\\d]*)[:]*([\\d]*)[\\.]*([\\d]*)([\\+ \\:\\d\\w]*)"),fnPadRight=function(n,places){for(n+="";n.length<places;){n=n+"0"};return n};DateFormat.TryParseExact=TryParseExact,DateFormat.masks={"default":"ddd MMM dd yyyy HH:mm:ss",shortDate:"M/d/yy",mediumDate:"MMM d, yyyy",longDate:"MMMM d, yyyy",fullDate:"dddd, MMMM d, yyyy",shortTime:"h:mm tt",mediumTime:"h:mm:ss tt",longTime:"h:mm:ss tt K",isoDate:"yyyy-MM-dd",isoTime:"HH:mm:ss",isoDateTime:"yyyy-MM-dd HH:mm:ss.fff",iso3DateTime:"yyyy-MM-ddTHH:mm:ss.fff",iso6DateTime:"yyyy-MM-ddTHH:mm:ss.ffffff",isoUtcDateTime:"UTC:yyyy-MM-dd HH:mm:ss.fff"},i18n=Calysto.Globalization.CultureInfo.CurrentCulture.DateTimeFormat})(DateFormat=Calysto.DateFormat||(Calysto.DateFormat={}));class DateTimeParts{constructor(date){this.Year=date.getFullYear(),this.Month=date.getMonth()+1,this.Day=date.getDate(),this.DayOfWeek=date.getDay(),this.Hour=date.getHours(),this.Minute=date.getMinutes(),this.Second=date.getSeconds(),this.Millisecond=date.getMilliseconds(),this.Ticks=date.getTime()}}Calysto.DateTimeParts=DateTimeParts;class DateTime{constructor(date){this._typeName="DateTime",date?typeof date=="string"?this._dateItem=Date.FromLocalISOTString(date):date.constructor==DateTime?this._dateItem=date._dateItem:date.constructor==Date&&(this._dateItem=date):this._dateItem=new Date(0),Calysto.Core.IsDebugDefined&&(this._isoDateStr=Date.ToLocalISOTString(this._dateItem),this._currCultureStr=this._dateItem.ToStringFormated())}ToStringFormated(format){return DateFormat.Format(this._dateItem,format)}ToShortDateString(){return this.ToStringFormated(Calysto.Globalization.CultureInfo.CurrentCulture.DateTimeFormat.ShortDatePattern)}toString(){return this.ToStringFormated("yyyy-MM-dd HH:mm:ss.fff K")}DayOfWeek(){return this._dateItem.getDay()}DatePart(){var p=this.ToParts();return Calysto.DateTime.Create(p.Year,p.Month,p.Day)}TimePart(){var p=this.ToParts();return Calysto.TimeSpan.Create(0,p.Hour,p.Minute,p.Second,p.Millisecond)}ToParts(){return new DateTimeParts(this._dateItem)}AddHours(hours){return new Calysto.DateTime(new Date(this._dateItem.getTime()+hours*36e5))}AddMinutes(minutes){return new Calysto.DateTime(new Date(this._dateItem.getTime()+minutes*6e4))}AddSeconds(seconds){return new Calysto.DateTime(new Date(this._dateItem.getTime()+seconds*1e3))}AddMiliseconds(misliseconds){return new Calysto.DateTime(new Date(this._dateItem.getTime()+misliseconds))}AddDays(days){return new Calysto.DateTime(new Date(this._dateItem.getTime()+days*864e5))}AddMonths(months){var currMonths=this._dateItem.getFullYear()*12+this._dateItem.getMonth()+months,year=currMonths/12,month=currMonths%12,date=new Date(this._dateItem.getTime());date.setMonth(month),date.setFullYear(year);return new Calysto.DateTime(date)}AddYears(years){var year=this._dateItem.getFullYear()+years,date=new Date(this._dateItem.getTime());date.setFullYear(year);return new Calysto.DateTime(date)}ToSystemDate(){let ticks=this._dateItem?this._dateItem.getTime():0;return new Date(ticks)}ToDateTime(){return new DateTime(this._dateItem)}static Now(){return new Calysto.DateTime(new Date)}static Create(year,month,day,hours,minutes,seconds,miliseconds){if(arguments.length>2&&Calysto.Type.TypeInspector.IsNumber(year,month,day)){return new Calysto.DateTime(new Date(year||1700,(month||1)-1,day||1,hours||0,minutes||0,seconds||0,miliseconds||0))};throw new Error("Can not create DateTime");}static TryParseDateTime(str,format,refOut){return format?DateFormat.TryParseExact(str,format,refOut):DateFormat.TryParseExact(str,Calysto.Globalization.CultureInfo.CurrentCulture.DateTimeFormat.GeneralLongTimePattern,refOut)||DateFormat.TryParseExact(str,Calysto.Globalization.CultureInfo.CurrentCulture.DateTimeFormat.ShortDatePattern,refOut)?true:false}static TryParseDate(str,format,refOut){if(DateTime.TryParseDateTime(str,format,refOut)){refOut.SetValue(refOut.GetValue().DatePart());return true}return false}static ParseDateTime(str,format,throwEx){let refOut=new Calysto.BoxValue;if(DateTime.TryParseDateTime(str,format,refOut)){return refOut.GetValue()};if(throwEx){throw Error("Error in ParseDateTime, can not parse: "+str);}return undefined}static ParseDate(str,format,throwEx){let refOut=new Calysto.BoxValue;if(DateTime.TryParseDate(str,format,refOut)){return refOut.GetValue()};if(throwEx){throw Error("Error in ParseDate, can not parse: "+str);}return undefined}}Calysto.DateTime=DateTime}(Calysto||(Calysto={})),Date.prototype.ToStringFormated=function(format){return Calysto.DateFormat.Format(this,format)},Date.prototype.ToDateTime=function(){return new Calysto.DateTime(this)},Date.prototype.ToSystemDate=function(){return new Date(this)},Date.prototype.ToDateTime=function(){return new Calysto.DateTime(this)},function(Calysto){class KeyValue{constructor(key,value){this.Key=key,this.Value=value}}Calysto.KeyValue=KeyValue;class Dictionary{constructor(){this._map=new Map}AsEnumerable(){return Calysto.CalystoEnumerable.From(()=>function*(__this){for(let kv of __this._map.entries()){yield new KeyValue(kv[0],kv[1])}}(this))}GetItems(){return this.AsEnumerable().ToArray()}ToRawObject(errorOnDuplicateKey){var d={};this.GetItems().ForEach(o=>{let keyStr=o.Key+"";if(errorOnDuplicateKey&&d[keyStr]!=undefined){throw new Error("Duplicated key: "+o.Key);}d[keyStr]=o.Value});return d}Clear(){this._map.clear()}RemoveKey(key){this._map.delete(key)}GetValues(){return this.AsEnumerable().Select(o=>o.Value).ToArray()}GetKeys(){return this.AsEnumerable().Select(o=>o.Key).ToArray()}Count(){return this._map.size}ContainsKey(key){return!!this._map.has(key)}AddKeyValue(kv){return this.Add(kv.Key,kv.Value)}Add(key,value){if(this._map.has(key)){throw Error("Duplicated key: "+key);}this._map.set(key,value);return this}SetValue(key,value){this._map.set(key,value);return this}TryGetValue(key,refOut){if(this._map.has(key)){refOut.SetValue(this._map.get(key));return true}return false}GetValue(key){var refOut=new Calysto.BoxValue;if(this.TryGetValue(key,refOut)){return refOut.GetValue()};throw new Error("Key not found: "+key);}GetValueOrDefault(key,defaultValue){var refOut=new Calysto.BoxValue;return this.TryGetValue(key,refOut)?refOut.GetValue():defaultValue}}Calysto.Dictionary=Dictionary}(Calysto||(Calysto={})),function(Calysto){function FromArray(source){var index=-1;return new CalystoEnumerator(refYield=>{if(source.length>0&&++index<source.length){refYield.SetValue(source[index]);return true}return false})}function FromIterableIterator(source){let res1;return new CalystoEnumerator(refYield=>{if(res1=source.next(),res1&&!res1.done){refYield.SetValue(res1.value);return true}return false})}function FromGeneratorFunc(fn){let res1,source;return new CalystoEnumerator(refYield=>{if(source||(source=fn()),res1=source.next(),res1&&!res1.done){refYield.SetValue(res1.value);return true}return false})}function FromString(source){if(source&&Calysto.Type.TypeInspector.IsString(source)){var index=-1;return new CalystoEnumerator(refYield=>{if(source.length>0&&++index<source.length){refYield.SetValue(source.charAt(index));return true}return false})}throw new Error("CalystoEnumerator can not be created from source: "+source);}class CalystoEnumerator{constructor(fnYieldNext){this.fnYieldNext=fnYieldNext}YieldNext(refYield){if(this.fnYieldNext(refYield)){this.current=refYield.GetValue();return true}return false}GetNext(){let box=new Calysto.BoxValue;this.YieldNext(box);return box}MoveNext(){return this.YieldNext(new Calysto.BoxValue)}get Current(){return this.current}static FromYieldFunc(fnYieldNext){if(fnYieldNext&&Calysto.Type.TypeInspector.IsFunction(fnYieldNext)){return new CalystoEnumerator(fnYieldNext)};throw new Error("CalystoEnumerator can not be created from fnYieldNext: "+fnYieldNext);}static From(source){var _a,_b,_c,_d,_e,_f,_g,_h,_j,_k,_l,_m,_o,_p,_q,_r,_s;if(source){if(typeof source=="string"){return FromString(source)};if(((_b=(_a=source)===null||_a===void 0?void 0:_a.GetEnumerator)===null||_b===void 0?void 0:_b.apply)&&"GetEnumerator"in source){return source.GetEnumerator()};if(((_d=(_c=source)===null||_c===void 0?void 0:_c.YieldNext)===null||_d===void 0?void 0:_d.apply)&&((_f=(_e=source)===null||_e===void 0?void 0:_e.MoveNext)===null||_f===void 0?void 0:_f.apply)&&"Current"in source){return source};if(Calysto.Type.TypeInspector.IsArrayOrDomArray(source)){return FromArray(source)};if((_j=(_h=(_g=source)===null||_g===void 0?void 0:_g.next)===null||_h===void 0?void 0:_h.apply)===null||_j===void 0?void 0:_j.apply){return FromIterableIterator(source)};if(typeof source=="function"){if((_o=(_m=(_l=(_k=source)===null||_k===void 0?void 0:_k.prototype)===null||_l===void 0?void 0:_l.next)===null||_m===void 0?void 0:_m.apply)===null||_o===void 0?void 0:_o.apply){return FromGeneratorFunc(source)};let gen1=source();if((_q=(_p=gen1===null||gen1===void 0?void 0:gen1.next)===null||_p===void 0?void 0:_p.apply)===null||_q===void 0?void 0:_q.apply){return FromIterableIterator(gen1)};if(((_r=gen1===null||gen1===void 0?void 0:gen1.YieldNext)===null||_r===void 0?void 0:_r.apply)&&((_s=gen1===null||gen1===void 0?void 0:gen1.MoveNext)===null||_s===void 0?void 0:_s.apply)&&"Current"in gen1){return gen1}}}throw new Error("CalystoEnumerator can not be created from source: "+source);}}Calysto.CalystoEnumerator=CalystoEnumerator}(Calysto||(Calysto={})),function(Calysto){var Features;(function(Features){function IsContained(str){if(window.navigator&&navigator.mimeTypes){for(var n=0;n<navigator.mimeTypes.length;n++){if((navigator.mimeTypes[n].type+"").indexOf(str)>0){return true}}};return false}function HasFlash(){hasFlash||(hasFlash={value:IsContained("x-shockwave-flash")});return hasFlash.value}function HasSilverlight(){hasSilverlight||(hasSilverlight={value:IsContained("x-silverlight")});return hasSilverlight.value}function RemoveDots(verStr){var arr=verStr.split("."),vv=arr.shift();arr.length>0&&(vv+="."+arr.join(""));return vv||""}function DetectBrowser(){var ua=navigator.userAgent||"",vendor=navigator.vendor||"",detMatch=null,detKind=null,detIsMobile=null,detIsTablet=null,detIsCrawler=null,detHasTouch=null,verNum,verStr;(ua.Contains("Bot",true)||ua.Contains("Crawler",true))&&(detIsCrawler=true),ua.Contains("Mobile",true)&&(detIsMobile=true),detHasTouch=navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0,ua.Contains("iPad")?(detIsTablet=true,detKind=BrowserKindEnum.iPad,detMatch=ua.match("Version\\/([\\d\\.]+)")):ua.Contains("iPod")?(detIsMobile=true,detKind=BrowserKindEnum.iPod,detMatch=ua.match("Version\\/([\\d\\.]+)")):ua.Contains("iPhone")?(detIsMobile=true,detKind=BrowserKindEnum.iPhone,detMatch=ua.match("Version\\/([\\d\\.]+)")):ua.Contains("IEMobile")?(detIsMobile=true,detKind=BrowserKindEnum.IEMobile,detMatch=ua.match("IEMobile\\/([\\d\\.]+)")):ua.Contains("Nokia")?(detIsMobile=true,detKind=BrowserKindEnum.NokiaMobile,detMatch=ua.match("Version\\/([\\d\\.]+)")):ua.Contains("PlayBook")||ua.Contains("BlackBerry")||ua.Contains("BB10")?(detKind=BrowserKindEnum.BlackBerry,(detIsTablet=ua.Contains("Tablet"))||(detIsMobile=ua.Contains("Mobile"))):(detMatch=ua.match("MSIE ([\\d\\.]+)"))?detKind=BrowserKindEnum.MSIE:("msMaxTouchPoints"in navigator||"msManipulationViewsEnabled"in navigator)&&(detMatch=ua.match("rv:([\\d\\.]+)"))?detKind=BrowserKindEnum.MSIE:"msManipulationViewsEnabled"in navigator&&(detMatch=ua.match("Edge[\\/]([\\d\\.]+)"))?detKind=BrowserKindEnum.MSEdge:(detMatch=ua.match(" Edg[\\/]([\\d\\.]+)"))?detKind=BrowserKindEnum.ChromiumEdge:ua.Contains("MSIE")?detKind=BrowserKindEnum.MSIE:ua.Contains("Android")?((detMatch=ua.match("Version\\/([\\d\\.]+)"))||(detMatch=ua.match("Android ([\\d\\.]+)")),ua.Contains("Tablet")||screen.width>900&&screen.width>screen.height?(detIsTablet=true,detKind=BrowserKindEnum.AndroidTablet):(detIsMobile=true,detKind=BrowserKindEnum.AndroidMobile)):vendor.Contains("Opera")||ua.Contains("OPR/")||ua.Contains("Opera")?(detKind=BrowserKindEnum.Opera,detMatch=ua.match("(OPR|Opera)\\/([\\d\\.]+)"),detMatch&&(detMatch=[detMatch[0],detMatch[2]])):vendor.Contains("Google")?(detMatch=ua.match("(OPR|Opera)\\/([\\d\\.]+)"))?detKind=BrowserKindEnum.Opera:(detKind=BrowserKindEnum.Chrome,detMatch=ua.match("Chrome\\/([\\d\\.]+)")):vendor.Contains("Apple")?(detKind=BrowserKindEnum.Safari,detMatch=ua.match("Version\\/([\\d\\.]+)")):(detMatch=ua.match("Firefox\\/([\\d\\.]+)"))?detKind=BrowserKindEnum.Firefox:ua.Contains("Firefox")?detKind=BrowserKindEnum.Firefox:ua.Contains("Mobile")?(detIsMobile=true,detKind=BrowserKindEnum.MobilePhone):ua.Contains("Chrome")?detKind=BrowserKindEnum.Chrome:ua.Contains("Safari")&&(detKind=BrowserKindEnum.Safari),verNum=null,verStr=detMatch?detMatch[1]:"",verStr&&(verNum=parseFloat(RemoveDots(verStr))),detIsMobile&&detIsTablet&&(detIsMobile=false);return{Found:!!(detKind&&detKind>0),KindName:BrowserKindEnum[detKind||0],Kind:detKind||0,Version:verNum||0,VersionString:verStr,IsCrawler:!!detIsCrawler,IsMobile:!!detIsMobile,IsTablet:!!detIsTablet,IsDesktop:!detIsMobile&&!detIsTablet,HasTouch:!!detHasTouch}}function GetBrowser(){return detectedBrowser||(detectedBrowser=DetectBrowser())}function GetWindowsVersionName(ntversion){switch(ntversion){case 10:return"Windows 10";case 6.3:return"Windows 8.1";case 6.2:return"Windows 8";case 6.1:return"Windows 7";case 6:return"Windows Vista";case 5.2:return"Windows XP Professional x64";case 5.1:return"Windows XP";case 4.9:return"Windows ME";case 5:return"Windows 2000";case 4.1:return"Windows 98";case 4:return"Windows NT 4.0";default:return null}}function GetIphoneVersion(version){switch(version){case 4.21:return"iPhone 4";case 7:return"iPhone 5";case 8:return"iPhone 6";default:return null}}function DetectOS(){var ua=navigator.userAgent||"",detMatch=null,detKind=null;ua.Contains("Windows Phone")?(detKind=OSKindEnum.WindowsPhone,detMatch=ua.match(new RegExp("Windows Phone( OS | )([\\d\\.]+)")),detMatch&&(detMatch=[detMatch[0],detMatch[2]])):ua.Contains("Windows")?(detKind=OSKindEnum.Windows,detMatch=ua.match(new RegExp("Windows NT ([\\d\\.]+)"))):ua.Contains("Mac")?(detKind=OSKindEnum.Macintosh,detMatch=ua.match(new RegExp("(OS |OS X )([\\d_]+)")),detMatch&&detMatch[2]&&(detMatch=[detMatch[0],detMatch[2].replace(new RegExp("_","g"),".")])):ua.Contains("Android")?(detKind=OSKindEnum.Android,detMatch=ua.match(new RegExp("Android ([\\d\\.]+)"))):ua.Contains("Linux")&&(detKind=OSKindEnum.Linux);var verNum=null,verStr=detMatch?detMatch[1]:"",winVersion=null,iPhoneVersion=null;verStr&&(verNum=parseFloat(RemoveDots(verStr)),detKind==OSKindEnum.Windows?winVersion=GetWindowsVersionName(verNum):detKind==OSKindEnum.Macintosh&&(iPhoneVersion=GetIphoneVersion(verNum)));return{Found:!!(detKind&&detKind>0),KindName:Calysto.Enum.GetName(OSKindEnum,detKind||0),Kind:detKind||0,Version:verNum||0,VersionString:verStr,WinName:winVersion,iPhoneVersion:iPhoneVersion,IsWindows:detKind==OSKindEnum.Windows,IsAndroid:detKind==OSKindEnum.Android,IsLinux:detKind==OSKindEnum.Linux,IsMacintosh:detKind==OSKindEnum.Macintosh}}function GetOS(){return detectedOS||(detectedOS=DetectOS())}var hasFlash,hasSilverlight,detectedBrowser,detectedOS;let BrowserKindEnum;(function(BrowserKindEnum){BrowserKindEnum[BrowserKindEnum.Unknown=0]="Unknown",BrowserKindEnum[BrowserKindEnum.Firefox=1]="Firefox",BrowserKindEnum[BrowserKindEnum.Chrome=2]="Chrome",BrowserKindEnum[BrowserKindEnum.Safari=3]="Safari",BrowserKindEnum[BrowserKindEnum.Opera=4]="Opera",BrowserKindEnum[BrowserKindEnum.MSIE=5]="MSIE",BrowserKindEnum[BrowserKindEnum.Bot=6]="Bot",BrowserKindEnum[BrowserKindEnum.MobileBot=7]="MobileBot",BrowserKindEnum[BrowserKindEnum.iPhone=8]="iPhone",BrowserKindEnum[BrowserKindEnum.AndroidMobile=9]="AndroidMobile",BrowserKindEnum[BrowserKindEnum.NokiaMobile=10]="NokiaMobile",BrowserKindEnum[BrowserKindEnum.WapPhone=11]="WapPhone",BrowserKindEnum[BrowserKindEnum.MobilePhone=12]="MobilePhone",BrowserKindEnum[BrowserKindEnum.IEMobile=13]="IEMobile",BrowserKindEnum[BrowserKindEnum.iPad=14]="iPad",BrowserKindEnum[BrowserKindEnum.AndroidTablet=15]="AndroidTablet",BrowserKindEnum[BrowserKindEnum.iPod=16]="iPod",BrowserKindEnum[BrowserKindEnum.BlackBerry=17]="BlackBerry",BrowserKindEnum[BrowserKindEnum.MSEdge=18]="MSEdge",BrowserKindEnum[BrowserKindEnum.ChromiumEdge=19]="ChromiumEdge"})(BrowserKindEnum=Features.BrowserKindEnum||(Features.BrowserKindEnum={}));let OSKindEnum;(function(OSKindEnum){OSKindEnum[OSKindEnum.Unknown=0]="Unknown",OSKindEnum[OSKindEnum.Windows=1]="Windows",OSKindEnum[OSKindEnum.Macintosh=2]="Macintosh",OSKindEnum[OSKindEnum.Android=3]="Android",OSKindEnum[OSKindEnum.Linux=4]="Linux",OSKindEnum[OSKindEnum.WindowsPhone=5]="WindowsPhone"})(OSKindEnum=Features.OSKindEnum||(Features.OSKindEnum={})),Features.HasFlash=HasFlash,Features.HasSilverlight=HasSilverlight,Features.GetBrowser=GetBrowser,Features.GetOS=GetOS})(Features=Calysto.Features||(Calysto.Features={}))}(Calysto||(Calysto={})),function(Calysto){var CookieUtility;(function(CookieUtility){function SetCookieValue(cookieName,cookieValue,expiresAfterSECONDS,domain,path,secure){if(!cookieName){throw Error("cookieName is required");}var expires=expiresAfterSECONDS?new Date(Math.round(Date.now()+1e3*expiresAfterSECONDS)):null,cc=encodeURIComponent(cookieName+"")+"="+encodeURIComponent(cookieValue+"")+(expires?"; expires="+expires.toUTCString():"")+(domain?"; domain="+domain:"")+("; path="+(path?path:"/"))+(secure?"; secure":"");document.cookie=cc}function GetCookieValue(cookieName){var cookieValue="",posName=document.cookie.indexOf(encodeURIComponent(cookieName)+"="),posValue,endPos;cookieName&&posName>=0&&(posValue=posName+(encodeURIComponent(cookieName)+"=").length,endPos=document.cookie.indexOf(";",posValue),cookieValue=endPos>=0?decodeURIComponent(document.cookie.substring(posValue,endPos)):decodeURIComponent(document.cookie.substring(posValue)));return cookieValue||""}function GetCookies(){for(var nv,a,arr=document.cookie.split(";"),col=[],n=0;n<arr.length;n++){nv=arr[n].replace(new RegExp("(^[\\s]+)|([\\s]$)","ig"),""),nv&&(a=nv.split("="),col.push({Name:decodeURIComponent(a[0]),Value:decodeURIComponent(a[1])}))};return col}function DeleteCookie(cookieName,domain){return SetCookieValue(cookieName,"",Date.now()/-1e3,domain)}CookieUtility.SetCookieValue=SetCookieValue,CookieUtility.GetCookieValue=GetCookieValue,CookieUtility.GetCookies=GetCookies,CookieUtility.DeleteCookie=DeleteCookie})(CookieUtility=Calysto.CookieUtility||(Calysto.CookieUtility={}))}(Calysto||(Calysto={})),function(Calysto){var Event;(function(Event){function IsSupported(eventType){var el,isSupported;eventType.indexOf("on")==0&&(eventType=eventType.substr(2));switch(eventType){case"hover":eventType="mouseover";break;case"hout":eventType="mouseout";break;case"enterKey":case"escKey":return true}el=document.createElement(TAGNAMES[eventType]||"div"),eventType="on"+eventType,isSupported=eventType in el,isSupported||(el.setAttribute(eventType,"return;"),isSupported=typeof el[eventType]=="function"),el=null;return isSupported}function fnEventDefinition(element,eventFullName,callbackMethod,useCapture){eventFullName=eventFullName||"",eventFullName.indexOf("on")==0&&(eventFullName=eventFullName.substr(2));var arr=eventFullName.split(".");return{element:element,eventFullName:eventFullName,type:arr.shift(),namespaces:arr,callbackFunc:callbackMethod,removeEvent:()=>{},useCapture:!!useCapture,passive:false}}function Attach(element,eventFullName,callbackMethod,useCapture){var obj1=fnEventDefinition(element,eventFullName,callbackMethod,useCapture);if(!obj1.element){throw new Error("element is required");}if(!obj1.type){throw new Error("eventFullName is required");}if(!obj1.callbackFunc){throw new Error("callbackMethod is required");}if(obj1.element.$$calysto_EventsArr||(obj1.element.$$calysto_EventsArr=[]),obj1.element.$$calysto_EventsArr.push(obj1),obj1.removeEvent=()=>{obj1.element.$$calysto_EventsArr.Remove(obj1),obj1.element.$$calysto_EventsArr.Any()||delete obj1.element.$$calysto_EventsArr,fnDetachNativeEvent(obj1)},obj1.element.addEventListener){obj1.element.addEventListener(obj1.type,obj1.callbackFunc,obj1.useCapture)}else if(obj1.element.attachEvent){obj1.element.attachEvent("on"+obj1.type,obj1.callbackFunc,obj1.useCapture)}else throw new Error("Attaching event is not supported");return obj1}function fnGetListeners(element,eventFullName,callbackMethod,useCapture){if(!eventFullName){return element.$$calysto_EventsArr};var conditionObj1=fnEventDefinition(element,eventFullName,callbackMethod,useCapture);return conditionObj1.element.$$calysto_EventsArr?conditionObj1.element.$$calysto_EventsArr.Where(o=>(!conditionObj1.type||conditionObj1.type==o.type)&&(!conditionObj1.callbackFunc||conditionObj1.callbackFunc==o.callbackFunc)&&(conditionObj1.namespaces.length==0||conditionObj1.namespaces.AsEnumerable().All(function(ns1){return o.namespaces.Contains(ns1)}))):[]}function Detach(element,eventFullName,callbackMethod,useCapture){var listeners=fnGetListeners(element,eventFullName,callbackMethod,useCapture),obj1;listeners&&listeners.ForEach(o=>o.removeEvent()),obj1=fnEventDefinition(element,eventFullName,callbackMethod,useCapture),fnDetachNativeEvent(obj1)}function fnDetachNativeEvent(obj1){if(obj1.element.removeEventListener){obj1.element.removeEventListener(obj1.type,obj1.callbackFunc,obj1.useCapture)}else if(obj1.element.detachEvent){obj1.element.detachEvent("on"+obj1.type,obj1.callbackFunc,obj1.useCapture)}else throw new Error("Dettaching event is not supported");}function GetTarget(event){return event.target||event.srcElement}function StopPropagation(event,doStop){!doStop||(event.preventDefault&&event.preventDefault(),event.stopPropagation&&event.stopPropagation()),event.returnValue=!doStop,event.cancelBubble=!!doStop}function GetOffsetToTarget(event){return{offsetX:"offsetX"in event?event.offsetX:"layerX"in event?event.layerX:NaN,offsetY:"offsetY"in event?event.offsetY:"layerY"in event?event.layerY:NaN}}function IsLeftMouseButton(event){if(!window.attachEvent){if(!!window.addEventListener){return event.button===0}}else return event.button===0||event.button===1;return false}function IsRightMouseButton(event){return event.button===2}function IsMiddleMouseButton(event){if(!window.attachEvent){if(!!window.addEventListener){return event.button===1}}else return event.button===4;return false}function IsAnyMouseButton(event){return event&&(event.button===0||event.button>0)}function IsEnterKey(event){return event&&(event.keyCode==10||event.keyCode==13)}function IsCtrlKey(event){return event&&event.ctrlKey?true:false}function IsShiftKey(event){return event&&event.shiftKey?true:false}function IsEscKey(event){return event&&event.keyCode==27}function IsHoverChanged(element,ev,isHover){ev=ev||window.event;var relTarget=(isHover?ev.fromElement:ev.toElement)||ev.relatedTarget;return element!=relTarget&&!Calysto.Utility.Dom.IsDescendant(relTarget,element)?true:false}function DispatchEvent(el,ev){var evType,ev1,ev2,ev3;if(typeof ev=="string"){if(evType=ev,evType.indexOf("on")==0&&(evType=evType.substr(2)),el.dispatchEvent){if(evType.Contains("mouse")||evType.Contains("click")){ev1=document.createEvent("MouseEvent"),ev1.initEvent(evType,false,true),el.dispatchEvent(ev1);return}if(evType.Contains("key")){ev2=document.createEvent("KeyboardEvent"),ev2.initEvent(evType,false,true),el.dispatchEvent(ev2);return}ev3=document.createEvent("Event"),ev3.initEvent(evType,false,true),el.dispatchEvent(ev3);return}if(el.fireEvent){el.fireEvent("on"+evType);return}}else{if(el.dispatchEvent){el.dispatchEvent(ev);return}if(el.fireEvent){el.fireEvent("on"+ev.type);return}}throw new Error("Not supported dispatchEvent: "+ev);}var TAGNAMES={select:"input",change:"input",submit:"form",reset:"form",error:"img",load:"img",abort:"img"};Event.IsSupported=IsSupported,Event.Attach=Attach,Event.Detach=Detach,Event.GetTarget=GetTarget,Event.StopPropagation=StopPropagation,Event.GetOffsetToTarget=GetOffsetToTarget,Event.IsLeftMouseButton=IsLeftMouseButton,Event.IsRightMouseButton=IsRightMouseButton,Event.IsMiddleMouseButton=IsMiddleMouseButton,Event.IsAnyMouseButton=IsAnyMouseButton,Event.IsEnterKey=IsEnterKey,Event.IsCtrlKey=IsCtrlKey,Event.IsShiftKey=IsShiftKey,Event.IsEscKey=IsEscKey,Event.IsHoverChanged=IsHoverChanged,Event.DispatchEvent=DispatchEvent})(Event=Calysto.Event||(Calysto.Event={}))}(Calysto||(Calysto={})),function(Calysto){var Utility;(function(Utility){var Html;(function(Html){function RemoveHtmlTags(html,replacement=""){for(var re=new RegExp("\\<[^\\>]+\\>");html.match(re)!=null;){html=html.replace(re,replacement||"")};return html}function ExtractAspNameOrId(aspNetIdOrName){if(aspNetIdOrName){let n2=aspNetIdOrName.lastIndexOf("_");if(n2>0){return aspNetIdOrName.substr(n2+1)};let n1=aspNetIdOrName.lastIndexOf("$");return n1>0?aspNetIdOrName.substr(n1+1):aspNetIdOrName}return undefined}function UrlEncode(str){return encodeURIComponent(Calysto.Utility.Encoding.Utf8CharsEncoder.EncodeUTF8(str))}function UrlDecode(str){return Calysto.Utility.Encoding.Utf8CharsEncoder.DecodeUTF8(decodeURIComponent(str))}function HtmlEncodeSimple(html){return html.replace(new RegExp("<","g"),"&lt;").replace(new RegExp(">","g"),"&gt;")}function HtmlDecodeSimple(html){return html.replace(new RegExp("&lt;","g"),"<").replace(new RegExp("&gt;","g"),">")}function HtmlEncode(html){if(!html){return""};if(!mapReStr){let arr1=[];for(let prop in map){arr1.push("("+RegExp.Escape(prop)+")")};mapReStr=arr1.join("|")}return html.replace(new RegExp(mapReStr,"g"),a=>map[a])}function HtmlDecode(html){if(!html){return""};if(!reversedMap){reversedMap={};let arr1=[];for(let prop in map){reversedMap[map[prop]]=prop,arr1.push("("+RegExp.Escape(map[prop])+")")};reversedReStr=arr1.join("|")}return html.replace(new RegExp(reversedReStr,"g"),a=>reversedMap[a])}function StringToHtml(str,htmlEncode){if(String.IsNullOrEmpty(str)){return str};str=str.ReplaceAll("\r\n","\n").ReplaceAll("\r","");return htmlEncode?str.Split("\n").Select(row=>HtmlEncode(row)).ToStringJoined("<br/>"):str.ReplaceAll("\n","<br/>")}function JavaScriptStringEncode(str){return str.replace(new RegExp('([\\\\\x00-\x1f\\"])',"g"),(a,b)=>{var c=escapeeChars[b];if(c){return c};c=b.charCodeAt();return"\\u00"+Math.floor(c/16).toString(16)+(c%16).toString(16)})}function Minify(jscode,kind="Full"){if(jscode=new Calysto.Regex(Calysto.Regex.Escape("/*")+"[\\w\\W]*?"+Calysto.Regex.Escape("*/")).Replace(jscode," "),kind=="Full"){jscode=new Calysto.Regex("[\\s]+").Replace(jscode," "),jscode=new Calysto.Regex(`[ ]*([\;\{\}\,]+)[ ]*`).Replace(jscode,"$1");let re2=new RegExp(`\{[^\}]+\}`,"ig"),re3=new RegExp(`[ ]*([\:])[ ]*`,"ig");jscode=jscode.replace(re2,substr=>substr.replace(re3,":"));return jscode.TrimStart()}return jscode}Html.RemoveHtmlTags=RemoveHtmlTags,Html.ExtractAspNameOrId=ExtractAspNameOrId,Html.UrlEncode=UrlEncode,Html.UrlDecode=UrlDecode,Html.HtmlEncodeSimple=HtmlEncodeSimple,Html.HtmlDecodeSimple=HtmlDecodeSimple;let map={"&":"&amp;","'":"&#39;",'"':"&quot;","<":"&lt;",">":"&gt;","\r":"&#13","\n":"&#10"},mapReStr,reversedMap,reversedReStr;Html.HtmlEncode=HtmlEncode,Html.HtmlDecode=HtmlDecode,Html.StringToHtml=StringToHtml;const escapeeChars={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"};Html.JavaScriptStringEncode=JavaScriptStringEncode,Html.Minify=Minify})(Html=Utility.Html||(Utility.Html={}))})(Utility=Calysto.Utility||(Calysto.Utility={}))}(Calysto||(Calysto={})),function(Calysto){var Utility;(function(Utility){var Encoding;(function(Encoding){var _a,_b;let Base64CharsTable=Calysto.Constants.BaseXCharsTable,Utf8CharsEncoder;(function(Utf8CharsEncoder){function EncodeUTF8(str){var utftext,n,c;for(str=str.replace(new RegExp("\r\n","g"),"\n"),utftext="",n=0;n<str.length;n++){c=str.charCodeAt(n),c<128?utftext+=String.fromCharCode(c):c>127&&c<2048?(utftext+=String.fromCharCode(c>>6|192),utftext+=String.fromCharCode(c&63|128)):(utftext+=String.fromCharCode(c>>12|224),utftext+=String.fromCharCode(c>>6&63|128),utftext+=String.fromCharCode(c&63|128))};return utftext}function DecodeUTF8(utftext){for(var string="",i=0,c=0,c2=0,c3=0;i<utftext.length;){c=utftext.charCodeAt(i),c<128?(string+=String.fromCharCode(c),i++):c>191&&c<224?(c2=utftext.charCodeAt(i+1),string+=String.fromCharCode((c&31)<<6|c2&63),i+=2):(c2=utftext.charCodeAt(i+1),c3=utftext.charCodeAt(i+2),string+=String.fromCharCode((c&15)<<12|(c2&63)<<6|c3&63),i+=3)};return string}Utf8CharsEncoder.EncodeUTF8=EncodeUTF8,Utf8CharsEncoder.DecodeUTF8=DecodeUTF8})(Utf8CharsEncoder=Encoding.Utf8CharsEncoder||(Encoding.Utf8CharsEncoder={}));let UTF8;(function(UTF8){function GetBytes(str){for(var input=Utf8CharsEncoder.EncodeUTF8(str),arr=[],n=0;n<input.length;n++){arr.push(input.charCodeAt(n))};return arr}function GetString(arr){for(var chars=[],n=0;n<arr.length;n++){chars.push(String.fromCharCode(arr[n]))};return Utf8CharsEncoder.DecodeUTF8(chars.join(""))}UTF8.GetBytes=GetBytes,UTF8.GetString=GetString})(UTF8=Encoding.UTF8||(Encoding.UTF8={}));class CalystoBaseConverter{constructor(charsTable=Base64CharsTable.JavaScriptRFCTable64){this.charsTable=charsTable}ConvertBytes(bytes,fromBits,toBits){for(var bb,result=[],buffer=0,buffLen=0,mask=Math.pow(2,toBits)-1,doShift=false,n=0;n<bytes.length;n++){for(bb=bytes[n],doShift?buffer=buffer<<fromBits:doShift=true,buffer=buffer|bb,buffLen+=fromBits;buffLen>=toBits;){result.push(buffer>>buffLen-toBits&mask),buffLen-=toBits}};while(buffLen>=toBits){result.push(buffer>>buffLen-toBits&mask),buffLen-=toBits};while(buffLen>0&&fromBits>toBits){result.push(buffer<<toBits-buffLen&mask),buffLen-=toBits};return result}Convert(bytes,fromBits,toBits){var convertedEnumerable,pad,alignmentCharIndex,take;if(!fromBits||fromBits!=8&&(fromBits<1||fromBits>6)){throw Error(fromBits+" is invalid value. fromBits can be in range [1-6] or 8");}if(!toBits||toBits!=8&&(toBits<1||toBits>6)){throw Error(toBits+" is invalid value. toBits can be in range [1-6] or 8");}if(convertedEnumerable=this.ConvertBytes(bytes,fromBits,toBits),this.charsTable!=Base64CharsTable.StandardBase64RFC){return convertedEnumerable};if(fromBits==8&&toBits==6){if(bytes.length%3>0){for(pad=3-bytes.length%3,alignmentCharIndex=this.charsTable.length-1;pad>0;){pad--,convertedEnumerable.push(alignmentCharIndex)}}}else if(fromBits==6&&toBits==8){for(var alignmentCharIndex=this.charsTable.length-1,cnt=0,len=bytes.length;cnt<len&&bytes[len-1-cnt]==alignmentCharIndex;){cnt++};take=convertedEnumerable.length-cnt,convertedEnumerable=convertedEnumerable.slice(0,take)}return convertedEnumerable}EncodeToBaseString(data,toBits){var arr,sb,n;for(typeof data=="string"&&(data=UTF8.GetBytes(data)),arr=this.Convert(data,8,toBits),sb=[],n=0;n<arr.length;n++){sb.push(this.charsTable.charAt(arr[n]))};return sb.join("")}DecodeBaseStringToArray(baseString,fromBits){for(var arr=[],n=0;n<baseString.length;n++){arr.push(this.charsTable.indexOf(baseString.charAt(n)))};return this.Convert(arr,fromBits,8)}DecodeBaseStringToString(baseString,fromBits){return UTF8.GetString(this.DecodeBaseStringToArray(baseString,fromBits))}}Encoding.CalystoBaseConverter=CalystoBaseConverter;class CalystoHexConverter{constructor(){this.converter=new CalystoBaseConverter}EncodeToHexString(data){return this.converter.EncodeToBaseString(data,4)}DecodeHexStringToArray(hexString){return this.converter.DecodeBaseStringToArray(hexString,4)}DecodeHexStringToString(hexString){return this.converter.DecodeBaseStringToString(hexString,4)}}Encoding.HEX=new CalystoHexConverter;class CalystoBase64EncoderImpl{constructor(charsTable){this.converter=new CalystoBaseConverter(charsTable)}EncodeToBase64String(data){return this.converter.EncodeToBaseString(data,6)}DecodeBase64StringToArray(base64str){return this.converter.DecodeBaseStringToArray(base64str,6)}DecodeBase64StringToString(base64str){return this.converter.DecodeBaseStringToString(base64str,6)}}Encoding.RfcBase64=new CalystoBase64EncoderImpl(Base64CharsTable.StandardBase64RFC),Encoding.CalystoBase64=new CalystoBase64EncoderImpl(Base64CharsTable.JavaScriptRFCTable64),Encoding.Base64RndEncoder=new CalystoBase64EncoderImpl(((_b=(_a=Calysto.Core)===null||_a===void 0?void 0:_a.Constants)===null||_b===void 0?void 0:_b.RandomRFCTable64)||Base64CharsTable.RandomRFCTable64)})(Encoding=Utility.Encoding||(Utility.Encoding={}))})(Utility=Calysto.Utility||(Calysto.Utility={}))}(Calysto||(Calysto={})),function(Calysto){var Utility;(function(Utility){var Dom;(function(Dom){function TrimSpaces(str){return str?(str||"").replace(new RegExp("(^[\\s]+)|([\\s]+$)","ig"),""):str}function EnsureElementId(el){return typeof el=="string"?el:el.id?el.id:el.id=Calysto.Utility.Generators.GenerateLabel(20)}function IsElementVisible(element){var el=element;return!!(el&&el.parentNode&&el.offsetWidth>0&&el.offsetHeight>0&&el.style&&el.style.display!="none")}function IsElementInDom(element){for(var tmp=element;tmp&&tmp!=document&&(tmp=tmp.offsetParent||tmp.parentNode););return tmp==document}function IsDescendant(element,parent){var el=element;if(!el||!parent||el==parent){return false};while(el&&el!=parent){try{el=el.parentNode}catch(e){return false}}return el==parent}function GetInnerText(element){var el=element,val;if(!el){return""};val="innerText"in el?el.innerText:"innerHTML"in el?Calysto.Utility.Html.RemoveHtmlTags(el.innerHTML,""):"nodeValue"in el?el.nodeValue:el.value||"";return val+""}function HasTagName(obj,tagName){return obj&&obj.tagName&&obj.tagName.toLowerCase()==tagName.toLowerCase()?true:false}function GetViewportDiv(){if(!_fixedDiv){var tmp=document.createElement("div");tmp.innerHTML="<div id='calystoViewportSizeDiv' style='position:fixed;top:0;left:0;bottom:0;right:0;z-index:-10000000;'><\/div>",_fixedDiv=tmp.childNodes[0],(document.body||document.documentElement).appendChild(_fixedDiv)}return _fixedDiv}function GetElementScreenPosition(element){var tmpEl=element,el,result;if(tmpEl.getBoundingClientRect){return tmpEl.getBoundingClientRect()};el=element,result={left:0,top:0,bottom:0,right:0,width:tmpEl.offsetWidth,height:tmpEl.offsetHeight};do if(result.left+=(tmpEl.offsetLeft||0)-(tmpEl.scrollLeft||0),result.top+=(tmpEl.offsetTop||0)-(tmpEl.scrollTop||0),tmpEl.style&&(tmpEl.style.position=="fixed"||GetComputedStyleDeclaration(tmpEl).position=="fixed")){break}else tmpEl=tmpEl.offsetParent||tmpEl.parentNode;while(tmpEl);return result}function GetElementPagePosition(element){var pos=GetElementScreenPosition(element),page=GetPageDimensions();return{left:pos.left+page.scrollLeft,top:pos.top+page.scrollTop,width:pos.width,height:pos.height}}function GetScrollableAncestors(el){let arr=[],tmp1=el,stop=0,sleft=0;while(tmp1=tmp1.parentNode){if(stop=tmp1.scrollTop,sleft=tmp1.scrollTop,tmp1.scrollTop>0||tmp1.scrollTop>0){arr.push(tmp1);continue}if(++tmp1.scrollTop,tmp1.scrollTop==stop+1){--tmp1.scrollTop,arr.push(tmp1);continue}if(--tmp1.scrollTop,tmp1.scrollTop==stop-1){++tmp1.scrollTop,arr.push(tmp1);continue}if(++tmp1.scrollLeft,tmp1.scrollLeft==sleft+1){--tmp1.scrollLeft,arr.push(tmp1);continue}if(--tmp1.scrollLeft,tmp1.scrollLeft==sleft-1){++tmp1.scrollLeft,arr.push(tmp1);continue}}return arr}function GetPageDimensions(){return{scrollLeft:Math.max(document.body.scrollLeft,document.documentElement.scrollLeft,window.pageXOffset||0),scrollTop:Math.max(document.body.scrollTop,document.documentElement.scrollTop,window.pageYOffset||0),scrollWidth:Math.max(document.body.scrollWidth,document.documentElement.scrollWidth),scrollHeight:Math.max(document.body.scrollHeight,document.documentElement.scrollHeight),clientWidth:GetViewportDiv().offsetWidth,clientHeight:GetViewportDiv().offsetHeight}}function IsElementInViewport(el,onlyPart){var pos=GetElementScreenPosition(el),viewport=GetElementScreenPosition(GetViewportDiv()),top=pos.top>=viewport.top&&pos.top<=viewport.top+viewport.height,bottom=pos.top+pos.height>=viewport.top&&pos.top+pos.height<=viewport.top+viewport.height,left=pos.left>=viewport.left&&pos.left<=viewport.left+viewport.width,right=pos.left+pos.width>=viewport.left&&pos.left+pos.width<=viewport.left+viewport.width,w,h;if(onlyPart){w=pos.width<=viewport.width?left||right:left&&!right||!left&&right||!left&&!right&&pos.left<viewport.left&&pos.left+pos.width>viewport.left,h=pos.height<=viewport.height?top||bottom:top&&!bottom||!top&&bottom||!top&&!bottom&&pos.top<viewport.top&&pos.top+pos.height>viewport.top;return w&&h}return top&&bottom&&left&&right}function GetElementToViewportPosition(el){var pos=GetElementScreenPosition(el),viewport=GetElementScreenPosition(GetViewportDiv());return{left:pos.left-viewport.left,top:pos.top-viewport.top,bottom:viewport.top+viewport.height-(pos.top+pos.height),right:viewport.left+viewport.width-(pos.left+pos.width)}}function ParseClip(el,clipStyleString){var m=clipStyleString.match(new RegExp("(rect|margins)[\\(][\\s]*([\\d\\+\\-px\\%]+)[\\s]+([\\d\\+\\-px\\%]+)[\\s]+([\\d\\+\\-px\\%]+)[\\s]+([\\d\\+\\-px\\%]+)[\\s]*[\\)]"));m=m||[];return{match:m,useMargins:m&&m[1]=="margins",top:parseFloat(m[2])||0,right:m[3]?parseFloat(m[3]):el.offsetWidth,bottom:m[4]?parseFloat(m[4]):el.offsetHeight,left:parseFloat(m[5])||0}}function GetClip(el){return ParseClip(el,GetComputedStyle(el,"clip").StyleValue)}function CalculateClip(el,newDim){var curr=GetClip(el),deltaDim,mm;typeof newDim=="string"?(mm=newDim.match(new RegExp("[\\d\\+\\-px\\%]+","g")),mm=mm||[],deltaDim={top:mm[0],right:mm[1],bottom:mm[2],left:mm[3],useMargins:newDim.indexOf("margins")>=0}):deltaDim=newDim;return deltaDim.useMargins?{top:CalculateNumericValue(curr.top,deltaDim.top),right:el.offsetWidth-CalculateNumericValue(curr.right,deltaDim.right),bottom:el.offsetHeight-CalculateNumericValue(curr.bottom,deltaDim.bottom),left:CalculateNumericValue(curr.left,deltaDim.left)}:{top:CalculateNumericValue(curr.top,deltaDim.top),right:CalculateNumericValue(curr.left,deltaDim.right),bottom:CalculateNumericValue(curr.top,deltaDim.bottom),left:CalculateNumericValue(curr.left,deltaDim.left)}}function SetClip(){throw new Error("Not implemeted: SetClip()");}function HasClass(obj,cls){return!!(obj&&obj.className&&cls&&(" "+obj.className+" ").indexOf(" "+cls+" ")>=0)}function AddClass(obj,cls){cls&&obj&&(RemoveClass(obj,cls),obj.className=TrimSpaces(obj.className+" "+cls))}function RemoveClass(obj,cls){var arr,n;if(cls&&obj){for(arr=cls.split(" "),n=0;n<arr.length;n++){(cls=arr[n])&&(obj.className=TrimSpaces((" "+obj.className+" ").replace(new RegExp(" "+cls+" ","g")," ")))}}}function SetClass(obj,cls){obj&&(obj.className=TrimSpaces(cls)||"")}function ToggleClass(obj,cls){obj&&"className"in obj&&cls&&(HasClass(obj,cls)?RemoveClass(obj,cls):AddClass(obj,cls))}function ConvertCssNameToCamel(name){for(var re=new RegExp("(([\\w]*)-([a-z]))|([^\\-]+)","g"),exarr,ss="";(exarr=re.exec(name))!=null;){ss+=(exarr[2]||"")+(exarr[3]||"").toUpperCase()+(exarr[4]||"")};return ss}function ConvertCssNameFromCamel(name){for(var re=new RegExp("(([a-z]*)([A-Z]))|([\\w\\-]+)","g"),exarr,ss="";(exarr=re.exec(name))!=null;){ss+=(exarr[2]||"")+((exarr[3]||"")!=""?"-"+(exarr[3]||"").toLowerCase():"")+(exarr[4]||"")};return ss}function SetOpacity(element,value){if(element&&element.style){let numValue=typeof value=="string"?parseFloat(value):value;numValue<0?numValue=0:numValue>1&&(numValue=numValue/100),numValue>1&&(numValue=1),"opacity"in element.style&&(element.style.opacity=numValue+""),"filter"in element.style&&(element.style.filter="alpha(opacity="+numValue*100+")")}}function GetOpacity(element){var op=NaN,match;element&&element.style&&("opacity"in element.style?op=parseFloat(element.style.opacity)*100:"filter"in element.style&&(match=element.style.filter.match(new RegExp("opacity[\\s\\=]+([\\d]+)")),match&&(op=parseFloat(match[1]))));return typeof op=="number"&&op>=0&&op<100?op:100}function GetZIndex(element){let refArr=[];return element&&element.style&&TryExtractStyleNumericValue(element.style.zIndex,refArr)?refArr[0]:NaN}function GetZIndexNested(element){let tmp1=element,zIndex=NaN;while(tmp1&&tmp1.ownerDocument&&!Calysto.Type.TypeInspector.IsNumber(zIndex=GetZIndex(tmp1))){tmp1=tmp1.parentNode};return zIndex}function ExtractUnits(value,name){if(name=="opacity"||name=="zoom"||name=="zIndex"){return""};var match;return value&&typeof value=="string"&&(match=value.match(new RegExp("(px|%)$","ig")))&&match&&match[1]?match[1]:typeof name=="string"&&rePxNumericProperties.test(name)?"px":""}function TryExtractStyleNumericValue(value,refArr){var num,match;if(value&&typeof value=="string"?(match=value.match(new RegExp("^[\\*\\-\\+\\=]*?([\\-]{0,1}[\\d\\.]+)(px|%)?$")),match&&(num=parseFloat(match[1]))):num=value,Calysto.Type.TypeInspector.IsNumber(num)){refArr.push(num);return true}return false}function ExtractNumericValue(value,defaultValue){var refArr=[];if(TryExtractStyleNumericValue(value,refArr)){return refArr.pop()};if(Calysto.Type.TypeInspector.IsNumber(defaultValue)){return defaultValue};throw new Error("Can not extract number from: "+value);}function IsIncrementValue(value){return!!value&&typeof value=="string"&&value.indexOf("=")==1}function IsPercent(value){return!!value&&typeof value=="string"&&value.indexOf("%")>0}function CreateStyleValue(value,units){return typeof value=="string"?value.replace(new RegExp("^([\\-]?[\\.\\d]+)(px|%)?$","i"),"$1"+units):isNaN(value)?"auto":units?Math.round(value)+""+units:value+""}function CalculateNumericValue(currValue,newValue){var numVal,isCurrPercent,m1;if(typeof newValue=="string"){if(IsIncrementValue(newValue)){if(numVal=ExtractNumericValue(newValue.substr(2)),isCurrPercent=false,typeof currValue=="string"&&(isCurrPercent=IsPercent(currValue),currValue=parseFloat(currValue)),IsPercent(newValue)&&(isCurrPercent||(numVal=currValue*numVal/100)),m1=newValue?newValue.match(new RegExp("^[\\+\\-\\*]\\=")):null,m1&&m1[0]){switch(m1[0]){case"+=":currValue+=numVal;break;case"-=":currValue-=numVal;break;case"*=":currValue*=numVal}}return currValue}return ExtractNumericValue(newValue)}return newValue}function GetComputedStyleDeclaration(element){return element.ownerDocument&&element.ownerDocument.defaultView&&element.ownerDocument.defaultView.getComputedStyle?element.ownerDocument.defaultView.getComputedStyle(element):window.getComputedStyle?window.getComputedStyle(element):element.currentStyle?element.currentStyle:element.style}function GetComputedStyle(element,stylePropName){var styleName=ConvertCssNameToCamel(stylePropName),styleValue=undefined,numValue=NaN,cunits,isNumber=false,tmp1,refArr;if(stylePropName=="opacity"){numValue=GetOpacity(element),styleValue=numValue+""}else if(styleName=="zIndex"){numValue=GetZIndex(element),styleValue=numValue+""}else if(stylePropName.indexOf("client")==0||stylePropName.indexOf("offset")==0||stylePropName.indexOf("scroll")==0){if(tmp1=element[styleName],typeof tmp1=="string"){styleValue=tmp1,numValue=ExtractNumericValue(tmp1)}else if(Calysto.Type.TypeInspector.IsNumber(tmp1)){numValue=tmp1,styleValue=tmp1+""}else throw new Error("Extracting number is not supported");}else styleValue=element.style[styleName],(!styleValue||stylePropName.indexOf("color")>=0||styleValue=="auto"||styleValue=="initial"||styleValue=="inherit")&&(styleValue=GetComputedStyleDeclaration(element)[styleName]),refArr=[],TryExtractStyleNumericValue(styleValue,refArr)&&(isNumber=true,numValue=Math.round(refArr.pop()),cunits=ExtractUnits(styleValue,stylePropName));if(Calysto.Type.TypeInspector.IsNumber(numValue)&&styleValue=="auto"){switch(styleName){case"height":numValue=element.clientHeight;break;case"width":numValue=element.clientWidth}}return{Element:element,Name:stylePropName,NumericValue:numValue,IsNumber:isNumber,Units:cunits,StyleValue:styleValue+"",StyleName:styleName}}function SetStyleValue(element,name,value,units){var styleName,styleValue,numVal,curr;if(element&&element.style){if(styleName=ConvertCssNameToCamel(name),IsIncrementValue(value)){curr=GetComputedStyle(element,name),numVal=CalculateNumericValue(curr.NumericValue,value),styleValue=CreateStyleValue(numVal,units||curr.Units)}else if(typeof value=="string"){let units1=ExtractUnits(value,name);styleValue=CreateStyleValue(value,units1)}else{let units2=units||ExtractUnits(value,name);numVal=value,styleValue=CreateStyleValue(value,units2)}if(name=="opacity"){SetOpacity(element,numVal)}else if(name.indexOf("offset")!=0){if(name.indexOf("client")==0||name.indexOf("scroll")==0){element[name]=numVal}else try{element.style[styleName]=styleValue}catch(e){}}}}function GetAttributeNode(element,attrName){return element&&element.getAttributeNode?element.getAttributeNode(attrName):null}function GetAttribute(element,attrName){return element&&element.getAttribute?element.getAttribute(attrName):null}function SetAttribute(element,attrName,value){element&&element.setAttribute&&element.setAttribute(attrName,value)}function RemoveAttribute(element,attrName){element&&element.removeAttribute&&element.removeAttribute(attrName)}function HasAttribute(element,attrName){if(element){if(element.hasAttribute){return element.hasAttribute(attrName)};if(element.getAttribute){return!(element.getAttribute(attrName)==null)}}return false}function SetEnabled(element,enabled){element&&(enabled?(RemoveAttribute(element,"disabled"),element.disabled=false):(SetAttribute(element,"disabled","disabled"),element.disabled=true))}function CloneNodeIfHasParent(node){return node&&node.parentNode&&node.cloneNode?node.cloneNode(true):node}function RemoveNodeFromDom(node){node&&node.parentNode&&node.parentNode.removeChild(node)}function InsertBefore(refNode,elArray){var n,n1;if(refNode&&refNode.parentNode){if(elArray&&elArray.length>0){for(n=elArray.length-1;n>=0;n--){n1=elArray[n],n1&&refNode.parentNode&&(refNode.parentNode.insertBefore(n1,refNode),refNode=n1)}}}else throw new Error("InsertBefore failed, no parentNode");}function ReplaceWith(refNode,elArray){InsertBefore(refNode,elArray),refNode&&refNode.parentNode&&refNode.parentNode.removeChild(refNode)}function InsertAfter(refNode,elArray){var n,n1;if(refNode&&refNode.parentNode){if(elArray&&elArray.length>0){for(n=0;n<elArray.length;n++){n1=elArray[n],n1&&refNode.parentNode&&(refNode.parentNode.insertBefore(n1,refNode),refNode.parentNode.insertBefore(refNode,n1),refNode=n1)}}}else throw new Error("InsertAfter failed, no parentNode");}function ReplaceChildrenWith(parent,childrenArray){var nn,n;if(parent&&parent.childNodes&&parent.nodeType==1){for(n=parent.childNodes.length-1;n>=0;n--){nn=parent.childNodes[n],nn&&nn.parentNode&&nn.parentNode.removeChild(nn)};if(childrenArray&&childrenArray.length>0){for(n=0;n<childrenArray.length;n++){parent.appendChild(childrenArray[n])}}}}function AddChildren(parent,childrenArray){var n,n1;if(parent&&parent.childNodes&&parent.nodeType==1&&childrenArray&&childrenArray.length>0){for(n=0;n<childrenArray.length;n++){n1=childrenArray[n],n1&&parent.appendChild(n1)}}}function InsertChildren(parent,childrenArray){parent&&parent.childNodes&&(parent.childNodes.length>0?InsertBefore(parent.childNodes[0],childrenArray):AddChildren(parent,childrenArray))}function ConvertToElementsArray(...args){var res,args,n1;if(arguments.length==0){return[]};for(res=[],args=Calysto.Collections.SelectFlatten(arguments),n1=0;n1<args.length;n1++){res.AddRange(ConvertSingleToElementsArray(args[n1]))};return res}function ConvertSingleToElementsArray(htmlOrElement){var div,items,node1,n,node2;if(Calysto.Type.TypeInspector.IsNullOrUndefined(htmlOrElement)){return[]};if(typeof htmlOrElement=="number"&&(htmlOrElement=htmlOrElement+""),typeof htmlOrElement=="string"){if(String.IsNullOrWhiteSpace(htmlOrElement)){return[]};for(div=document.createElement("div"),div.innerHTML=htmlOrElement,items=[],n=0;n<div.childNodes.length;n++){node1=div.childNodes[n],items.push(node1)};for(n=0;n<items.length;n++){node2=items[n],node2&&node2.parentNode&&node2.parentNode.removeChild(node2)};return items}if(htmlOrElement.childNodes){return[htmlOrElement]};throw new Error("Invalid type in ConvertSingleToElementsArray");}function CenterElementIntoParent(element,crop,enlarge){var el=element,shrink,mleft,mtop;if(el&&el.parentNode&&el.parentNode.clientHeight>0&&el.parentElement.clientWidth>0){shrink=true,el.parentNode.style.overflow="hidden",(enlarge||shrink)&&((el.tagName||"").toLowerCase()=="img"&&(el.removeAttribute("width"),el.removeAttribute("height"),el.style.width="",el.style.height=""),el.style.margin="");var elWidth=el.__initialWidth||el.offsetWidth||el.clientWidth,elHeight=el.__initialHeight||el.offsetHeight||el.clientHeight,ar=elWidth/elHeight||1,w=elWidth,h=elHeight;(enlarge&&(w<el.parentElement.clientWidth||h<el.parentElement.clientHeight)||shrink&&(w>el.parentElement.clientWidth||h>el.parentElement.clientHeight))&&(w=el.parentElement.clientWidth,h=w/ar,(crop&&h<el.parentElement.clientHeight||!crop&&h>el.parentElement.clientHeight)&&(h=el.parentElement.clientHeight,w=h*ar)),el.style.position="relative",el.style.top="0",el.style.left="0",el.style.bottom="0",el.style.right="0",el.style.padding="0",el.style.margin="0",w=Math.ceil(w),h=Math.ceil(h),mleft=Math.floor((el.parentNode.clientWidth-w)/2),mtop=Math.floor((el.parentNode.clientHeight-h)/2),el.style.marginTop=mtop+"px",el.style.marginLeft=mleft+"px",el.style.width=w+"px",el.style.height=h+"px"}}function SelectTransform(node){return node&&node.style?node.style.transform||node.style.msTransform||node.style.webkitTransform:""}var _fixedDiv,rePxNumericProperties;class ScrollHandler{constructor(){this._currDeltaY=0,this._currDeltaX=0}HandleScroll(sender,ev){if(ev.deltaY||ev.deltaX){let dy=ev.deltaY||0,dx=ev.deltaX||0;if(ev.shiftKey){let t1=dy;dy=dx,dx=t1}switch(ev.deltaMode){case 0:this._currDeltaY+=dy,this._currDeltaX+=dx;break;case 1:this._currDeltaY+=dy*20,this._currDeltaX+=dx*20;break;case 2:this._currDeltaY+=dy*window.screen.height,this._currDeltaX+=dx*window.screen.height}Math.abs(this._currDeltaY)>10&&(sender.scrollTop+=this._currDeltaY,this._currDeltaY=0),Math.abs(this._currDeltaX)>10&&(sender.scrollLeft+=this._currDeltaX,this._currDeltaX=0)}}}Dom.ScrollHandler=ScrollHandler;let NodeTypeEnum;(function(NodeTypeEnum){NodeTypeEnum[NodeTypeEnum.ELEMENT_NODE=1]="ELEMENT_NODE",NodeTypeEnum[NodeTypeEnum.ATTRIBUTE_NODE=2]="ATTRIBUTE_NODE",NodeTypeEnum[NodeTypeEnum.TEXT_NODE=3]="TEXT_NODE",NodeTypeEnum[NodeTypeEnum.CDATA_SECTION_NODE=4]="CDATA_SECTION_NODE",NodeTypeEnum[NodeTypeEnum.ENTITY_REFERENCE_NODE=5]="ENTITY_REFERENCE_NODE",NodeTypeEnum[NodeTypeEnum.ENTITY_NODE=6]="ENTITY_NODE",NodeTypeEnum[NodeTypeEnum.PROCESSING_INSTRUCTION_NODE=7]="PROCESSING_INSTRUCTION_NODE",NodeTypeEnum[NodeTypeEnum.COMMENT_NODE=8]="COMMENT_NODE",NodeTypeEnum[NodeTypeEnum.DOCUMENT_NODE=9]="DOCUMENT_NODE",NodeTypeEnum[NodeTypeEnum.DOCUMENT_TYPE_NODE=10]="DOCUMENT_TYPE_NODE",NodeTypeEnum[NodeTypeEnum.DOCUMENT_FRAGMENT_NODE=11]="DOCUMENT_FRAGMENT_NODE",NodeTypeEnum[NodeTypeEnum.NOTATION_NODE=12]="NOTATION_NODE"})(NodeTypeEnum=Dom.NodeTypeEnum||(Dom.NodeTypeEnum={})),Dom.TrimSpaces=TrimSpaces,Dom.EnsureElementId=EnsureElementId,Dom.IsElementVisible=IsElementVisible,Dom.IsElementInDom=IsElementInDom,Dom.IsDescendant=IsDescendant,Dom.GetInnerText=GetInnerText,Dom.HasTagName=HasTagName,Dom.GetViewportDiv=GetViewportDiv,Dom.GetElementScreenPosition=GetElementScreenPosition,Dom.GetElementPagePosition=GetElementPagePosition,Dom.GetScrollableAncestors=GetScrollableAncestors,Dom.GetPageDimensions=GetPageDimensions,Dom.IsElementInViewport=IsElementInViewport,Dom.GetElementToViewportPosition=GetElementToViewportPosition,Dom.ParseClip=ParseClip,Dom.GetClip=GetClip,Dom.CalculateClip=CalculateClip,Dom.SetClip=SetClip,Dom.HasClass=HasClass,Dom.AddClass=AddClass,Dom.RemoveClass=RemoveClass,Dom.SetClass=SetClass,Dom.ToggleClass=ToggleClass,Dom.ConvertCssNameToCamel=ConvertCssNameToCamel,Dom.ConvertCssNameFromCamel=ConvertCssNameFromCamel,Dom.SetOpacity=SetOpacity,Dom.GetOpacity=GetOpacity,Dom.GetZIndex=GetZIndex,Dom.GetZIndexNested=GetZIndexNested,rePxNumericProperties=new RegExp("top|left|bottom|right|width|height|size|radius|padding|margin","i"),Dom.ExtractUnits=ExtractUnits,Dom.TryExtractStyleNumericValue=TryExtractStyleNumericValue,Dom.ExtractNumericValue=ExtractNumericValue,Dom.IsIncrementValue=IsIncrementValue,Dom.IsPercent=IsPercent,Dom.CreateStyleValue=CreateStyleValue,Dom.CalculateNumericValue=CalculateNumericValue,Dom.GetComputedStyleDeclaration=GetComputedStyleDeclaration,Dom.GetComputedStyle=GetComputedStyle,Dom.SetStyleValue=SetStyleValue,Dom.GetAttributeNode=GetAttributeNode,Dom.GetAttribute=GetAttribute,Dom.SetAttribute=SetAttribute,Dom.RemoveAttribute=RemoveAttribute,Dom.HasAttribute=HasAttribute,Dom.SetEnabled=SetEnabled,Dom.CloneNodeIfHasParent=CloneNodeIfHasParent,Dom.RemoveNodeFromDom=RemoveNodeFromDom,Dom.InsertBefore=InsertBefore,Dom.ReplaceWith=ReplaceWith,Dom.InsertAfter=InsertAfter,Dom.ReplaceChildrenWith=ReplaceChildrenWith,Dom.AddChildren=AddChildren,Dom.InsertChildren=InsertChildren,Dom.ConvertToElementsArray=ConvertToElementsArray,Dom.CenterElementIntoParent=CenterElementIntoParent,Dom.SelectTransform=SelectTransform})(Dom=Utility.Dom||(Utility.Dom={}))})(Utility=Calysto.Utility||(Calysto.Utility={}))}(Calysto||(Calysto={})),function(Calysto){var Utility;(function(Utility){var Path;(function(Path){function RemoveQueryStr(path){var index;return path&&(index=path.indexOf("?"))>=0?path.substr(0,index):path}function GetQueryString(path){var index;return path&&(index=path.indexOf("?"))>=0?path.substr(index):""}function GetFilePath(path){var index;return path&&(index=path.indexOf("?"))>=0?path.substr(0,index):path}function GetExtension(path){var index;return path&&(path=RemoveQueryStr(path))&&(index=path.lastIndexOf("."))>=0?path.substr(index):""}function GetDirectoryName(path){var index;return path&&(path=RemoveQueryStr(path))&&((index=path.lastIndexOf("/"))>=0||(index=path.lastIndexOf("\\"))>=0)?path.substr(0,index):path}function GetFileName(path){var index;return path&&(path=RemoveQueryStr(path))&&((index=path.lastIndexOf("/"))>=0||(index=path.lastIndexOf("\\"))>=0)?path.substr(index+1):path}Path.GetQueryString=GetQueryString,Path.GetFilePath=GetFilePath,Path.GetExtension=GetExtension,Path.GetDirectoryName=GetDirectoryName,Path.GetFileName=GetFileName})(Path=Utility.Path||(Utility.Path={}))})(Utility=Calysto.Utility||(Calysto.Utility={}))}(Calysto||(Calysto={})),function(Calysto){var Utility;(function(Utility){var Blob;(function(Blob){function CreateBlob(byteArrays,contentType){var win,blobCtor,bb;if(window.Blob){return new window.Blob(byteArrays,{type:contentType})};if(win=window,blobCtor=win.BlobBuilder||win.WebKitBlobBuilder||win.MozBlobBuilder||win.MSBlobBuilder,blobCtor){bb=new blobCtor,bb.append(byteArrays);return bb.getBlob(contentType)}throw new Error("Blob is not supported");}function Base64ToBlob(base64Data,contentType){var sliceIndex,offset,i,arr;contentType=contentType||"";var sliceSize=1024,byteCharacters=atob(base64Data),bytesLength=byteCharacters.length,slicesCount=Math.ceil(bytesLength/sliceSize),byteArrays=new Array(slicesCount);for(sliceIndex=0;sliceIndex<slicesCount;++sliceIndex){var begin=sliceIndex*sliceSize,end=Math.min(begin+sliceSize,bytesLength),bytes=new Array(end-begin);for(offset=begin,i=0;offset<end;++i,++offset){bytes[i]=byteCharacters[offset].charCodeAt(0)};arr=new Uint8Array(bytes),byteArrays[sliceIndex]=arr}return CreateBlob(byteArrays,contentType)}function DataUrlToBlob(dataUrl,filename){for(var pp,blob,type,base64data,parts=dataUrl.split(";"),n=0;n<parts.length;n++){pp=parts[n],pp.StartsWith("data:")?type=pp.substr(5):pp.StartsWith("base64,")&&(base64data=pp.substr(7))};blob=Base64ToBlob(base64data,type),blob.filename=filename;return blob}function BlobToBase64Async(blob,onComplete){var reader=new FileReader;reader.onload=function(res){for(var str,b64,arr=new Uint8Array(res.currentTarget.result),chars=[arr.length],n=0;n<arr.length;n++){chars[n]=String.fromCharCode(arr[n])};str=chars.join(""),b64=btoa(str),onComplete(b64)},reader.readAsArrayBuffer(blob)}function BlobToDataUrlAsync(blob,onComplete){var reader=new FileReader;reader.onload=function(res){onComplete(res.currentTarget.result,blob.name||blob.filename)},reader.readAsDataURL(blob)}Blob.CreateBlob=CreateBlob,Blob.Base64ToBlob=Base64ToBlob,Blob.DataUrlToBlob=DataUrlToBlob,Blob.BlobToBase64Async=BlobToBase64Async,Blob.BlobToDataUrlAsync=BlobToDataUrlAsync})(Blob=Utility.Blob||(Utility.Blob={}))})(Utility=Calysto.Utility||(Calysto.Utility={}))}(Calysto||(Calysto={})),function(Calysto){var Utility;(function(Utility){var Caret;(function(Caret){function SetInputSelectionRange(node,start,end){var object=node,range;if(object!=null&&object.type){try{(!start||start<0)&&(start=0),(arguments.length<3||end>object.value.length)&&(end=object.value.length),object.setSelectionRange?(object.focus(),object.setSelectionRange(start,end)):object.createTextRange&&(object.focus(),object.caret?(range=object.caret,range.moveStart("textedit",-1),range.moveEnd("textedit",-1)):range=object.createTextRange(),range.moveEnd("character",end),range.moveStart("character",start),range.select())}catch(e){}}}function SetCaretPosition(node,position){SetInputSelectionRange(node,position,position)}function GetCaretPosition(obj){var object=obj,range;if(object==null||!object.type){return null};try{if(object.createTextRange&&object.caret){range=object.caret.duplicate(),range.moveStart("textedit",-1);return range.text.length}if(object.selectionStart||object.selectionStart==0){return object.selectionStart}}catch(e){}return null}function GetInputSelectionRange(obj){var object=obj,end;if(object==null||!object.type){return null};try{if(object.selectionEnd){return{start:object.selectionStart,end:object.selectionEnd}};if(object.createTextRange&&object.caret&&(end=GetCaretPosition(object),typeof end=="number")){return{start:end-object.caret.text.length,end:end}}}catch(e){}return null}Caret.SetInputSelectionRange=SetInputSelectionRange,Caret.SetCaretPosition=SetCaretPosition,Caret.GetCaretPosition=GetCaretPosition,Caret.GetInputSelectionRange=GetInputSelectionRange})(Caret=Utility.Caret||(Utility.Caret={}))})(Utility=Calysto.Utility||(Calysto.Utility={}))}(Calysto||(Calysto={})),function(Calysto){var Utility;(function(Utility){var FullScreen;(function(FullScreen){function RequestFullScreen(el){var divObj=el,requestFunc=divObj.requestFullscreen||divObj.msRequestFullscreen||divObj.mozRequestFullScreen||divObj.webkitRequestFullscreen||divObj.webkitRequestFullScreen||divObj.webkitEnterFullScreen||divObj.webkitEnterFullscreen;requestFunc&&requestFunc.apply(divObj)}function CancelFullScreen(){cancelFunc&&cancelFunc.apply(document)}function GetFullScreenElement(){var doc=document;return doc.fullscreenElement||doc.msFullscreenElement||doc.mozFullScreenElement||doc.webkitFullscreenElement||doc.webkitCurrentFullScreenElement||doc.webkitDisplayingFullscreen}function IsInFullscreen(){return!!GetFullScreenElement()}function IsIframeFullscreenEnabled(){var doc=document;return!!(doc.fullscreenEnabled||doc.msFullscreenEnabled||doc.mozFullScreenEnabled||doc.webkitFullscreenEnabled||"webkitIsFullScreen"in doc)}function IsSupported(){return window.parent?!!(cancelFunc&&IsIframeFullscreenEnabled()):!!cancelFunc}function OnFullscreenChanged(handler){if(!_evChgAssigned){_evChgAssigned=true;var sender=document;chg.ForEach(evName=>Calysto.Event.Attach(sender,evName,()=>{_onFsChanged.ForEach(fn=>fn(sender))}))}_onFsChanged.push(handler)}function OnFullscreenError(handler){if(!_evErrAssigned){_evErrAssigned=true;var sender=document;err.ForEach(evName=>Calysto.Event.Attach(sender,evName,()=>{_onFsError.ForEach(fn=>fn(sender))}))}_onFsError.push(handler)}var cancelFunc,_evErrAssigned,_onFsError;FullScreen.RequestFullScreen=RequestFullScreen,cancelFunc=(()=>{var doc=document;return doc.cancelFullscreen||doc.msExitFullscreen||doc.msCancelFullscreen||doc.mozCancelFullScreen||doc.webkitExitFullscreen||doc.webkitExitFullScreen||doc.webkitCancelFullscreen||doc.webkitCancelFullScreen})(),FullScreen.CancelFullScreen=CancelFullScreen,FullScreen.GetFullScreenElement=GetFullScreenElement,FullScreen.IsInFullscreen=IsInFullscreen,FullScreen.IsIframeFullscreenEnabled=IsIframeFullscreenEnabled,FullScreen.IsSupported=IsSupported;var chg=["MSFullscreenChange","webkitfullscreenchange","mozfullscreenchange","fullscreenchange"],err=["MSFullscreenError","webkitfullscreenerror","mozfullscreenerror","fullscreenerror"],_evChgAssigned=false,_onFsChanged=[];FullScreen.OnFullscreenChanged=OnFullscreenChanged,_evErrAssigned=false,_onFsError=[],FullScreen.OnFullscreenError=OnFullscreenError})(FullScreen=Utility.FullScreen||(Utility.FullScreen={}))})(Utility=Calysto.Utility||(Calysto.Utility={}))}(Calysto||(Calysto={})),function(Calysto){var Utility;(function(Utility){var CalystoTools;(function(CalystoTools){function LongToByteArray(longNum,truncateEmptyBytes){var byteArray,index,b1;if(!(longNum>0||longNum===0)){throw new Error("LongToByteArray argument may not be negative");}for(byteArray=[],index=0;index<8;index++){if(b1=longNum&255,truncateEmptyBytes&&Math.pow(2,index*8)>longNum){(b1>0||byteArray.length==0)&&byteArray.push(b1);break}else byteArray.push(b1),longNum=(longNum-b1)/256};return byteArray}function ByteArrayToLong(byteArray){for(var value=0,i=byteArray.length-1;i>=0;i--){value=value*256+byteArray[i]};return value}CalystoTools.LongToByteArray=LongToByteArray,CalystoTools.ByteArrayToLong=ByteArrayToLong})(CalystoTools=Utility.CalystoTools||(Utility.CalystoTools={}))})(Utility=Calysto.Utility||(Calysto.Utility={}))}(Calysto||(Calysto={})),function(Calysto){var Graphics;(function(Graphics){let ResizeModeEnum;(function(ResizeModeEnum){ResizeModeEnum[ResizeModeEnum.Fit=0]="Fit",ResizeModeEnum[ResizeModeEnum.Crop=1]="Crop",ResizeModeEnum[ResizeModeEnum.Exact=2]="Exact",ResizeModeEnum[ResizeModeEnum.Stretch=3]="Stretch"})(ResizeModeEnum=Graphics.ResizeModeEnum||(Graphics.ResizeModeEnum={}));class ImageResize{constructor(){this.Width=500,this.Height=500,this.Mode="Fit",this.Overscan=0}Resize(source){var thumbWidth=source.width,thumbHeight=source.height,ar=source.width/source.height,canvasWidth=this.Width,canvasHeight=this.Height,c22,cx22,left1,top1;if(this.Mode=="Stretch"?(thumbWidth=this.Width,thumbHeight=this.Height):this.Mode=="Exact"||this.Mode=="Fit"?(thumbWidth=this.Width,thumbHeight=thumbWidth/ar,thumbHeight>this.Height&&(thumbHeight=this.Height,thumbWidth=thumbHeight*ar),this.Mode=="Fit"&&(canvasWidth=thumbWidth,canvasHeight=thumbHeight)):this.Mode=="Crop"&&(thumbWidth=Math.min(source.width,this.Width),thumbHeight=thumbWidth/ar,thumbHeight<this.Height&&(thumbHeight=Math.min(source.height,this.Height),thumbWidth=thumbHeight*ar),canvasWidth=Math.min(thumbWidth,this.Width),canvasHeight=Math.min(thumbHeight,this.Height)),thumbHeight+=this.Overscan,thumbWidth+=this.Overscan,c22=document.createElement("canvas"),cx22=c22.getContext("2d"),!cx22){throw new Error("Can not create 2d context");}c22.width=canvasWidth,c22.height=canvasHeight,this.BackColor&&this.BackColor!="transparent"&&(cx22.fillStyle=this.BackColor,cx22.fillRect(0,0,c22.width,c22.height)),left1=(canvasWidth-thumbWidth)/2,top1=(canvasHeight-thumbHeight)/2,cx22.drawImage(source,left1,top1,thumbWidth,thumbHeight);return c22.toDataURL(this.OutputMime||"image/png")}}Graphics.ImageResize=ImageResize})(Graphics=Calysto.Graphics||(Calysto.Graphics={}))}(Calysto||(Calysto={})),function(Calysto){class QueryString{constructor(urlStr){this.urlStr=urlStr,this.items=[],urlStr&&this.ParseImpl(urlStr)}GetInnerUri(){return this.uri||(this.uri=new Calysto.Uri)}GetQuery(){for(var item,arr=[],n=0;n<this.items.length;n++){item=this.items[n],arr.push(encodeURIComponent(item.name)+"="+encodeURIComponent(item.value))};return arr.length>0?"?"+arr.join("&"):""}GetUrl(){this.uri=this.uri||new Calysto.Uri,this.uri.Query=this.GetQuery();return this.uri.GetAbsoluteUri()}Clear(){this.items=[]}FindItem(name,caseSensitive=false){if(caseSensitive){return this.items.Where(o=>o.name==name)};var lower=name.toLowerCase();return this.items.Where(o=>o.lowerName==lower)}SetValue(name,value){if(name){var item=this.FindItem(name).pop(),lower=name.toLowerCase();item?(item.lowerName=lower,item.name=name,item.value=Calysto.Type.TypeInspector.IsNullOrUndefined(value)?"":value+""):(item={lowerName:lower,name:name,value:Calysto.Type.TypeInspector.IsNullOrUndefined(value)?"":value+""},this.items.push(item))}return this}RemoveValue(name){if(name){var lower=name.toLowerCase();this.items=this.items.Where(o=>o.lowerName!=lower)}return this}GetValue(name){var item=this.FindItem(name).pop();return item?item.value:null}ParseImpl(url){var qstr,pairsArr,n;if(this.uri=new Calysto.Uri(url),qstr=(this.uri.Query||"").Trim(["?"]),qstr){for(pairsArr=qstr.split("&"),n=0;n<pairsArr.length;n++){var pair=pairsArr[n].split("="),name=decodeURIComponent(pair[0]),value=decodeURIComponent(pair[1]);this.SetValue(name,value)}}return this}}Calysto.QueryString=QueryString}(Calysto||(Calysto={})),function(Calysto){var ScriptLoader;(function(ScriptLoader){function ReloadScriptNode(node){let tagName=node.tagName.toLowerCase(),s1=document.createElement(tagName);for(let n1=0;n1<node.attributes.length;n1++){s1.setAttribute(node.attributes[n1].name,node.attributes[n1].value)};s1.text=s1.textContent=node.textContent||node.text,Calysto.Utility.Dom.ReplaceWith(node,[s1]);return s1}function LoadJSFile(scriptFileUrl,isAsync){var s=document.createElement("script");s.type="text/javascript",s.src=scriptFileUrl,s.async=!!isAsync,(document.getElementsByTagName("head")[0]||document.body||document.documentElement).appendChild(s);return s}function LoadJS(javascriptCode){var s=document.createElement("script");s.type="text/javascript",s.text=s.textContent=javascriptCode,(document.getElementsByTagName("head")[0]||document.body||document.documentElement).appendChild(s);return s}function LoadCSSFile(cssFileUrl){var s=document.createElement("link");s.rel="stylesheet",s.type="text/css",s.href=cssFileUrl,(document.getElementsByTagName("head")[0]||document.body||document.documentElement).appendChild(s);return s}function LoadCSS(cssScriptCode){var s=document.createElement("style");s.type="text/css",s.text=s.textContent=cssScriptCode,(document.getElementsByTagName("head")[0]||document.body||document.documentElement).appendChild(s);return s}ScriptLoader.ReloadScriptNode=ReloadScriptNode,ScriptLoader.LoadJSFile=LoadJSFile,ScriptLoader.LoadJS=LoadJS,ScriptLoader.LoadCSSFile=LoadCSSFile,ScriptLoader.LoadCSS=LoadCSS})(ScriptLoader=Calysto.ScriptLoader||(Calysto.ScriptLoader={}))}(Calysto||(Calysto={})),function(Calysto){class Timer{constructor(onTimeout){this.onTimeout=onTimeout,this.sleepMs=0,this.items=[],onTimeout&&this.OnTimeout(onTimeout)}IsRunning(){return!!this.timeoutId}Abort(){this.timeoutId&&(clearTimeout(this.timeoutId),this.timeoutId=null);return this}Start(delayMs){this.Abort(),this.timeoutId=setTimeout(()=>{clearTimeout(this.timeoutId),this.timeoutId=null;for(var n=0;n<this.items.length;n++){this.items[n](this)}},delayMs>0?delayMs:0);return this}OnTimeout(func){this.items.push(func);return this}}Calysto.Timer=Timer;class BussyTimer{constructor(timeoutMs){this.timeoutMs=timeoutMs,this._expires=0}Start(){this._expires=Date.now()+this.timeoutMs;return this}Abort(){this._expires=0;return this}IsBussy(){return this._expires>Date.now()}IsBussyOrStart(){if(this.IsBussy()){return true};this.Start();return false}}Calysto.BussyTimer=BussyTimer;class MouseTimer{constructor(timeoutMs=300){this._timer=new BussyTimer(timeoutMs)}IsDoubleclicked(){return this._timer.IsBussyOrStart()}}Calysto.MouseTimer=MouseTimer}(Calysto||(Calysto={})),function(Calysto){let PartEnum;(function(PartEnum){PartEnum[PartEnum.Scheme=0]="Scheme",PartEnum[PartEnum.Host=1]="Host",PartEnum[PartEnum.Port=2]="Port",PartEnum[PartEnum.Path=3]="Path",PartEnum[PartEnum.Query=4]="Query",PartEnum[PartEnum.Hash=5]="Hash"})(PartEnum||(PartEnum={}));class Uri{constructor(url){this.Scheme="",this.Username="",this.Password="",this.Host="",this.Port="",this.Path="",this.Query="",this.Hash="",url&&this.ParseUrl(url)}CloneUri(startKind,endKind=PartEnum.Hash){let uri=new Calysto.Uri;startKind<=PartEnum.Scheme&&endKind>=PartEnum.Scheme&&(uri.Scheme=this.Scheme),startKind<=PartEnum.Host&&endKind>=PartEnum.Host&&(uri.Username=this.Username,uri.Password=this.Password,uri.Host=this.Host),startKind<=PartEnum.Port&&endKind>=PartEnum.Port&&(uri.Port=this.Port),startKind<=PartEnum.Path&&endKind>=PartEnum.Path&&(uri.Path=this.Path),startKind<=PartEnum.Query&&endKind>=PartEnum.Query&&(uri.Query=this.Query),startKind<=PartEnum.Hash&&endKind>=PartEnum.Hash&&(uri.Hash=this.Hash);return uri}BuildUri(){let sb=[];String.IsNullOrEmpty(this.Scheme)||sb.push(this.Scheme+":"),String.IsNullOrEmpty(this.Host)||(sb.push("//"),String.IsNullOrEmpty(this.Username)||(sb.push(this.Username),String.IsNullOrEmpty(this.Password)||sb.push(":"+this.Password),String.IsNullOrEmpty(this.Username)&&String.IsNullOrEmpty(this.Password)||sb.push("@")),String.IsNullOrEmpty(this.Host)||sb.push(this.Host),this.Port&&sb.push(":"+this.Port)),String.IsNullOrEmpty(this.Path)||sb.push(this.Path),String.IsNullOrEmpty(this.Query)||(this.Query.StartsWith("?")||sb.push("?"),sb.push(this.Query)),String.IsNullOrEmpty(this.Hash)||(this.Hash.StartsWith("#")||sb.push("#"),sb.push(this.Hash));return sb.join("")}GetSchemeHost(){return this.CloneUri(PartEnum.Scheme,PartEnum.Port).BuildUri()}GetSchemeHostPath(){return this.CloneUri(PartEnum.Scheme,PartEnum.Path).BuildUri()}GetAbsoluteUri(){return this.CloneUri(PartEnum.Scheme).BuildUri()}GetPathQueryHash(){return this.CloneUri(PartEnum.Path).BuildUri()}ParseUrl(url){if(url){var m=url.match(new RegExp("(([\\w]+)\\:)?((//)(([^\\:@]+)(:([^\\:@]+))?@)?([^/\\:]+)(:([\\d]+))?)?(/[^\\?\\#]*)?(\\?[^\\#]+)?(\\#[\\w\\W]+)?"));m&&(this.Scheme=m[2]||"",this.Username=m[6]||"",this.Password=m[8]||"",this.Host=m[9]||"",this.Port=m[11]||"",this.Path=m[12]||"",this.Query=m[13]||"",this.Hash=m[14]||"")}}}Calysto.Uri=Uri}(Calysto||(Calysto={})),function(Calysto){var Validate;(function(Validate){function IsEmail(str){var __emailRegexPattern=Calysto.Constants.AppConstants.EmailRegexPattern;str+="";return!!(str&&str.match(new RegExp(__emailRegexPattern)))}function CanConvertToNumber(str){str+="";return!!(str&&str.match(new RegExp("^[\\-]*[ ]*[ \\.\\,]?[\\d]+[\\d\\.\\,]*$")))}function CanConvertToDecimal(str){return CanConvertToNumber(str)}function CanConvertToInteger(str){str+="";return!!(str&&str.match(new RegExp("^[\\- ]?[\\d]+$")))}function ContainsNumber(str){str+="";return!!(str&&str.match(new RegExp("[\\- ]?[ \\.\\,]?[\\d]+[\\d\\.\\,]*")))}function CanConvertToDate(str,format){let refArr=new Calysto.BoxValue;return Calysto.DateFormat.TryParseExact(str,format||Calysto.Globalization.CultureInfo.CurrentCulture.DateTimeFormat.ShortDatePattern,refArr)}function CanConvertToDateTime(str,format){let refArr=new Calysto.BoxValue;return Calysto.DateFormat.TryParseExact(str,format||Calysto.Globalization.CultureInfo.CurrentCulture.DateTimeFormat.GeneralLongTimePattern,refArr)}function CanConvertToByte(str){var val=parseFloat(str);return isFinite(val)&&val>0&&val<256||val===0}function IsIPv4Address(str){var m=str.match(new RegExp("^([\\d]+)\\.([\\d]+)\\.([\\d]+)\\.([\\d]+)$"));return!!(m&&CanConvertToByte(m[1])&&CanConvertToByte(m[2])&&CanConvertToByte(m[3])&&CanConvertToByte(m[4]))}Validate.IsEmail=IsEmail,Validate.CanConvertToNumber=CanConvertToNumber,Validate.CanConvertToDecimal=CanConvertToDecimal,Validate.CanConvertToInteger=CanConvertToInteger,Validate.ContainsNumber=ContainsNumber,Validate.CanConvertToDate=CanConvertToDate,Validate.CanConvertToDateTime=CanConvertToDateTime,Validate.IsIPv4Address=IsIPv4Address})(Validate=Calysto.Validate||(Calysto.Validate={}))}(Calysto||(Calysto={})),function(Calysto){class Regex{constructor(regexPattern,ignoreCase=false){this.ignoreCase=false,this.regexPattern=regexPattern||"",this.ignoreCase=ignoreCase}static Escape(str){return RegExp.Escape(str)}CreateRegex(isGlobal=false){return new RegExp(this.regexPattern,(this.ignoreCase?"i":"")+(isGlobal?"g":""))}CreateMatchSegment(currMatch,index,success){var matchArr,str;typeof currMatch=="string"?(matchArr=[currMatch],matchArr.index=index||0,matchArr.success=!!success):matchArr=currMatch,str=matchArr[0]||"";return{Success:!!(arguments.length>2?success:str),Index:arguments.length>1?index:matchArr?matchArr.index:-1,Length:str.length,Value:str,Groups:matchArr}}IsMatch(inputStr){return this.CreateRegex(false).test(inputStr)}SelectMatches(inputStr,startIndex,length){return new Calysto.CalystoEnumerable(()=>{!!startIndex&&startIndex>0&&(inputStr=inputStr.substr(startIndex||0)),!!length&&length>0&&(inputStr=inputStr.substr(0,length||0));var re=this.CreateRegex(true),m;return Calysto.CalystoEnumerator.FromYieldFunc(refYield=>{if((m=re.exec(inputStr))&&m[0]){refYield.SetValue(this.CreateMatchSegment(m));return true}return false})})}SelectSegments(inputStr,startIndex,length){return new Calysto.CalystoEnumerable(()=>{!!startIndex&&startIndex>0&&(inputStr=inputStr.substr(startIndex||0)),!!length&&length>0&&(inputStr=inputStr.substr(0,length||0));var re=this.CreateRegex(true),m,startPosition=0,segment,len=0,stack=[],match;return Calysto.CalystoEnumerator.FromYieldFunc(refYield=>{while(stack.length>0){refYield.SetValue(stack.shift());return true}if(startPosition>=inputStr.length){return false};for((m=re.exec(inputStr))&&m[0]&&(match=this.CreateMatchSegment(m),match.Index>startPosition&&(segment=inputStr.substr(startPosition,match.Index-startPosition),len=segment.length,stack.push(this.CreateMatchSegment(segment,startPosition,false)),startPosition+=len),stack.push(match),startPosition=match.Index+match.Length);stack.length>0;){refYield.SetValue(stack.shift());return true}if(segment=inputStr.substr(startPosition),len=segment.length,len>0&&(stack.push(this.CreateMatchSegment(segment,startPosition,false)),startPosition+=len),stack.length>0){refYield.SetValue(stack.shift());return true}return false})})}Matches(inputStr,startIndex,length){return this.SelectMatches(inputStr,startIndex,length).ToArray()}Match(inputStr){var m1=this.CreateRegex(false).exec(inputStr);return m1?this.CreateMatchSegment(m1):null}Replace(input,replacement){if(!input){return input};let re1=this.CreateRegex(true);return input.replace(re1,replacement)}}Calysto.Regex=Regex}(Calysto||(Calysto={})),function(Calysto){class CalystoStyleSheet{constructor(){this.disabledPrefix="-calysto-disabled-rule-",this.sheets=[]}Sheets(){if(!this.sheets){var s=Calysto.ScriptLoader.LoadCSS("");s.disabled=true,this.sheets=[s.sheet]}return this.sheets}SelectRules(cssSelector){var dicProp=this.disabledPrefix+(cssSelector=="*"?"":cssSelector);return this.Sheets().AsEnumerable().SelectMany(sheet=>sheet.cssRules).Where(o=>!!o.selectorText).Select(rule=>{rule.selectorArray||(rule.selectorArray=rule.selectorText.split(",").AsEnumerable().Select(o=>o.Trim()).ToArray(),rule.selectorDic=rule.selectorArray.AsEnumerable().ToDictionary(o=>o,()=>true));return rule}).Where(rule=>cssSelector?rule.selectorDic.ContainsKey(cssSelector)||rule.selectorDic.ContainsKey(dicProp):true)}GetIndex(cssRules,rule){for(var n=0;n<cssRules.length;n++){if(cssRules[n]==rule){return n}};return-1}DeleteRule(rule){rule.parentStyleSheet&&rule.parentStyleSheet.deleteRule(this.GetIndex(rule.parentStyleSheet.cssRules,rule))}RecreateRule(rule){var sheet=rule.parentStyleSheet;if(sheet){var style=rule.style.cssText,index=this.GetIndex(sheet.cssRules,rule),newSelector=rule.selectorArray.join(", ");newSelector&&sheet.insertRule(newSelector+"{"+style+"}",index)}}SplitSelectors(cssSelector){this.SelectRules(cssSelector).ForEach(rule=>{rule.selectorArray.AsEnumerable().ForEach(selector=>{rule.selectorDic=null,rule.selectorArray=[selector],this.RecreateRule(rule)}),this.DeleteRule(rule)});return this}AddSelector(cssSelector,newSelector){newSelector&&this.SelectRules().Where(rule=>rule.selectorDic.ContainsKey(cssSelector)&&!rule.selectorDic.ContainsKey(newSelector)).ForEach(rule=>{rule.selectorArray.push(newSelector),this.RecreateRule(rule),this.DeleteRule(rule)});return this}RemoveSelector(cssSelector){this.SelectRules(cssSelector).ForEach(rule=>{rule.selectorArray=rule.selectorArray.Where(k=>k!=cssSelector),this.RecreateRule(rule),this.DeleteRule(rule)});return this}AddRule(cssSelector,style){var sheets=this.Sheets(),current=sheets[sheets.length-1];current.addRule?current.addRule(cssSelector,style):current.insertRule&&current.insertRule(cssSelector+"{"+style+"}",current.cssRules.length);return this}RemoveRules(cssSelector){this.SelectRules(cssSelector).ForEach(rule=>{rule.parentStyleSheet&&rule.parentStyleSheet.deleteRule(this.GetIndex(rule.parentStyleSheet.cssRules,rule))});return this}DisableRules(cssSelector){this.SelectRules(cssSelector).ForEach(rule=>{rule.selectorArray=rule.selectorArray.Select(k=>cssSelector&&k!=cssSelector?k:k.indexOf(this.disabledPrefix)==0?k:this.disabledPrefix+(k=="*"?"":k)),this.RecreateRule(rule),this.DeleteRule(rule)});return this}EnableRules(cssSelector){var dicProp=this.disabledPrefix+(cssSelector=="*"?"":cssSelector);this.SelectRules(cssSelector).ForEach(rule=>{rule.selectorArray=rule.selectorArray.Select(k=>cssSelector?k==dicProp?cssSelector:k:k.replace(this.disabledPrefix,"")||"*"),this.RecreateRule(rule),this.DeleteRule(rule)});return this}ToCssText(separator){return this.SelectRules().Select(o=>o.cssText).ToStringJoined(separator||"")}static GetCurrent(){document.styleSheets.length==0&&Calysto.ScriptLoader.LoadCSS("");var ss=new CalystoStyleSheet;ss.sheets=[];for(let n=0;n<document.styleSheets.length;n++){ss.sheets.push(document.styleSheets[n])};return ss}}Calysto.CalystoStyleSheet=CalystoStyleSheet}(Calysto||(Calysto={})),function(Calysto){var Json;(function(Json){var Infrastructure;(function(Infrastructure){class JsonBlob{constructor(){this.__calystotype="Calysto_Blob"}}Infrastructure.JsonBlob=JsonBlob;class JsonDateTime{constructor(){this.__calystotype="Calysto_Date"}}Infrastructure.JsonDateTime=JsonDateTime;class JsonFunction{constructor(){this.__calystotype="Calysto_Function"}}Infrastructure.JsonFunction=JsonFunction,Infrastructure.escapeeChars={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"}})(Infrastructure=Json.Infrastructure||(Json.Infrastructure={}))})(Json=Calysto.Json||(Calysto.Json={}))}(Calysto||(Calysto={})),function(Calysto){var Json;(function(Json){var Infrastructure;(function(Infrastructure){class CalystoJsonSerializer{constructor(isAsync=false){this.parts=[],this.blobs=[],this.indexes=[],this.isAsync=false,this.escapee=Infrastructure.escapeeChars,this.SerializeFunctions=false,this.parts=[],this.blobs=[],this.indexes=[],this.isAsync=!!isAsync}Write(str){this.parts.push(str)}isArray(v){return v&&typeof v.pop=="function"}isDate(v){return v&&typeof v.getFullYear=="function"}encodeString(s){var s1=s.replace(new RegExp('([\\\\\x00-\x1f\\"])',"g"),(a,b)=>{var c=this.escapee[b];if(c){return c};c=b.charCodeAt();return"\\u00"+Math.floor(c/16).toString(16)+(c%16).toString(16)});this.Write('"'+s1+'"')}encodeArray(o,recursionLeft){this.Write("[");for(var addComma,len=o.length,val,vtype,n=0;n<len;n++){val=o[n],vtype=typeof val,vtype=="undefined"||(vtype!="function"||this.SerializeFunctions)&&(addComma&&this.Write(","),val===null?this.Write("null"):this.serializeWithCalysto(val,recursionLeft-1),addComma=true)};this.Write("]")}createJsonDateTime(o){var obj=new Infrastructure.JsonDateTime;obj.Date=Date.ToLocalISOTString(o);return obj}serializeDate(o){this.Write((new CalystoJsonSerializer).Serialize(this.createJsonDateTime(o)))}createJsonFunction(o){let obj=new Infrastructure.JsonFunction;obj.Function=o+"";return obj}serializeFunction(o){this.Write((new CalystoJsonSerializer).Serialize(this.createJsonFunction(o)))}createBlob(o){if(!this.isAsync){throw new Error("Blob type serialization requires async serializer mode");}var uid=this.blobs.length+100+Math.random()+"";this.blobs.push({UID:uid,BLOB:o});return uid}serializeBlob(o){this.Write(this.createBlob(o))}asyncSerializeBlobs(stateObj){var item1,obj;if(stateObj.blobsCopy&&stateObj.blobsCopy.length>0&&(item1=stateObj.blobsCopy[++stateObj.currentIndex])){obj=new Infrastructure.JsonBlob,obj.FileName=item1.BLOB.name||item1.BLOB.filename||"",obj.MimeType=item1.BLOB.type,obj.Size=item1.BLOB.size,stateObj.useBlobIndex?(obj.BlobIndex=stateObj.currentIndex,stateObj.json=stateObj.json.replace(item1.UID,(new CalystoJsonSerializer).Serialize(obj)),this.asyncSerializeBlobs(stateObj)):Calysto.Utility.Blob.BlobToDataUrlAsync(item1.BLOB,dataUrl=>{obj.DataUrl=dataUrl,stateObj.json=stateObj.json.replace(item1.UID,(new CalystoJsonSerializer).Serialize(obj)),this.asyncSerializeBlobs(stateObj)})}else stateObj.onComplete(stateObj.json,stateObj.pureBlobs)}serializeWithJsonStringify(objectToSerialize){var _reDate=new RegExp("^[\\d]{4}[\\-][\\d]{2}[\\-][\\d]{2}T[\\d]{2}[\\:][\\d]{2}[\\:][\\d]{2}[\\.][\\d]{3}Z$");return JSON.stringify(objectToSerialize,(key,value)=>{var arr,n1;let vtype=typeof value;if(vtype=="undefined"||value==null){return null};if(vtype=="function"){return this.SerializeFunctions?this.createJsonFunction(value):value};if(value.constructor==window.FileList){for(arr=[],n1=0;n1<value.length;n1++){arr.push(value[n1])};return arr}return value.constructor==window.File?this.createBlob(value):value.constructor==window.Blob?this.createBlob(value):value.constructor==Calysto.DateTime?this.createJsonDateTime(value.ToSystemDate()):this.isDate(value)?this.createJsonDateTime(value):typeof value=="string"&&_reDate.test(value)?this.createJsonDateTime(new Date(value)):typeof value=="number"?isFinite(value)?value:null:this.isArray(value)?value:value&&value.ToArray?value.ToArray():value})}serializeWithCalysto(objectToSerialize,recursionLeft){var o=objectToSerialize,addComma,propName,value;let vtype=typeof o;if(vtype=="undefined"||o===null){return this.Write("null")};if(this.isArray(o)){return recursionLeft<1?this.Write("[...]"):this.encodeArray(o,recursionLeft-1)};if(o.constructor==Calysto.DateTime){return this.serializeDate(o.ToSystemDate())};if(o.constructor==window.FileList){this.encodeArray(o,recursionLeft-1)}else{if(o.constructor==window.File||o.constructor==window.Blob){return this.serializeBlob(o)};if(this.isDate(o)){return this.serializeDate(o)};if(vtype=="function"){return this.SerializeFunctions?this.serializeFunction(o):null};if(typeof o=="string"){return this.encodeString(o)};if(typeof o=="number"){return this.Write(isFinite(o)?String(o):"null")};if(typeof o=="boolean"){return this.Write(String(o))};if("ToArray"in o){return this.serializeWithCalysto(o.ToArray(),recursionLeft-1)};if(recursionLeft<1){return this.Write("{...}")};this.Write("{");for(propName in o){try{if(!o.hasOwnProperty(propName)){continue};value=o[propName]}catch(e111){continue}(typeof value!="function"||this.SerializeFunctions)&&(addComma&&this.Write(","),this.serializeWithCalysto(propName,recursionLeft-1),this.Write(":"),value===null||typeof value=="undefined"||value==NaN?this.Write("null"):this.serializeWithCalysto(value,recursionLeft-1),addComma=true)}return this.Write("}")}}serializeObject(objectToSerialize,recursionLimit){if(window.JSON&&!recursionLimit){return this.serializeWithJsonStringify(objectToSerialize)};this.serializeWithCalysto(objectToSerialize,recursionLimit);return this.parts.join("")}SerializeAsync(objectToSerialize,recursionLimit,useBlobIndex,onComplete){var json=this.serializeObject(objectToSerialize,recursionLimit),arr1=[];useBlobIndex&&this.blobs.length>0&&Calysto.Collections.ForEach(this.blobs,item=>arr1.push(item.BLOB)),this.asyncSerializeBlobs({currentIndex:-1,json:json,pureBlobs:arr1,blobsCopy:this.blobs.slice(0),useBlobIndex:useBlobIndex,onComplete:onComplete})}Serialize(objectToSerialize,recursionLimit=100){return this.serializeObject(objectToSerialize,recursionLimit)}}Infrastructure.CalystoJsonSerializer=CalystoJsonSerializer})(Infrastructure=Json.Infrastructure||(Json.Infrastructure={}))})(Json=Calysto.Json||(Calysto.Json={}))}(Calysto||(Calysto={})),function(Calysto){var Json;(function(Json){var Infrastructure;(function(Infrastructure){class CalystoJsonReader{constructor(json,blobsArray){this.json=json,this.blobsArray=blobsArray,this.index=-1,this.escapee=Infrastructure.escapeeChars}Error(m){throw new Error("JSON Error: "+m+", position: "+this.index+", json: "+this.json);}Next(c1){c1&&c1!==this.currchar&&this.Error("Expected '"+c1+"' instead of '"+this.currchar+"'"),this.currchar=this.json.charAt(this.index),this.index++;return this.currchar}Number(){let str1="";for(this.currchar=="-"&&(str1="-",this.Next("-"));this.currchar>="0"&&this.currchar<="9";){str1+=this.currchar,this.Next()};if(this.currchar=="."){for(str1+=".";this.Next()&&this.currchar>="0"&&this.currchar<="9";){str1+=this.currchar}};if(this.currchar=="e"||this.currchar=="E"){for(str1+=this.currchar,this.Next(),(this.currchar=="-"||this.currchar=="+")&&(str1+=this.currchar,this.Next());this.currchar>="0"&&this.currchar<="9";){str1+=this.currchar,this.Next()}};let value=+str1;if(isFinite(value)){return value};this.Error("Bad number");return null}String(){var hex,i,value="",uffff;if(this.currchar=='"'){while(this.Next()){if(this.currchar=='"'){this.Next();return value}if(this.currchar=="\\"){if(this.Next(),this.currchar=="u"){for(uffff=0,i=0;i<4;i+=1){if(hex=parseInt(this.Next(),16),!isFinite(hex)){break};uffff=uffff*16+hex}value+=String.fromCharCode(uffff)}else if(this.currchar&&typeof this.escapee[this.currchar]=="string"){value+=this.escapee[this.currchar]}else break}else value+=this.currchar}}this.Error("Bad string");return}White(){while(this.currchar&&this.currchar<=" "){this.Next()}}Word(){switch(this.currchar){case"t":this.Next("t"),this.Next("r"),this.Next("u"),this.Next("e");return true;case"f":this.Next("f"),this.Next("a"),this.Next("l"),this.Next("s"),this.Next("e");return false;case"n":this.Next("n"),this.Next("u"),this.Next("l"),this.Next("l");return null}this.Error("Unexpected '"+this.currchar+"'");return}Array(){let arr=[];if(this.currchar=="["){if(this.Next("["),this.White(),this.currchar=="]"){this.Next("]");return arr}while(this.currchar){if(arr.push(this.Value()),this.White(),this.currchar=="]"){this.Next("]");return arr}this.Next(","),this.White()}}this.Error("Bad array");return}Object(){var key,obj={};if(this.currchar=="{"){if(this.Next("{"),this.White(),this.currchar=="}"){this.Next("}");return obj}while(this.currchar){if(key=this.String(),this.White(),this.Next(":"),Object.hasOwnProperty.call(obj,key)&&this.Error("Duplicate key '"+key+"'"),obj[key]=this.Value(),this.White(),this.currchar=="}"){this.Next("}");return obj}this.Next(","),this.White()}}this.Error("Bad object");return}Value(){this.White();switch(this.currchar){case"{":var obj1=this.Object();obj1=Json.fnJsonPostConvertObject(obj1,this.blobsArray);return obj1;case"[":return this.Array();case'"':return this.String();case"-":return this.Number();default:return this.currchar>="0"&&this.currchar<="9"?this.Number():this.Word()}}Parse(){var result;this.index=0,this.currchar=" ",result=this.Value(),this.White(),this.currchar&&this.Error("Syntax error");return result}}Infrastructure.CalystoJsonReader=CalystoJsonReader})(Infrastructure=Json.Infrastructure||(Json.Infrastructure={}))})(Json=Calysto.Json||(Calysto.Json={}))}(Calysto||(Calysto={})),function(Calysto){var Json;(function(Json){function fnJsonDeserialize(jsonString,blobsArray){if(typeof jsonString=="string"&&!!jsonString){return window.JSON?JSON.parse(jsonString,(key,value)=>value?fnJsonPostConvertObject(value,blobsArray):value):new Json.Infrastructure.CalystoJsonReader(jsonString,blobsArray).Parse()}}function fnJsonPostConvertObject(obj,blobsArray){if(!obj){return obj};switch(obj.__calystotype){case"Calysto_Date":return Date.FromLocalISOTString(obj.Date);case"Calysto_Blob":let blob=obj;if(blob.DataUrl){return Calysto.Utility.Blob.DataUrlToBlob(blob.DataUrl,blob.FileName)};if(blob.BlobIndex===0||blob.BlobIndex>0){var data1=(blobsArray||[]).Where(o=>o.blobIndex==blob.BlobIndex).pop();if(!data1){throw new Error("Blob not found at index: "+blob.BlobIndex);}return data1}return blob;case"Calysto_Function":return Calysto.Utility.Expressions.CompileLambdaNoReturnCheck(obj.Function);default:return obj}}function SerializeAsync(objectToSerialize,recursionLimit,useBlobIndex,onComplete){new Json.Infrastructure.CalystoJsonSerializer(true).SerializeAsync(objectToSerialize,recursionLimit,useBlobIndex,onComplete)}function Serialize(objectToSerialize,recursionLimit=100){return new Json.Infrastructure.CalystoJsonSerializer(false).Serialize(objectToSerialize,recursionLimit)}function Deserialize(jsonString,blobsArray){return fnJsonDeserialize(jsonString,blobsArray)}Json.fnJsonPostConvertObject=fnJsonPostConvertObject,Calysto.Core.ExportGlobal(fnJsonPostConvertObject,"fnJsonPostConvertObject"),Json.SerializeAsync=SerializeAsync,Json.Serialize=Serialize,Json.Deserialize=Deserialize})(Json=Calysto.Json||(Calysto.Json={}))}(Calysto||(Calysto={})),function(Calysto){var Json;(function(Json){let NodeTypeEnum;(function(NodeTypeEnum){NodeTypeEnum[NodeTypeEnum.PrimitiveValue=1]="PrimitiveValue",NodeTypeEnum[NodeTypeEnum.KeyValue=2]="KeyValue",NodeTypeEnum[NodeTypeEnum.ArrayValue=3]="ArrayValue"})(NodeTypeEnum=Json.NodeTypeEnum||(Json.NodeTypeEnum={}));const ROOT_PROPERTY="@",_reNum=new RegExp("^[\\d]+$");class JsonNode{constructor(value,parent,propertyOrIndex){typeof propertyOrIndex=="number"?(this.Index=propertyOrIndex,this.Property=propertyOrIndex+""):this.Property=typeof propertyOrIndex=="string"?propertyOrIndex:ROOT_PROPERTY,this.Level=parent?parent.Level+1:0,this.Type=this.ResolveType(value),this.Value=value,parent&&(this.Parent=parent)}ResolveType(item){let vtype=typeof item;return vtype=="undefined"||item===null||vtype=="function"||vtype=="string"||vtype=="number"||vtype=="boolean"?NodeTypeEnum.PrimitiveValue:item&&typeof item.pop=="function"||"ToArray"in item?NodeTypeEnum.ArrayValue:NodeTypeEnum.KeyValue}Children(includeCurrent=false){return new Calysto.CalystoEnumerable(()=>Calysto.CalystoEnumerator.From(function*(__this){if(includeCurrent){yield __this};if(__this.Type==NodeTypeEnum.ArrayValue){let index1=-1;while(++index1<__this.Value.length){yield new JsonNode(__this.Value[index1],__this,index1)}}else if(__this.Type==NodeTypeEnum.KeyValue){let index1=-1,props1=Calysto.Collections.GetOwnProperties(__this.Value);while(++index1<props1.length){yield new JsonNode(__this.Value[props1[index1]],__this,props1[index1])}}}(this)))}Descendants(includeCurrent=false){return new Calysto.CalystoEnumerable(()=>Calysto.CalystoEnumerator.From(function*(__this){if(includeCurrent){yield __this};for(let child1 of __this.Children().AsIterableIterator()){yield child1;for(let child2 of child1.Descendants().AsIterableIterator()){yield child2}}}(this)))}Ancestors(includeCurrent=false){return new Calysto.CalystoEnumerable(()=>Calysto.CalystoEnumerator.From(function*(__this){if(includeCurrent){yield __this};let current1=__this;while(!!(current1=current1.Parent)){yield current1}}(this)))}Root(){let curr1=this;while(curr1.Parent&&(curr1=curr1.Parent));return curr1}SelectChain(path){return new Calysto.CalystoEnumerable(()=>Calysto.CalystoEnumerator.From(function*(__this){let properties=path.split("."),node=__this,prop;while(!!(prop=properties.shift())){if(node){if(prop==ROOT_PROPERTY){node=node.Root();yield node}else if(prop===""){if(node=node.Parent,!node){break}else yield node}else if(node=node.Children().Where(o=>o.Property==prop).FirstOrDefault(),!node){break}else yield node}else break}}(this)))}}Json.JsonNode=JsonNode})(Json=Calysto.Json||(Calysto.Json={}))}(Calysto||(Calysto={})),function(Calysto){var Json;(function(Json_1){var BinaryFrame;(function(BinaryFrame){function DeserializeWorker(arrayBuffer,onComplete){for(var item,data,blob,tocLength=Calysto.Utility.CalystoTools.ByteArrayToLong(new Uint8Array(arrayBuffer.slice(0,_headerSizeBytes))),tocJson=Calysto.Utility.Encoding.UTF8.GetString(new Uint8Array(arrayBuffer.slice(_headerSizeBytes,_headerSizeBytes+tocLength))),toc=Calysto.Json.Deserialize(tocJson),mainJson="",blobsArray=[],offsetStart=_headerSizeBytes+tocLength,n1=0;n1<toc.Items.length;n1++){item=toc.Items[n1],data=new Uint8Array(arrayBuffer.slice(offsetStart,offsetStart+item.Size)),item.IsJson?mainJson=Calysto.Utility.Encoding.UTF8.GetString(data):(blob=Calysto.Utility.Blob.CreateBlob([data],item.MimeType),blob.filename=item.FileName,blob.blobIndex=item.BlobIndex,blobsArray.push(blob)),offsetStart+=item.Size};onComplete(Calysto.Json.Deserialize(mainJson,blobsArray))}function DeserializeAsync(binaryData,onComplete){if(binaryData&&window.ArrayBuffer&&binaryData.constructor==ArrayBuffer){DeserializeWorker(binaryData,onComplete)}else if(typeof binaryData=="string"){onComplete(Calysto.Json.Deserialize(binaryData))}else if(binaryData&&window.Blob&&binaryData.constructor==Blob){var rr=new FileReader;rr.onload=function(res){DeserializeWorker(res.currentTarget.result,onComplete)},rr.readAsArrayBuffer(binaryData)}else throw new Error("Current binaryData type is not supported");}function CreateBinaryFrame(json,blobsArray){var toc={Items:[]},blob,jsonData,n1,finalBlob;for(blobsArray=blobsArray||[],n1=0;n1<blobsArray.length;n1++){blob=blobsArray[n1],toc.Items.push({Size:blob.size,FileName:blob.filename,MimeType:blob.type,BlobIndex:blob.blobIndex||n1,IsJson:false})};jsonData=Calysto.Utility.Encoding.UTF8.GetBytes(json),toc.Items.push({Size:jsonData.length,FileName:null,MimeType:"application/json",BlobIndex:null,IsJson:true});var tocJson=Calysto.Json.Serialize(toc),tocBytes=Calysto.Utility.Encoding.UTF8.GetBytes(tocJson),tocLengthBytes=Calysto.Utility.CalystoTools.LongToByteArray(tocBytes.length).slice(0,4),finalArr=[];for(finalArr.push(new Uint8Array(tocLengthBytes)),finalArr.push(new Uint8Array(tocBytes)),n1=0;n1<blobsArray.length;n1++){finalArr.push(blobsArray[n1])};finalArr.push(new Uint8Array(jsonData)),finalBlob=Calysto.Utility.Blob.CreateBlob(finalArr,"application/octet-stream");return finalBlob}function SerializeAsync(obj,onComplete){Calysto.Json.SerializeAsync(obj,100,true,(json,blobsArray)=>{onComplete(new BinaryFrameItem(json||"",blobsArray||[]))})}var _headerSizeBytes=4;BinaryFrame.DeserializeAsync=DeserializeAsync,BinaryFrame.SerializeAsync=SerializeAsync;class BinaryFrameItem{constructor(Json,Blobs){this.Json=Json,this.Blobs=Blobs}ToBinaryData(){return CreateBinaryFrame(this.Json,this.Blobs)}}BinaryFrame.BinaryFrameItem=BinaryFrameItem})(BinaryFrame=Json_1.BinaryFrame||(Json_1.BinaryFrame={}))})(Json=Calysto.Json||(Calysto.Json={}))}(Calysto||(Calysto={})),function(Calysto){function GetTitle(iconName){switch(iconName){case"error":return Calysto.Resources.CalystoLang.Error;case"warning":return Calysto.Resources.CalystoLang.Warning;case"info":return Calysto.Resources.CalystoLang.Information;case"question":return Calysto.Resources.CalystoLang.Question;case"success":return Calysto.Resources.CalystoLang.Success;default:return Calysto.Resources.CalystoLang.Message}}function GetFAIconClass(iconName){switch(iconName){case"success":return"fa-check-circle";case"error":return"fa-times-circle";case"warning":return"fa-exclamation-triangle";case"info":return"fa-info-circle";case"question":return"fa-question-circle";default:return""}}function GetWindowIconClass(iconName){switch(iconName){case"success":return"calystoWindowIconGreen";case"error":return"calystoWindowIconRed";case"warning":return"calystoWindowIconOrange";case"info":return"calystoWindowIconBlue";case"question":return"calystoWindowIconOrange";default:return""}}let CloseMode;(function(CloseMode){CloseMode.destroy="destroy",CloseMode.hide="hide"})(CloseMode=Calysto.CloseMode||(Calysto.CloseMode={}));let DialogButton;(function(DialogButton){DialogButton.XClose="XClose",DialogButton.Yes="Yes",DialogButton.No="No",DialogButton.Cancel="Cancel",DialogButton.Close="Close"})(DialogButton=Calysto.DialogButton||(Calysto.DialogButton={}));let DesingModeEnum;(function(DesingModeEnum){DesingModeEnum[DesingModeEnum.Windows=0]="Windows",DesingModeEnum[DesingModeEnum.Modern=1]="Modern"})(DesingModeEnum||(DesingModeEnum={}));let _html=`<div class="themeAero calystoDialogControl calystoDialogModal">
	<div class="calystoDialogMask"></div>
	<div class="calystoDialogBoxContainer">
		<div class="calystoDialogBox">
				
			<div class="calystoWindow">
				<div class="calystoWindowTitle">
					
					<div class="calystoWindowTitleText element1">Alert</div>

					<label class="calystoWindowXMark fa fa-close" style="display: none;">
						<button class="calystoXCloseButton" calysto_button_name="${DialogButton.XClose}" style="position: absolute; width: 1px; height: 1px; opacity: 0;"></button>
					</label>
				</div>
				<div class="calystoTopContainer element2" style="display:none">
					<div class="calystoWindowTd1">
						<div class="calystoWindowIcon fa fa-info-circle" style="display:none"></div>
					</div>
					<div class="calystoWindowTitleText">Alert</div>
				</div>
				<div class="calystoWindowContent" style="min-width: 250px; min-height: 50px;">
					<table class="calystoWindowTable1 calystoWindowInnerContent" cellpadding="0" cellspacing="0">
						<tbody>
							<tr>
								<td class="calystoWindowTd1 element3">
									<div class="calystoWindowIcon fa fa-info-circle" style="display:none"></div>
								</td>
								<td class="calystoWindowTd2">
								</td>
							</tr>
						</tbody>
					</table>
				</div>
				<div class="calystoWindowButtons calystoThemeContainer" style="display:none"></div>
			</div>
		
		</div>
	</div>
</div>`,OverflowHelper;(function(OverflowHelper){function GetScrollElement(){for(let el of[document.documentElement,document.body]){if(el.scrollHeight>el.clientHeight||el.scrollWidth>el.clientWidth){return el}};return undefined}function CreateOverflow(){if(!_hasOverflow){_hasOverflow=true,$$calysto(document.body).RemoveClass(_calystoOverflowHidden),_paddings=null;let el=GetScrollElement();if(el){_paddings={};let w1=el.clientWidth,h1=el.clientHeight;$$calysto(document.body).AddClass(_calystoOverflowHidden);let w2=el.clientWidth,h2=el.clientHeight;w2>w1&&(_paddings.paddingRight=document.body.style.paddingRight||"",document.body.style.paddingRight=w2-w1+"px"),h2>h1&&(_paddings.paddingBottom=document.body.style.paddingBottom||"",document.body.style.paddingBottom=h2-h1+"px")}}}function RemoveOverflow(){(_hasOverflow=false,_paddings)&&($$calysto(document.body).RemoveClass(_calystoOverflowHidden),document.body.style.paddingRight=_paddings.paddingRight||"",document.body.style.paddingBottom=_paddings.paddingBottom||"")}let _calystoOverflowHidden="calystoOverflowHidden",_hasOverflow=false,_paddings;OverflowHelper.CreateOverflow=CreateOverflow,OverflowHelper.RemoveOverflow=RemoveOverflow})(OverflowHelper||(OverflowHelper={}));let DialogIcon;(function(DialogIcon){DialogIcon.info="info",DialogIcon.error="error",DialogIcon.warning="warning",DialogIcon.question="question",DialogIcon.success="success",DialogIcon.none="none"})(DialogIcon=Calysto.DialogIcon||(Calysto.DialogIcon={}));let DialogMode;(function(DialogMode){DialogMode[DialogMode.Alert=0]="Alert",DialogMode[DialogMode.Panel=1]="Panel"})(DialogMode=Calysto.DialogMode||(Calysto.DialogMode={})),Calysto.GetFAIconClass=GetFAIconClass;let _zIndex=1e6,_dialogsStack=[],_hasEscEvent=false;class Dialog{constructor(){this._closeMode="destroy",this._viewMode=DialogMode.Alert,this._designMode=DesingModeEnum.Windows,this.OnButtonClick=(new Calysto.MulticastDelegate).AsFunc(this),this.OnShown=(new Calysto.MulticastDelegate).AsFunc(this),this.OnClosing=(new Calysto.MulticastDelegate).AsFunc(this),this.OnClosed=(new Calysto.MulticastDelegate).AsFunc(this),this._buttons=[],this.Initialize()}Initialize(){var el=document.createElement("div"),$$dialogEl;el.innerHTML=_html,this._dialogControlEl=el.childNodes[0],this._dialogControlEl.__calystoDialog=this,$$dialogEl=$$calysto(this._dialogControlEl),this._dialogControlEl.style.zIndex=_zIndex+++"",this._maskEl=$$dialogEl.Query("//.calystoDialogMask").First(),this._dialogBoxContainerEl=$$dialogEl.Query("//.calystoDialogBoxContainer").First(),this._dialogBoxEl=$$dialogEl.Query("//.calystoDialogBox").First(),this._windowEl=$$dialogEl.Query("//.calystoWindow").First();let $windowEl=$$calysto(this._windowEl);this._xButtonEl=$windowEl.Query("//.calystoWindowXMark").First(),this._titleEl=$windowEl.Query("//.calystoWindowTitle").First(),this._contentEl=$windowEl.Query("//.calystoWindowContent").First(),this._innerContentEl=$windowEl.Query("//.calystoWindowInnerContent").First(),this._tdContentEl=$windowEl.Query("//.calystoWindowTd2").First(),this._buttonsEl=$windowEl.Query("//.calystoWindowButtons").First(),this._topContainer=$windowEl.Query("//.calystoTopContainer").First()}GetDialogEl(){return this._dialogControlEl}GetContentEl(){return this._contentEl}PrefferedWidth(prefferedWidth){$$calysto(this._dialogBoxEl).ApplyStyle(`width:100%;max-width:${prefferedWidth}px;`);return this}Set(cb){cb(this);return this}DesignMode(mode){this._designMode=mode,$$calysto(this._windowEl).AddClass("calystoWindow2",mode==DesingModeEnum.Modern);return this}RenderTitle(title){let showTitle=false;this._viewMode==DialogMode.Panel?showTitle=false:this._designMode==DesingModeEnum.Windows?showTitle=!String.IsNullOrWhiteSpace(title):this._designMode==DesingModeEnum.Modern&&(showTitle=!String.IsNullOrWhiteSpace(this._titleText)),$$calysto(this._dialogControlEl).Query("//.calystoWindowTitleText").SetProperty("innerHTML",title||"").SetVisible(showTitle);return this}Title(title){this._titleText=title;return this.RenderTitle(title)}Icon(iconName){this._iconName=iconName,this._titleText||this.RenderTitle(GetTitle(iconName));let showIcon=!!this._iconName&&this._iconName!="none";$$calysto(this._windowEl).AddClass("calystoShowIcon",showIcon);let cls1="calystoWindowIcon fa "+GetFAIconClass(this._iconName)+" "+GetWindowIconClass(this._iconName);$$calysto(this._windowEl).Query("//.calystoWindowTd1/div").SetVisible(showIcon).SetClass(cls1);return this}CloseMode(mode){this._closeMode=mode;return this}fnButtonClickHandler(sender,ev){let name=typeof sender=="string"?sender:sender.getAttribute("calysto_button_name");name==DialogButton.XClose?this.Close():this.OnButtonClick.Invoke(f=>f(this,name,ev))}HideButtons(){$$calysto([this._buttonsEl,this._xButtonEl]).SetVisible(false);return this}ButtonXClose(){return this.Button(DialogButton.XClose)}Button(name,isDefault){let item={name:name,isDefault:!!isDefault,isRendered:false};this._buttons.push(item),item.isRendered=true;let btnEl;item.name==DialogButton.XClose?btnEl=$$calysto(this._dialogControlEl).Query("//.calystoWindowXMark").SetVisible(true).Query("/button").First():$$calysto(this._buttonsEl).SetVisible(true).AddChildren(btnEl=Calysto.DomQuery.CreateElement("button").AddClass("calystoBtn").SetAttribute("calysto_button_name",item.name).SetInnerHtml(item.name).First()),item.isDefault&&(this._focusButtonEl=btnEl),$$calysto(btnEl).OnClick((s,e)=>this.fnButtonClickHandler(s,e));return this}AppendContent(content){content&&content.nodeType>0||typeof content=="string"&&content.match(new RegExp("(<[^>/\\s]+/>)|(<\/[^>/\\s]+>)"))?$$calysto(this._tdContentEl).AddChildren(content):$$calysto(this._tdContentEl).AddChildren(Calysto.DomQuery.CreateElement("pre").AddClass("calystoWindowPre").SetInnerHtml(Calysto.Utility.Html.HtmlEncodeSimple(content)));return this}Content(content){this._tdContentEl.innerHTML="";return this.AppendContent(content)}MaskOpacity(value){$$calysto(this._maskEl).SetOpacity(value);return this}Background(value){$$calysto(this._windowEl).ApplyStyle("background",value);return this}Close(){this.OnClosing.Invoke(f=>f(this)),this._intervalId&&(clearInterval(this._intervalId),this._intervalId=null),_dialogsStack.Remove(this),$$calysto(this._dialogControlEl).RemoveClass("showDialog").Sleep(400,q=>{q.SetVisible(false),this._closeMode=="destroy"&&q.RemoveFromDom(),this.OnClosed.Invoke(f=>f(this)),_dialogsStack.Any()||this._viewMode!=DialogMode.Panel||OverflowHelper.RemoveOverflow()})}AutoClose(delayMs){delayMs>0&&setTimeout(()=>this.Close(),delayMs);return this}fnFixPosition(){var hspace;if(this._viewMode!=DialogMode.Panel&&this._viewMode==DialogMode.Alert){var margin=10,viewport=Calysto.Utility.Dom.GetViewportDiv(),maxContentWidth=viewport.clientWidth-margin*2,minContentWidth=Math.min(maxContentWidth,400),maxContentHeight=viewport.clientHeight-margin*2-this._titleEl.offsetHeight-this._buttonsEl.offsetHeight-this._topContainer.offsetHeight;this._contentEl.style.overflowX=this._innerContentEl.offsetWidth>maxContentWidth?"scroll":"",this._contentEl.style.overflowY=this._innerContentEl.offsetHeight>maxContentHeight?"scroll":"",this._contentEl.style.maxWidth=maxContentWidth+"px",this._contentEl.style.maxHeight=maxContentHeight+"px",this._contentEl.style.minWidth=minContentWidth+"px",this._windowEl.style.maxWidth=maxContentWidth+"px",hspace=Math.round((viewport.clientHeight-2*margin-this._dialogBoxEl.offsetHeight)*.2),hspace>margin||(hspace=margin),this._dialogBoxEl.style.top=hspace+"px"}}fnFirstTimeInit(){if(!this._initDone){if(this._initDone=true,(document.body||document.documentElement).appendChild(this._dialogControlEl),this._viewMode==DialogMode.Panel){$$calysto(this._titleEl).SetVisible(false),this._topContainer.style.display="none",this._dialogBoxEl.style.padding="20px 5px",this._dialogBoxContainerEl.style.overflowY="scroll",this._dialogBoxContainerEl.style.overflowX="auto",this._dialogBoxContainerEl.style.bottom="0",setTimeout(()=>{this._dialogBoxContainerEl.scrollTop=0,this._dialogBoxContainerEl.scrollLeft=0},1)}else if(this._viewMode==DialogMode.Alert){var handler=new Calysto.Utility.Dom.ScrollHandler;$$calysto([this._dialogBoxContainerEl]).On(["scroll","mousewheel","wheel","DOMMouseScroll"],(sender,ev)=>{handler.HandleScroll(this._contentEl,ev);return false})}}}fnShowWorker(){this.fnFirstTimeInit(),this._intervalId||this._viewMode!=DialogMode.Alert||(this._intervalId=setInterval(()=>this.fnFixPosition(),1e3)),$$calysto(this._dialogControlEl).SetVisible(true),setTimeout(()=>$$calysto(this._dialogControlEl).AddClass("showDialog"),5);let dtStart1=Date.now(),interval1=setInterval(()=>{this.fnFixPosition(),Date.now()-dtStart1>400&&clearInterval(interval1)},10);this._focusButtonEl&&this._focusButtonEl.focus(),this.OnShown.Invoke(f=>f(this))}CloseOnMaskClick(){if(this._closeOnMaskAssigned){return this};this._closeOnMaskAssigned=true,$$calysto([this._maskEl,this._dialogBoxContainerEl,this._windowEl]).OnMouseDown((sender,ev)=>{if(Calysto.Event.IsLeftMouseButton(ev)&&Calysto.Event.GetTarget(ev)==sender){this.fnButtonClickHandler(DialogButton.XClose,ev);return false}return undefined});return this}CloseOnEscKey(){this._closeOnEscKey=true;return this}ViewMode(mode){this._viewMode=mode;return this}Show(){_hasEscEvent||(_hasEscEvent=true,Calysto.Page.OnEscKey(()=>{let dd=_dialogsStack[_dialogsStack.length-1];dd&&dd._closeOnEscKey&&dd.fnButtonClickHandler(DialogButton.XClose,{})})),this.fnShowWorker(),_dialogsStack.push(this),this._viewMode==DialogMode.Panel&&OverflowHelper.CreateOverflow();return this}}Calysto.Dialog=Dialog}(Calysto||(Calysto={})),function(Calysto){var Dialog;(function(Dialog){function FindDialog(childEl){return $$calysto(childEl).AncestorNodes().Select(o=>o.__calystoDialog).Where(o=>!!o).FirstOrDefault()}function ShowVersionExpired(){if(!Calysto.Page.IsPageReloading&&!Calysto.Page.IsVersionExpiredVisible){Calysto.Page.IsVersionExpiredVisible=true;return(new Calysto.Dialog).Content(Calysto.Resources.CalystoLang.JavascriptEngineIsOutdatedInformation).Icon("warning").Button(Calysto.Resources.CalystoLang.Reload).Button(Calysto.Resources.CalystoLang.Cancel).ButtonXClose().OnButtonClick((dialog,name)=>{Calysto.Page.IsVersionExpiredVisible=false,dialog.Close(),name==Calysto.Resources.CalystoLang.Reload&&(document.documentElement.className+=" calystoAjaxLoading",(new Calysto.Dialog).Content(Calysto.Resources.CalystoLang.PageIsReloadingPleaseWait).Icon("info").Show(),Calysto.Page.IsPageReloading=true,setTimeout(()=>window.location.reload(true),1))}).Show()}}function CreateInformation(msg,title){return(new Calysto.Dialog).Title(title).Icon("info").Content(msg).ButtonXClose().CloseOnEscKey()}function CreateDialogImpl(msg,iconName,title){return(new Calysto.Dialog).Title(title).Icon(iconName||"info").Content(msg).ButtonXClose().Button(Calysto.Resources.CalystoLang.Close).CloseOnEscKey().OnButtonClick(dialog=>{dialog.Close()})}function CreateConfirm(msg,title){return(new Calysto.Dialog).Title(title).Icon("question").Content(msg).ButtonXClose().CloseOnEscKey().CloseOnMaskClick()}function CreateAlert(msg,iconName,title){return CreateDialogImpl(msg,iconName,title)}function CreateError(msg,title){return CreateDialogImpl(msg,"error",title)}function CreateWarning(msg,title){return CreateDialogImpl(msg,"warning",title)}function CreateSuccess(msg,title){return CreateDialogImpl(msg,"success",title)}function CreatePanel(){return(new Calysto.Dialog).CloseOnEscKey().CloseOnMaskClick().ViewMode(Calysto.DialogMode.Panel)}Dialog.FindDialog=FindDialog,Dialog.ShowVersionExpired=ShowVersionExpired,Dialog.CreateInformation=CreateInformation,Dialog.CreateConfirm=CreateConfirm,Dialog.CreateAlert=CreateAlert,Dialog.CreateError=CreateError,Dialog.CreateWarning=CreateWarning,Dialog.CreateSuccess=CreateSuccess,Dialog.CreatePanel=CreatePanel})(Dialog=Calysto.Dialog||(Calysto.Dialog={}))}(Calysto||(Calysto={})),function(Calysto){let NotifyHPosition;(function(NotifyHPosition){NotifyHPosition.center="center",NotifyHPosition.right="right",NotifyHPosition.left="left"})(NotifyHPosition=Calysto.NotifyHPosition||(Calysto.NotifyHPosition={}));let NotifyVPosition;(function(NotifyVPosition){NotifyVPosition.bottom="bottom",NotifyVPosition.top="top"})(NotifyVPosition=Calysto.NotifyVPosition||(Calysto.NotifyVPosition={}));let _zIndex=2e6;class Notification{constructor(text){this.VPosition="top",this.HPosition="center",this.Icon="info",this.PrefferedWidth=500,this.AutoCloseMs=3e3,this._template=`<div class= 'calystoNotify2 hiddeNotifBox' >
	<div class='calystoNotifyInner'>
		<div class='calystoNotifyContent'>
			<table cellpadding='0' cellspacing='0'>
				<tr>
					<td class='tdIcon'><span class='calystoNotifyIcon'></span></td>
					<td class='calystoTextContent' style='width:100%'></td>
					<td class='tdBtnClose'><span class='calystoCloseBtn fa fa-times'></span></td>
				</tr>
			</table>
		</div>
	</div>
</div>`,this.Text=text}Set(fn){fn(this);return this}EnsureContainer(){let selector=".calystoNotifyContainer."+this.VPosition+"."+this.HPosition;if(this._containerEl=$$calysto(selector).FirstOrDefault(),!this._containerEl){let class1=selector.ReplaceAll("."," ").Trim();this._containerEl=Calysto.DomQuery.CreateElement("div").AddClass(class1).AddAsChildrenTo(document.body).FirstOrDefault(),this._containerEl.style.zIndex=_zIndex+""}}EnsureNotif(){if(!this._notifBoxEl){let $$=Calysto.DomQuery.FromHtml(this._template);this._notifBoxEl=$$.FirstOrDefault(),this._notifInnerEl=$$.Query("//.calystoNotifyInner").FirstOrDefault(),this._notifContentEl=$$.Query("//.calystoNotifyContent").AddClass(this.Icon).FirstOrDefault(),this._notifTextEl=$$.Query("//.calystoTextContent").FirstOrDefault();let iconCls="fa "+Calysto.GetFAIconClass(this.Icon);this._notifIconEl=$$.Query("//.calystoNotifyIcon").AddClass(iconCls).FirstOrDefault(),this._notifCloseBtnEl=$$.Query("//.calystoCloseBtn").FirstOrDefault(),this._notifCloseBtnEl.onclick=()=>this.Hide()}}Show(){setTimeout(()=>{this.EnsureContainer(),this.EnsureNotif(),this._containerEl.style.maxWidth=this.PrefferedWidth+"px",this._notifTextEl.innerHTML=this.Text,this.VPosition=="top"?$$calysto(this._containerEl).InsertChildren(this._notifBoxEl):this.VPosition=="bottom"&&$$calysto(this._containerEl).AddChildren(this._notifBoxEl),this._notifBoxEl.style.height="1px",$$calysto(this._notifBoxEl).RemoveClass("hiddeNotifBox"),this._notifBoxEl.style.height=this._notifInnerEl.offsetHeight+"px",this.AutoCloseMs>0&&setTimeout(()=>this.Hide(),this.AutoCloseMs)},1);return this}Hide(){setTimeout(()=>{$$calysto(this._notifBoxEl).AddClass("hiddeNotifBox").Sleep(1500,sender=>sender.RemoveFromDom())},1)}static Create(text,icon="info",autoCloseMs=3e3,vPosition="top",hPosition="center"){return new Calysto.Notification(text).Set(n=>n.Icon=icon).Set(n=>n.AutoCloseMs=autoCloseMs).Set(n=>n.VPosition=vPosition).Set(n=>n.HPosition=hPosition)}}Calysto.Notification=Notification}(Calysto||(Calysto={})),function(Calysto){var Net;(function(Net){let HttpStatusCode;(function(HttpStatusCode){HttpStatusCode[HttpStatusCode.Continue=100]="Continue",HttpStatusCode[HttpStatusCode.SwitchingProtocols=101]="SwitchingProtocols",HttpStatusCode[HttpStatusCode.Processing=102]="Processing",HttpStatusCode[HttpStatusCode.EarlyHints=103]="EarlyHints",HttpStatusCode[HttpStatusCode.OK=200]="OK",HttpStatusCode[HttpStatusCode.Created=201]="Created",HttpStatusCode[HttpStatusCode.Accepted=202]="Accepted",HttpStatusCode[HttpStatusCode.NonAuthoritativeInformation=203]="NonAuthoritativeInformation",HttpStatusCode[HttpStatusCode.NoContent=204]="NoContent",HttpStatusCode[HttpStatusCode.ResetContent=205]="ResetContent",HttpStatusCode[HttpStatusCode.PartialContent=206]="PartialContent",HttpStatusCode[HttpStatusCode.MultiStatus=207]="MultiStatus",HttpStatusCode[HttpStatusCode.AlreadyReported=208]="AlreadyReported",HttpStatusCode[HttpStatusCode.IMUsed=226]="IMUsed",HttpStatusCode[HttpStatusCode.Ambiguous=300]="Ambiguous",HttpStatusCode[HttpStatusCode.MultipleChoices=300]="MultipleChoices",HttpStatusCode[HttpStatusCode.Moved=301]="Moved",HttpStatusCode[HttpStatusCode.MovedPermanently=301]="MovedPermanently",HttpStatusCode[HttpStatusCode.Found=302]="Found",HttpStatusCode[HttpStatusCode.Redirect=302]="Redirect",HttpStatusCode[HttpStatusCode.RedirectMethod=303]="RedirectMethod",HttpStatusCode[HttpStatusCode.SeeOther=303]="SeeOther",HttpStatusCode[HttpStatusCode.NotModified=304]="NotModified",HttpStatusCode[HttpStatusCode.UseProxy=305]="UseProxy",HttpStatusCode[HttpStatusCode.Unused=306]="Unused",HttpStatusCode[HttpStatusCode.RedirectKeepVerb=307]="RedirectKeepVerb",HttpStatusCode[HttpStatusCode.TemporaryRedirect=307]="TemporaryRedirect",HttpStatusCode[HttpStatusCode.PermanentRedirect=308]="PermanentRedirect",HttpStatusCode[HttpStatusCode.BadRequest=400]="BadRequest",HttpStatusCode[HttpStatusCode.Unauthorized=401]="Unauthorized",HttpStatusCode[HttpStatusCode.PaymentRequired=402]="PaymentRequired",HttpStatusCode[HttpStatusCode.Forbidden=403]="Forbidden",HttpStatusCode[HttpStatusCode.NotFound=404]="NotFound",HttpStatusCode[HttpStatusCode.MethodNotAllowed=405]="MethodNotAllowed",HttpStatusCode[HttpStatusCode.NotAcceptable=406]="NotAcceptable",HttpStatusCode[HttpStatusCode.ProxyAuthenticationRequired=407]="ProxyAuthenticationRequired",HttpStatusCode[HttpStatusCode.RequestTimeout=408]="RequestTimeout",HttpStatusCode[HttpStatusCode.Conflict=409]="Conflict",HttpStatusCode[HttpStatusCode.Gone=410]="Gone",HttpStatusCode[HttpStatusCode.LengthRequired=411]="LengthRequired",HttpStatusCode[HttpStatusCode.PreconditionFailed=412]="PreconditionFailed",HttpStatusCode[HttpStatusCode.RequestEntityTooLarge=413]="RequestEntityTooLarge",HttpStatusCode[HttpStatusCode.RequestUriTooLong=414]="RequestUriTooLong",HttpStatusCode[HttpStatusCode.UnsupportedMediaType=415]="UnsupportedMediaType",HttpStatusCode[HttpStatusCode.RequestedRangeNotSatisfiable=416]="RequestedRangeNotSatisfiable",HttpStatusCode[HttpStatusCode.ExpectationFailed=417]="ExpectationFailed",HttpStatusCode[HttpStatusCode.MisdirectedRequest=421]="MisdirectedRequest",HttpStatusCode[HttpStatusCode.UnprocessableEntity=422]="UnprocessableEntity",HttpStatusCode[HttpStatusCode.Locked=423]="Locked",HttpStatusCode[HttpStatusCode.FailedDependency=424]="FailedDependency",HttpStatusCode[HttpStatusCode.UpgradeRequired=426]="UpgradeRequired",HttpStatusCode[HttpStatusCode.PreconditionRequired=428]="PreconditionRequired",HttpStatusCode[HttpStatusCode.TooManyRequests=429]="TooManyRequests",HttpStatusCode[HttpStatusCode.RequestHeaderFieldsTooLarge=431]="RequestHeaderFieldsTooLarge",HttpStatusCode[HttpStatusCode.UnavailableForLegalReasons=451]="UnavailableForLegalReasons",HttpStatusCode[HttpStatusCode.InternalServerError=500]="InternalServerError",HttpStatusCode[HttpStatusCode.NotImplemented=501]="NotImplemented",HttpStatusCode[HttpStatusCode.BadGateway=502]="BadGateway",HttpStatusCode[HttpStatusCode.ServiceUnavailable=503]="ServiceUnavailable",HttpStatusCode[HttpStatusCode.GatewayTimeout=504]="GatewayTimeout",HttpStatusCode[HttpStatusCode.HttpVersionNotSupported=505]="HttpVersionNotSupported",HttpStatusCode[HttpStatusCode.VariantAlsoNegotiates=506]="VariantAlsoNegotiates",HttpStatusCode[HttpStatusCode.InsufficientStorage=507]="InsufficientStorage",HttpStatusCode[HttpStatusCode.LoopDetected=508]="LoopDetected",HttpStatusCode[HttpStatusCode.NotExtended=510]="NotExtended",HttpStatusCode[HttpStatusCode.NetworkAuthenticationRequired=511]="NetworkAuthenticationRequired"})(HttpStatusCode=Net.HttpStatusCode||(Net.HttpStatusCode={}))})(Net=Calysto.Net||(Calysto.Net={}))}(Calysto||(Calysto={})),function(Calysto){var Net;(function(Net){class WebClient{constructor(url){this.url=url,this.timeoutMs=9e4,this.responseType="text",this.async=true,Calysto.Core.Constants.WebClientGlobalTimeout>0&&(this.timeoutMs=Calysto.Core.Constants.WebClientGlobalTimeout)}static IsCrossdomain(url){if(url&&(url.indexOf("//")==0&&(url=location.protocol+url),url.indexOf("http")==0)){var origin=location.protocol+"//"+location.hostname;return url.indexOf(origin)!=0}return false}static GetXMLHttpRequest(url){var axO,i;if(window.XMLHttpRequest){return new XMLHttpRequest};if(WebClient.IsCrossdomain(url)&&window.XDomainRequest){return new window.XDomainRequest};if(window.ActiveXObject){for(axO=["Microsoft.XMLHTTP","Msxml2.XMLHTTP","Msxml2.XMLHTTP.6.0","Msxml2.XMLHTTP.4.0","Msxml2.XMLHTTP.3.0"],i=0;i<axO.length;i++){try{return new window.ActiveXObject(axO[i])}catch(e){}}}return null}SetTimeout(timeoutMs){this.timeoutMs=timeoutMs;return this}SetUrl(url){this.url=url;return this}SetAsync(isAsync){this.async=!!isAsync}CreateData(httpMethod,content,uploadType,fileName){return{content:content,fileName:fileName,uploadType:uploadType||"text/plain",httpMethod:httpMethod||"GET",formData:false}}CreateNameValue(name,value){return{name:name+"",value:value+""}}UploadDictionary(dic){var arr=[];Calysto.Collections.ForEachOwnProperties(dic,(name,value)=>arr.push(encodeURIComponent(name+"")+"="+encodeURIComponent(value+""))),this.data=this.CreateData("POST",arr.join("&"),"application/x-www-form-urlencoded");return this}UploadString(str){this.data=this.CreateData("POST",str,"text/plain");return this}UploadJson(json){this.data=this.CreateData("POST",json,"application/json");return this}UploadData(data){this.data=this.CreateData("POST",data,"multipart/form-data"),this.data.formData=true;return this}UploadHtmlForm(form,appendKeys){if(window.FormData){let f1=new FormData(form);if(appendKeys){for(let kv of appendKeys){f1.append(kv.Key,kv.Value)}};this.data=this.CreateData(form.method,f1,form.enctype),this.data.formData=true}else{let dic1=Calysto.Forms.FormSerialize(form);if(appendKeys){for(let kv of appendKeys){dic1[kv.Key]=kv.Value}};this.UploadDictionary(dic1)}return this}UploadFile(file,fileName){this.data=this.CreateData("POST",file,"multipart/form-data",fileName||file.name);return this}SetResponseType(typeString){this.responseType=typeString||"";return this}AddRequestHeader(name,value){this.headers||(this.headers=[]),this.headers.push(this.CreateNameValue(name,value));return this}Abort(){this.isAborted=true,this.xhr&&(this.xhr.abort(),this.xhr=null);return this}Start(){var _safeThis,timeoutId,isComplete,data;if(this.isAborted||this.isStarted){return this};if(this.isStarted=true,this.xhr=WebClient.GetXMLHttpRequest(this.url),_safeThis=this,this.xhr.onabort=function(){console.log({abort:_safeThis.xhr.getAllResponseHeaders()})},timeoutId=NaN,isComplete=false,this.timeoutMs>0&&(timeoutId=setTimeout(()=>{if(!isComplete){isComplete=true,_safeThis.xhr.abort();var ss=_safeThis.GetLiistenersItem("OnTimeout");ss&&ss.callbacks.ForEach(fn=>fn(_safeThis,{type:"timeout",bubles:false}))}},this.timeoutMs)),Calysto.Collections.ForEachOwnProperties(this.listeners,(name,obj)=>{var xhrOrUpload=obj.isUpload?_safeThis.xhr.upload:_safeThis.xhr;xhrOrUpload&&(obj.fullName=="OnLoad"?xhrOrUpload.onreadystatechange=ev=>{if(xhrOrUpload.readyState==4&&!isComplete){ev=ev||{type:"load"},isComplete=true,clearTimeout(timeoutId);var ss=_safeThis.GetLiistenersItem("OnLoad");ss&&ss.callbacks.ForEach(fn=>fn(_safeThis,ev))}}:xhrOrUpload["on"+obj.eventName]=ev=>{if(!isComplete){ev=ev||{type:obj.eventName},(ev.type=="abort"||ev.type=="error"||ev.type=="timeout")&&(isComplete=true);var ss=_safeThis.GetLiistenersItem(obj.fullName);ss&&ss.callbacks.ForEach(fn=>fn(_safeThis,ev))}})}),data=this.data||{},data.formSubmit){data.formSubmit.action=this.url,data.formSubmit.submit();return this}if(this.xhr.open(data.httpMethod||"GET",this.url,this.async),this.xhr.timeout=this.timeoutMs,data.uploadType&&(window.FormData?this.xhr.contentType=data.uploadType:this.xhr.setRequestHeader("Content-Type",data.uploadType)),data.fileName&&this.xhr.setRequestHeader("x-calysto-filename",data.fileName),this.responseType&&(this.xhr.responseType=this.responseType),this.headers&&this.headers.ForEach(item=>this.xhr.setRequestHeader(item.name,item.value)),"content"in data){let content=data.content;typeof content=="function"&&(content=content()),this.xhr.send(content)}else this.xhr.send();return this}GetResponseText(){return this.xhr?this.xhr.responseText:""}GetResponse(){if(this.xhr){return this.xhr.response}}GetLiistenersItem(fullName){return this.listeners[fullName]}AddCallback(fullName,func){var item,isUpload,evName;if(this.isStarted){throw new Error("Request started, can't assign callback: "+fullName);}this.listeners||(this.listeners={}),item=this.GetLiistenersItem(fullName),item||(isUpload=fullName.StartsWith("OnUpload"),evName=isUpload?fullName.substr(8).toLowerCase():fullName.substr(2).toLowerCase(),item={isUpload:isUpload,eventName:evName,fullName:fullName,callbacks:[]},this.listeners[fullName]=item),item.callbacks.push(func);return this}OnUploadAbort(func){return this.AddCallback("OnUploadAbort",func)}OnUploadError(func){return this.AddCallback("OnUploadError",func)}OnUploadLoad(func){return this.AddCallback("OnUploadLoad",func)}OnUploadProgress(func){return this.AddCallback("OnUploadProgress",func)}OnUploadTimeout(func){return this.AddCallback("OnUploadTimeout",func)}OnReadyStateChange(func){return this.AddCallback("OnReadyStateChange",func)}OnAbort(func){return this.AddCallback("OnAbort",func)}OnError(func){return this.AddCallback("OnError",func)}OnLoad(func){return this.AddCallback("OnLoad",func)}OnProgress(func){return this.AddCallback("OnProgress",func)}OnTimeout(func){return this.AddCallback("OnTimeout",func)}}Net.WebClient=WebClient})(Net=Calysto.Net||(Calysto.Net={}))}(Calysto||(Calysto={})),function(Calysto){var Net;(function(Net){function Log(msg){console.log(Date.now(),msg)}class CalystoWebSocket{constructor(virtualPath){this.virtualPath=virtualPath,this.OnOpen=(new Calysto.MulticastDelegate).AsFunc(this),this.OnClose=(new Calysto.MulticastDelegate).AsFunc(this),this.OnError=(new Calysto.MulticastDelegate).AsFunc(this),this.OnMessage=(new Calysto.MulticastDelegate).AsFunc(this),this.isSending=false}Open(callbackOpened){if(Calysto.Core.IsDebugDefined&&Log("#WebSocket: "+(this.ws?this.ws.readyState:"not initialized")),this.ws&&this.ws.readyState==WebSocket.OPEN){callbackOpened&&callbackOpened(this)}else if(!this.ws||this.ws.readyState!=WebSocket.CONNECTING){var url=this.virtualPath;url.indexOf("//")>0||(url=(window.location.protocol=="https:"?"wss:":"ws:")+"//"+window.location.host+this.virtualPath);try{this.ws=new WebSocket(url),this.ws.binaryType="arraybuffer"}catch(ex1){}this.ws.onmessage=ev=>{ev.data&&this.OnMessage.Any()&&Calysto.Json.BinaryFrame.DeserializeAsync(ev.data,obj=>{Calysto.Core.IsDebugDefined&&Log({"#SOCKET_RECEIVED":obj}),this.OnMessage.Invoke(item=>item(obj))})},this.ws.onclose=()=>{Calysto.Core.IsDebugDefined&&Log("#WebSocket closed"),this.OnClose.Invoke(item=>item())},this.ws.onerror=()=>{Calysto.Core.IsDebugDefined&&Log("#WebSocket error"),this.OnError.Invoke(item=>item("#WebSocket error"))},this.ws.onopen=()=>{Calysto.Core.IsDebugDefined&&Log("#WebSocket opened"),this.OnOpen.Invoke(item=>item()),callbackOpened&&callbackOpened(this)}}}SendWorker(){var obj;this.sendQueue&&(obj=this.sendQueue.shift())?(this.isSending=true,Calysto.Json.BinaryFrame.SerializeAsync(obj,binaryFrame=>{Calysto.Core.IsDebugDefined&&Log({"#SOCKET_SEND":obj});var finalBlob=binaryFrame.ToBinaryData();this.ws.send(finalBlob),this.SendWorker()})):this.isSending=false}Send(obj){this.sendQueue||(this.sendQueue=[]),this.sendQueue.push(obj),this.isSending||this.Open(()=>this.SendWorker());return this}IsOpened(){return!!(this.ws&&this.ws.readyState==WebSocket.OPEN)}Close(){this.ws&&this.ws.close();return this}}Net.CalystoWebSocket=CalystoWebSocket})(Net=Calysto.Net||(Calysto.Net={}))}(Calysto||(Calysto={})),function(Calysto){var Net;(function(Net){var WebService;(function(WebService){class AjaxServiceClientBase{constructor(){this.OnAbort=(new Calysto.MulticastDelegate).OnInvoke(msg=>{this.SetValue("OnAbort",msg)}).OnAdd(fn=>this.TryInvokeValue("OnAbort",fn)).AsFunc(this),this.OnError=(new Calysto.MulticastDelegate).OnInvoke(err=>{this.SetValue("OnError",err)}).OnAdd(fn=>this.TryInvokeValue("OnError",fn)).AsFunc(this),this.OnProgress=(new Calysto.MulticastDelegate).OnInvoke(ev=>{this.SetValue("OnProgress",ev)}).OnAdd(fn=>this.TryInvokeValue("OnProgress",fn)).AsFunc(this),this.OnEnd=(new Calysto.MulticastDelegate).OnInvoke(()=>{this.SetValue("OnEnd",true)}).OnAdd(fn=>this.TryInvokeValue("OnEnd",fn)).AsFunc(this),this._values={}}Abort(){this.OnAbort.Invoke(f=>f("abort"));return this}SetValue(name,value){this._values[name]=value}TryInvokeValue(name,fn){name in this._values&&fn(this._values[name])}}WebService.AjaxServiceClientBase=AjaxServiceClientBase;class AjaxServiceClientVoid extends AjaxServiceClientBase{constructor(){super(...arguments),this.OnSuccess=(new Calysto.MulticastDelegate).OnInvoke(()=>{this.SetValue("OnSuccess",true)}).OnAdd(fn=>this.TryInvokeValue("OnSuccess",fn)).AsFunc(this),this.OnResponse=(new Calysto.MulticastDelegate).OnInvoke(container=>{this.SetValue("OnResponse",container)}).OnAdd(fn=>this.TryInvokeValue("OnResponse",fn)).AsFunc(this)}}WebService.AjaxServiceClientVoid=AjaxServiceClientVoid;class AjaxServiceClientWithReturn extends AjaxServiceClientBase{constructor(){super(...arguments),this.OnSuccess=(new Calysto.MulticastDelegate).OnInvoke(resp=>{this.SetValue("OnSuccess",resp)}).OnAdd(fn=>this.TryInvokeValue("OnSuccess",fn)).AsFunc(this),this.OnResponse=(new Calysto.MulticastDelegate).OnInvoke(container=>{this.SetValue("OnResponse",container)}).OnAdd(fn=>this.TryInvokeValue("OnResponse",fn)).AsFunc(this)}}WebService.AjaxServiceClientWithReturn=AjaxServiceClientWithReturn})(WebService=Net.WebService||(Net.WebService={}))})(Net=Calysto.Net||(Calysto.Net={}))}(Calysto||(Calysto={})),function(Calysto){var Net;(function(Net){var WebService;(function(){})(WebService=Net.WebService||(Net.WebService={}))})(Net=Calysto.Net||(Calysto.Net={}))}(Calysto||(Calysto={})),function(Calysto){var Net;(function(Net){var WebService;(function(WebService){class WebSocketSession{constructor(settings,Socket){this.settings=settings,this.Socket=Socket,this.OnBroadcastMessage=(new Calysto.MulticastDelegate).AsFunc(this),this.OnError=(new Calysto.MulticastDelegate).AsFunc(this),this._pendingCallbacks=new Calysto.Dictionary,this.Socket.OnMessage(responseContainer=>this.HandleSocketMessage(responseContainer))}HandleSocketMessage(responseContainer){let isBroadcast=responseContainer.Method==Calysto.Constants.AppConstants.BroadcastMethodName,context=null;if(!isBroadcast&&responseContainer.ReferenceGuid){let refOut=new Calysto.BoxValue;this._pendingCallbacks.TryGetValue(responseContainer.ReferenceGuid,refOut)&&(this._pendingCallbacks.RemoveKey(responseContainer.ReferenceGuid),context=refOut.GetValue())}let isHandled=this.ProcessResponse(context,responseContainer);if(!isHandled){if(responseContainer.JavaScriptLO&&!responseContainer.IsJavaScriptLODone){responseContainer.IsJavaScriptLODone=true;let nodeLo=Calysto.ScriptLoader.LoadJS(responseContainer.JavaScriptLO);setTimeout(()=>nodeLo.parentNode.removeChild(nodeLo),200)}isBroadcast&&this.OnBroadcastMessage.Invoke(fn=>fn(responseContainer.ReturnedValue)),context&&(context.OnResponse.Invoke(f=>f(responseContainer)),context.OnSuccess.Invoke(f=>f(responseContainer.ReturnedValue)),context.OnEnd.Invoke())}}ProcessResponse(context,responseContainer){if(responseContainer.IsEngineExpired){this.Socket.Close(),WebService.EngineExpired();return true}if(Calysto.Page.IsPageReloading){return true};if(responseContainer.EchoMsg=="EchoServerRequest"){this.Socket.Send({ReferenceGuid:responseContainer.ReferenceGuid,EchoMsg:"EchoClientResponse"});return true}if(responseContainer.ExceptionMessage&&!responseContainer.IsExceptionMessageDone){if(responseContainer.IsExceptionMessageDone=true,context===null||context===void 0?void 0:context.OnError.Any()){if(context.OnError.Invoke(f=>f(responseContainer.ExceptionMessage)),Calysto.Core.IsDebugDefined){throw new Error("Socket Error: "+responseContainer.ExceptionMessage).AppendErrorDetails(responseContainer.ExceptionDetails,true);}}else if(this.OnError.Any()){if(this.OnError.Invoke(f=>f(responseContainer.ExceptionMessage)),Calysto.Core.IsDebugDefined){throw new Error("Socket Error: "+responseContainer.ExceptionMessage).AppendErrorDetails(responseContainer.ExceptionDetails,true);}}else throw new Error(responseContainer.ExceptionMessage).AppendErrorDetails(responseContainer.ExceptionDetails,true);return true}return false}OnMethodReturn(requestGuid,context){this._pendingCallbacks.Add(requestGuid,context)}}WebService.WebSocketSession=WebSocketSession})(WebService=Net.WebService||(Net.WebService={}))})(Net=Calysto.Net||(Calysto.Net={}))}(Calysto||(Calysto={})),function(Calysto){var Net;(function(Net){var WebService;(function(WebService){function Log(msg){Calysto.Core.IsDebugDefined&&console.log(Date.now(),msg)}function EngineExpired(){Calysto.Page&&Calysto.Page.OnVersionExpired&&Calysto.Page.OnVersionExpired.Any&&Calysto.Page.OnVersionExpired.Any()?Calysto.Page.OnVersionExpired.Invoke(f=>f()):Calysto.Page.IsPageReloading||(document.documentElement.className+=" calystoAjaxLoading",Calysto.Page.IsPageReloading=true,Calysto.Notification.Create(Calysto.Resources.CalystoLang.NewVersionFoundPageIsReloading,"warning",NaN,"top","center").Show(),setTimeout(()=>window.location.reload(true),1e3))}function CreateUrl(vpath,settings){return(vpath||"").replace("__calysto_method_name__",settings.method||"").replace("__calysto_ss__",settings.sstate?"1":"0").replace("__calysto_culture__",Calysto.Globalization.CultureInfo.CurrentCulture.Name).replace("__calysto_current_url__",Calysto.Utility.Encoding.Base64RndEncoder.EncodeToBase64String(window.location.pathname+window.location.search))}function CreateArgsObj(methodName,argsValues,argNames){for(var val,obj={},n=0;n<argNames.length;n++){if(val=argsValues[n],typeof val=="undefined"){val=null}else if(typeof val=="function"){throw new Error("Argument "+argNames[n]+" can not be an function in "+methodName+"("+argNames.join(", ")+")");}obj[argNames[n]]=val}return obj}function IsTriggeredByUserAction(){if(window.event&&"isTrusted"in window.event){if(event&&event.isTrusted&&(event.target||event.srcElement)){Calysto.Core.IsDebugDefined&&console.log("web service method invoked by user event: "+event.type);return true}if(Calysto.Core.IsDebugDefined){throw new Error("Event is null, not invoked in user event.");}}return false}function CreateFullStateObj(sender,state){let xhr=sender.xhr,contentType="";try{contentType=xhr.getResponseHeader("Content-type")}catch(ex11){}contentType||(contentType=xhr.contentType||(xhr.response||{}).type||"");var calystoType=xhr.getResponseHeader(Calysto.Constants.WsjsHeaderConstants.XTypeHeaderKey),state2=Object.assign(Object.assign({},state),{isErrorStatus:xhr.status<200||xhr.status>=300,contentType:contentType,isHtml:(contentType||"").indexOf("text/html")>=0,isJson:(contentType||"").indexOf("application/json")>=0,calystoType:calystoType});switch(xhr.responseType){case"arraybuffer":state2.arrayBuffer=xhr.response;break;case"blob":state2.blob=xhr.response;break;case"":case"text":state2.respTxt=xhr.responseText;break;default:throw new Error("ResponseType not supported: "+xhr.responseType);}return state2}function ReadArrayBuffer(state,onComplete){if(state.calystoType==Calysto.Constants.WsjsHeaderConstants.XTypeHeaderBinaryFrameValue){Calysto.Json.BinaryFrame.DeserializeAsync(state.arrayBuffer,finalObj=>{state.responseContainer=finalObj,onComplete()})}else if(state.respTxt=Calysto.Utility.Encoding.UTF8.GetString(new Uint8Array(state.arrayBuffer)),state.isHtml){state.errorText="Blob download failed",state.errorHtml=state.respTxt,onComplete()}else if(state.isJson){try{state.responseContainer=Calysto.Json.Deserialize(state.respTxt)}catch(e1){state.errorText="Blob download failed",state.errorDescription=state.respTxt}onComplete()}else state.errorText="Blob download failed",state.errorDescription=state.respTxt,onComplete()}function ProcessResponseContainer(responseContainer,state){if(state.fnResponseContainerCallback(responseContainer),responseContainer.IsEngineExpired){state.fnResponseEndCallback(),EngineExpired();return}if(Calysto.Page.IsPageReloading){state.fnResponseEndCallback();return}if(responseContainer.ExceptionMessage&&!responseContainer.IsExceptionMessageDone){responseContainer.IsExceptionMessageDone=true,state.fnResponseEndCallback(),state.fnErrorCallback(responseContainer.ExceptionMessage,responseContainer.ExceptionDetails,true);return}if(responseContainer.JavaScriptLO&&!responseContainer.IsJavaScriptLODone){responseContainer.IsJavaScriptLODone=true;let nodeLo=Calysto.ScriptLoader.LoadJS(responseContainer.JavaScriptLO);setTimeout(()=>nodeLo.parentNode.removeChild(nodeLo),200)}responseContainer.IsSuccessful&&state.fnReturnValueCallback(responseContainer.ReturnedValue),state.fnResponseEndCallback()}function ProcessResponse(state){Calysto.Core.IsDebugDefined&&Log({AJAX_RESPONSE:state.responseContainer}),state.errorText?(state.fnResponseEndCallback(),state.fnErrorCallback(state.errorText,{errorDescription:state.errorDescription,errorHtml:state.errorHtml},false)):state.responseContainer&&state.responseContainer.Type=="IWebServiceResponseContainer"?ProcessResponseContainer(state.responseContainer,state):(state.fnResponseEndCallback(),state.fnReturnValueCallback(state.responseContainer||state.errorText))}function AjaxResponseReceivedHandler(wclient,state1){var state,fnProcess11,rr;if(wclient.xhr.status==0){state1.fnResponseEndCallback();return}let loc1=wclient.xhr.getResponseHeader("location");if(loc1){location.assign(loc1);return}if(state=CreateFullStateObj(wclient,state1),state.isErrorStatus){state.errorText="Ajax response error #2 - error status received",state.errorDescription="xhr.status: "+wclient.xhr.status+"\r\nxhr.statusText: "+wclient.xhr.statusText+"\r\nxhr.resposeText:\r\n",fnProcess11=function(){state.isHtml?state.errorHtml=state.respTxt:state.errorDescription+=state.respTxt,ProcessResponse(state)},state.respTxt?fnProcess11():state.arrayBuffer?(state.respTxt=Calysto.Utility.Encoding.UTF8.GetString(new Uint8Array(state.arrayBuffer)),fnProcess11()):state.blob&&(rr=new FileReader,rr.onload=function(res){state.respTxt=Calysto.Utility.Encoding.UTF8.GetString(new Uint8Array(res.currentTarget.result)),fnProcess11()},rr.readAsArrayBuffer(state.blob))}else if(state.arrayBuffer){ReadArrayBuffer(state,function(){ProcessResponse(state)})}else if(state.blob){rr=new FileReader,rr.onload=function(res){state.arrayBuffer=res.currentTarget.result,ReadArrayBuffer(state,function(){ProcessResponse(state)})},rr.readAsArrayBuffer(state.blob)}else{try{state.isJson&&(state.responseContainer=Calysto.Json.Deserialize(state.respTxt))}catch(ex){state.errorText="Ajax response error #1 - invalid JSON string",state.errorDescription=ex+"\r\nRESPONSE:\r\n"+state.respTxt}ProcessResponse(state)}}WebService.Log=Log,WebService.EngineExpired=EngineExpired,WebService.CreateUrl=CreateUrl,WebService.CreateArgsObj=CreateArgsObj,WebService.IsTriggeredByUserAction=IsTriggeredByUserAction,WebService.CreateFullStateObj=CreateFullStateObj,WebService.ReadArrayBuffer=ReadArrayBuffer,WebService.ProcessResponseContainer=ProcessResponseContainer,WebService.ProcessResponse=ProcessResponse,WebService.AjaxResponseReceivedHandler=AjaxResponseReceivedHandler})(WebService=Net.WebService||(Net.WebService={}))})(Net=Calysto.Net||(Calysto.Net={}))}(Calysto||(Calysto={})),function(Calysto){var Net;(function(Net){var WebService;(function(WebService){class WebAjaxServiceHelper{constructor(namespace,url){if(this.namespace=namespace,this.vpath=Calysto.Utility.Encoding.Base64RndEncoder.DecodeBase64StringToString(url),this.ns=Calysto.DataBinder.GetValue(window,namespace),this.ns){throw new Error("Ajax namespace is already registered: "+namespace);}this.ns={},Calysto.DataBinder.SetValue(window,namespace,this.ns)}RegisterAjaxMethod(settings){if(this.ns[settings.method]){throw new Error("Ajax method is already registered: "+settings.method);}let _safeThis=this,ajaxMethod=function(){let funcSendArgs=arguments,servclient=new WebService.AjaxServiceClientWithReturn;if(settings.reque&&!WebService.IsTriggeredByUserAction()){return servclient};let jsObject=WebService.CreateArgsObj(settings.method,funcSendArgs,settings.argNames||[]),isAbortRequested=false;servclient.OnAbort(()=>{isAbortRequested=true});let isInvokedOnce=false,fnResponseEndCallback=function(){isInvokedOnce||(isInvokedOnce=true,settings.silent||Calysto.Page.OnEndResponse.Invoke(f=>f()),servclient.OnEnd.Invoke())},fnRequestStart=function(){settings.silent||Calysto.Page.OnBeginRequest.Invoke(f=>f())},fnReturnValueCallback=value=>servclient.OnSuccess.Invoke(f=>f(value)),fnResponseContainerCallback=container=>servclient.OnResponse.Invoke(f=>f(container)),fnErrorCallback=(errMsg,errDetails,isServerError)=>{if(servclient.OnError.Any()){if(servclient.OnError.Invoke(f=>f(errMsg)),Calysto.Core.IsDebugDefined){throw new Error(errMsg).AppendErrorDetails(errDetails,isServerError);}}else throw new Error(errMsg).AppendErrorDetails(errDetails,isServerError);};isAbortRequested||Calysto.Json.BinaryFrame.SerializeAsync(jsObject,binaryFrame=>{if(Calysto.Core.IsDebugDefined&&WebService.Log({AJAX_SEND:binaryFrame.Json,BLOBS:binaryFrame.Blobs,method:settings.method+"("+(settings.argNames||[]).join(", ")+")",jsObject:jsObject}),!isAbortRequested){let wclient=new Calysto.Net.WebClient("");servclient.OnAbort(()=>wclient.Abort());let url=WebService.CreateUrl(_safeThis.vpath,settings);if(settings.post||binaryFrame.Blobs.length>0||binaryFrame.Json.length>1e3){url=url.replace("__calysto_json_arg__",""),wclient.AddRequestHeader(Calysto.Constants.WsjsHeaderConstants.XTypeHeaderKey,Calysto.Constants.WsjsHeaderConstants.XTypeHeaderBinaryFrameValue);let blob1=binaryFrame.ToBinaryData();if(blob1&&blob1.size>0){wclient.UploadData(blob1)}else throw Error("Invalid blob, can not continue.");}else{let enc=Calysto.Utility.Encoding.Base64RndEncoder.EncodeToBase64String(binaryFrame.Json);url=url.replace("__calysto_json_arg__","&"+Calysto.Constants.CalystoAjaxHandlerConstants.AjaxGetParamName+"="+enc)}wclient.url=url,wclient.timeoutMs=settings.timeoutMs||wclient.timeoutMs,wclient.AddRequestHeader(Calysto.Constants.WsjsHeaderConstants.XAjaxHeaderKey,Calysto.Constants.WsjsHeaderConstants.XAjaxHeaderValue),wclient.responseType=typeof ArrayBuffer!="undefined"?"arraybuffer":"text";let fnWebClientLoadEnd=(sender,ev)=>{if(ev.type=="timeout"){fnResponseEndCallback(),fnErrorCallback("Ajax request timeout.");return}WebService.AjaxResponseReceivedHandler(wclient,{fnResponseContainerCallback,fnReturnValueCallback,fnErrorCallback,fnResponseEndCallback})},fnSendProgressEv=(sender,ev,isUpload)=>{let pp={};pp.IsComputable=!!ev.lengthComputable,pp.IsUpload=!!isUpload,pp.Loaded=ev.loaded,pp.Total=ev.total,ev.total>0&&(pp.Percent=ev.loaded/ev.total*100,pp.Percent>100&&(pp.Percent=100),servclient.OnProgress.Invoke(f=>f(pp)))},fnWebClientOnProgress=(sender,ev)=>fnSendProgressEv(sender,ev,false),fnWebClientOnUploadProgress=(sender,ev)=>fnSendProgressEv(sender,ev,true);if(wclient.OnLoad(fnWebClientLoadEnd),wclient.OnError(fnWebClientLoadEnd),wclient.OnTimeout(fnWebClientLoadEnd),wclient.OnAbort(fnWebClientLoadEnd),wclient.OnProgress(fnWebClientOnProgress),wclient.OnUploadProgress(fnWebClientOnUploadProgress),!isAbortRequested){if(fnRequestStart(),!wclient.async){throw new Error("Sync ajax request is not supported for web service");}wclient.Start()}}});return servclient};if(settings.method in _safeThis.ns){throw new Error("WebService error, method "+settings.method+" already exists in destination object.");}else _safeThis.ns[settings.method]=ajaxMethod;return this}}WebService.WebAjaxServiceHelper=WebAjaxServiceHelper})(WebService=Net.WebService||(Net.WebService={}))})(Net=Calysto.Net||(Calysto.Net={}))}(Calysto||(Calysto={})),function(Calysto){var Net;(function(Net){var WebService;(function(WebService){function CreateSocketMethod(_safeThis,settings,wss,vpath){return function(){let funcSendArgs=arguments;if(settings.reque&&!WebService.IsTriggeredByUserAction()){return null};let jsObject=WebService.CreateArgsObj(settings.method,funcSendArgs,settings.argNames||[]),requestGuid=Calysto.Mathm.NewGuid(),url=WebService.CreateUrl(vpath,settings).replace("__calysto_json_arg__",""),context=new WebService.AjaxServiceClientWithReturn;wss.OnMethodReturn(requestGuid,context),wss.Socket.Send({Method:settings.method,ReferenceGuid:requestGuid,RequestObj:{IsSocketWebClient:true,AjaxQueryString:url,AjaxArgs:jsObject}});return context}}class WebSocketSessionHelper{constructor(namespace,url){if(this.namespace=namespace,this.methods=[],this.ns=Calysto.DataBinder.GetValue(window,namespace),this.ns){throw new Error("Socket session type is already registered: "+namespace);}this.vpath=Calysto.Utility.Encoding.Base64RndEncoder.DecodeBase64StringToString(url);let _safeThis=this;this.ns=function(){let socket1=new Calysto.Net.CalystoWebSocket(WebService.CreateUrl(_safeThis.vpath,{method:"$"}).replace("__calysto_json_arg__","")),wss=new WebService.WebSocketSession({method:"RequestReceived"},socket1);for(let sett of _safeThis.methods){wss[sett.method]=CreateSocketMethod(_safeThis,sett,wss,_safeThis.vpath)};return wss},Calysto.DataBinder.SetValue(window,namespace,this.ns)}RegisterSocketMethod(settings){this.methods.push(settings);return this}}WebService.WebSocketSessionHelper=WebSocketSessionHelper})(WebService=Net.WebService||(Net.WebService={}))})(Net=Calysto.Net||(Calysto.Net={}))}(Calysto||(Calysto={})),function(Calysto){var Net;(function(Net){var WebService;(function(WebService){function CreateAjax(namespace,url){return new WebService.WebAjaxServiceHelper(namespace,url)}function CreateSocket(namespace,url){return new WebService.WebSocketSessionHelper(namespace,url)}WebService.CreateAjax=CreateAjax,WebService.CreateSocket=CreateSocket})(WebService=Net.WebService||(Net.WebService={}))})(Net=Calysto.Net||(Calysto.Net={}))}(Calysto||(Calysto={})),function(Calysto){class CallbackItem{ForRemoval(){return this.doCountExecutions&&this.executedCount>=this.executionsMax}}class MulticastDelegate{constructor(){this._asFuncCached=new Map,this.items=[],this.onAddHandlers=[],this.onInvokeHandlers=[]}OnAdd(func){this.onAddHandlers.push(func);return this}OnInvoke(func){this.onInvokeHandlers.push(func);return this}Add(delegate,executionsMax){var item=new CallbackItem;item.delegate=delegate,item.executedCount=0,executionsMax&&executionsMax>0&&(item.doCountExecutions=true,item.executionsMax=executionsMax),this.items.push(item),this.onAddHandlers.ForEach(f=>f(delegate));return this}Remove(delegate){let remove=this.items.Where(o=>o.delegate==delegate);remove.ForEach(o=>this.items.Remove(o));return this}AddOnce(delegate){return this.Add(delegate,1)}AddCount(executionsMax,delegate){return this.Add(delegate,executionsMax)}Invoke(action){for(let fn of this.onInvokeHandlers){action?action(fn):fn()};let doRemove=false;for(let item of this.items){item.ForRemoval()?doRemove=true:(action?action(item.delegate):item.delegate(),item.executedCount++)};doRemove&&(this.items=this.items.Where(o=>!o.ForRemoval()))}Any(){return this.items.Any()}Count(){return this.items.length}Clear(){this.items.Clear();return this}AsFunc(owner){if(!this._asFuncCached.has(owner)){var _safeThis=this,fnAdd=function(fnDelgate){_safeThis.Add(fnDelgate);return owner};Object.defineProperty(fnAdd,"MCD",{get:()=>_safeThis}),this.CopyFunction(fnAdd,"Invoke"),this.CopyFunction(fnAdd,"Any"),this._asFuncCached.set(owner,fnAdd)}return this._asFuncCached.get(owner)}CopyFunction(dest,name){dest[name]=this[name].BindContext(this)}}Calysto.MulticastDelegate=MulticastDelegate}(Calysto||(Calysto={})),function(Calysto){var Page;(function(Page){function ExecuteByEnumState(currState){for(let item of _items){!item.IsExecuted&&item.MinReadyState<=currState&&(item.IsExecuted=true,item.Func())}}function CheckReadyState(){if(window.document&&document.body){switch(document.readyState){case"interactive":setTimeout(()=>ExecuteByEnumState(ReadyStateEnum.Interactive),delay);break;case"complete":setTimeout(()=>ExecuteByEnumState(ReadyStateEnum.Complete),delay);return}}clearTimeout(_timeoutid),_timeoutid=setTimeout(CheckReadyState,delay)}function AddEvent(func,readyStateKind){var item=new PendingItem;item.Func=func,item.MinReadyState=readyStateKind,_items.push(item),_items=_items.OrderBy(o=>o.MinReadyState),CheckReadyState()}var _items,_aliveRequests,_isOnEscKeyEventAttached;let ReadyStateEnum;(function(ReadyStateEnum){ReadyStateEnum[ReadyStateEnum.Loading=2]="Loading",ReadyStateEnum[ReadyStateEnum.Interactive=3]="Interactive",ReadyStateEnum[ReadyStateEnum.Complete=4]="Complete"})(ReadyStateEnum||(ReadyStateEnum={}));class PendingItem{}_items=[];let _timeoutid,delay=window.FormData?10:200;Page.IsPageReloading=false,Page.IsVersionExpiredVisible=false,Page.OnLoadComplete=(new Calysto.MulticastDelegate).OnAdd(func=>{AddEvent(func,ReadyStateEnum.Complete)}).AsFunc(Calysto.Page),Page.OnLoading=(new Calysto.MulticastDelegate).AsFunc(Calysto.Page),_aliveRequests=0,Page.OnBeginRequest=(new Calysto.MulticastDelegate).Add(()=>{++_aliveRequests==1&&Page.OnLoading.Invoke(f=>f(true))}).AsFunc(Calysto.Page),Page.OnEndResponse=(new Calysto.MulticastDelegate).Add(()=>{--_aliveRequests<1&&(_aliveRequests=0,Page.OnLoading.Invoke(f=>f(false)))}).AsFunc(Calysto.Page),Page.OnInteractive=(new Calysto.MulticastDelegate).OnAdd(func=>{AddEvent(func,ReadyStateEnum.Interactive)}).Add(()=>{var _sys=window.Sys;typeof _sys!="undefined"&&_sys.WebForms&&_sys.WebForms.PageRequestManager&&(_sys.WebForms.PageRequestManager.getInstance().add_beginRequest(()=>Page.OnBeginRequest.Invoke(f=>f())),_sys.WebForms.PageRequestManager.getInstance().add_endRequest(()=>Page.OnEndResponse.Invoke(f=>f()))),Page.OnEndResponse.Invoke(f=>f())}).AsFunc(Calysto.Page),Page.OnUnhandledException=(new Calysto.MulticastDelegate).AsFunc(Calysto.Page),Page.OnVersionExpired=(new Calysto.MulticastDelegate).AsFunc(Calysto.Page),_isOnEscKeyEventAttached=false,Page.OnEscKey=(new Calysto.MulticastDelegate).OnAdd(()=>{_isOnEscKeyEventAttached||(_isOnEscKeyEventAttached=true,Calysto.Event.Attach(document,"keydown",ev=>{Calysto.Event.IsEscKey(ev)&&Page.OnEscKey.Invoke(f=>f())}))}).AsFunc(Calysto.Page)})(Page=Calysto.Page||(Calysto.Page={}))}(Calysto||(Calysto={})),function(Calysto){var Page;(function(Page){var Social;(function(Social){var Facebook;(function(Facebook){function fbCreateTagLoaderOnce(){(function(d,s,id){var localeStr=(Calysto.Globalization.CultureInfo.CurrentCulture.Name||"").replace("-","_"),js,fjs=d.getElementsByTagName(s)[0];d.getElementById(id)||(js=d.createElement(s),js.id=id,js.src="//connect.facebook.net/"+(localeStr||"en_US")+"/sdk.js",js.async="async",fjs&&fjs.parentNode&&fjs.parentNode.insertBefore(js,fjs))})(document,"script","facebook-jssdk")}function fbInitializeEngineAsync(){return __awaiter(this,void 0,void 0,function*(){return Calysto.Tasks.TaskUtility.RunAsync(state=>__awaiter(this,void 0,void 0,function*(){for(state.Watchdog(15e3),state.OnError(()=>state.NotifySuccess(null)),fbCreateTagLoaderOnce();!state.IsCancelled;){let _fbInstance=window.FB;if(_fbInstance&&_fbInstance.init&&_fbInstance.Event&&_fbInstance.Event.subscribe){state.NotifySuccess(_fbInstance);return}yield Calysto.Tasks.TaskUtility.SleepAsync(100)}}))})}class FacebookData{constructor(_fbInstance){this._fbInstance=_fbInstance}get FB(){return this._fbInstance}}class FacebookPromise{InitEngine(){return __awaiter(this,void 0,void 0,function*(){return Calysto.Tasks.TaskUtility.RunAsync(state=>__awaiter(this,void 0,void 0,function*(){let res=yield fbInitializeEngineAsync();res?(this.Data=new FacebookData(res),state.NotifySuccess(true)):state.NotifySuccess(false)}))})}InitApp(facebookAppId){return __awaiter(this,void 0,void 0,function*(){return Calysto.Tasks.TaskUtility.RunAsync(state=>{this.Data.FB.__fbInitDone!=facebookAppId&&(this.Data.FB.__fbInitDone=facebookAppId,this.Data.FB.init({appId:facebookAppId,xfbml:true,status:true,cookie:true,version:"v4.0"})),state.NotifySuccess(true)})})}Login(scope){return __awaiter(this,void 0,void 0,function*(){return Calysto.Tasks.TaskUtility.RunAsync(state=>{state.Watchdog(12e4);let scopes1=(scope||"").split(",").AsEnumerable().Select(o=>o.Trim()).Concat(["public_profile","email"]).Where(o=>!!o).Distinct().ToStringJoined(",");Calysto.Core.IsDebugDefined&&console.log("fb#before-login"),this.Data.FB.login(resp=>{this.Data.StatusReponse=resp,resp.status=="connected"?(Calysto.Core.IsDebugDefined&&console.log("fb#login-success"),state.NotifySuccess(true)):(Calysto.Core.IsDebugDefined&&console.log("fb#login-failed"),this.Error=resp.status,state.NotifySuccess(false))},{enable_profile_selector:true,return_scopes:true,scope:scopes1})})})}LoadProfile(){return __awaiter(this,void 0,void 0,function*(){Calysto.Core.IsDebugDefined&&console.log("fb#before-LoadProfile1");return Calysto.Tasks.TaskUtility.RunAsync(state=>{Calysto.Core.IsDebugDefined&&console.log("fb#before-LoadProfile2");try{this.Data.FB.api("/me",{fields:"id,name,gender,email,birthday,verified,picture,locale,link,first_name,last_name,age_range,hometown,photos"},resp=>{Calysto.Core.IsDebugDefined&&console.log("fb#loaded-LoadProfile"),this.Data.Profile=resp,state.NotifySuccess(true)})}catch(e1){this.Error=e1,state.NotifySuccess(false)}})})}LoadPicture(){return __awaiter(this,void 0,void 0,function*(){Calysto.Core.IsDebugDefined&&console.log("fb#before-LoadPicture1");return Calysto.Tasks.TaskUtility.RunAsync(state=>{Calysto.Core.IsDebugDefined&&console.log("fb#before-LoadPicture2");try{this.Data.FB.api("/me/picture",{redirect:false,height:300,width:300},resp=>{this.Data.Picture=resp,state.NotifySuccess(true)})}catch(e1){this.Error=e1,state.NotifySuccess(false)}})})}LoadPermissions(){return __awaiter(this,void 0,void 0,function*(){Calysto.Core.IsDebugDefined&&console.log("fb#before-LoadPermissions1");return Calysto.Tasks.TaskUtility.RunAsync(state=>{Calysto.Core.IsDebugDefined&&console.log("fb#before-LoadPermissions2");try{this.Data.FB.api("/me/permissions",resp=>{this.Data.Permissions=resp,state.NotifySuccess(true)})}catch(e1){this.Error=e1,state.NotifySuccess(false)}})})}}Facebook.FacebookPromise=FacebookPromise})(Facebook=Social.Facebook||(Social.Facebook={}))})(Social=Page.Social||(Page.Social={}))})(Page=Calysto.Page||(Calysto.Page={}))}(Calysto||(Calysto={})),function(Calysto){var Page;(function(Page){var Social;(function(Social){var Google;(function(Google){function fnCreateTagLoaderOnce(){(function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];d.getElementById(id)||(js=d.createElement(s),js.id=id,js.src="https://apis.google.com/js/platform.js",js.async="async",fjs&&fjs.parentNode&&fjs.parentNode.insertBefore(js,fjs))})(document,"script","google-platform")}function fnInitializeEngineAsync(){return __awaiter(this,void 0,void 0,function*(){return Calysto.Tasks.TaskUtility.RunAsync(state=>__awaiter(this,void 0,void 0,function*(){for(state.Watchdog(15e3),state.OnError(()=>state.NotifySuccess(false)),fnCreateTagLoaderOnce();!state.IsCancelled;){let _gapi=window.gapi;if(_gapi&&_gapi.load){state.NotifySuccess(true);return}yield Calysto.Tasks.TaskUtility.SleepAsync(100)}}))})}function fnExtractBasicProfileData(obj){return{Id:obj.getId(),Name:obj.getName(),GivenName:obj.getGivenName(),FamilyName:obj.getFamilyName(),ImageUrl:obj.getImageUrl(),Email:obj.getEmail()}}function fnCreateScopes(scope){return scope?_defaultScope+" "+scope:_defaultScope}class GoogleData{}let _defaultScope="https://www.googleapis.com/auth/userinfo.profile https://www.googleapis.com/auth/userinfo.email https://www.googleapis.com/auth/plus.me";class GooglePromise{InitEngine(){return __awaiter(this,void 0,void 0,function*(){return Calysto.Tasks.TaskUtility.RunAsync(state=>__awaiter(this,void 0,void 0,function*(){state.OnError(()=>state.NotifySuccess(false));let res=yield fnInitializeEngineAsync();res?(this.Data=new GoogleData,state.NotifySuccess(true)):state.NotifySuccess(false)}))})}InitApp(apiKey,clientId,scope){return __awaiter(this,void 0,void 0,function*(){return Calysto.Tasks.TaskUtility.RunAsync(state=>{if(state.Watchdog(15e3),state.OnError(()=>state.NotifySuccess(false)),window.gapi&&gapi.load&&gapi.auth2&&gapi.auth2.init){state.NotifySuccess(true);return}gapi.load("client:auth2",{callback:function(){gapi.client.init({apiKey:apiKey,clientId:clientId,scope:fnCreateScopes(scope)}).then(function(success){Calysto.Core.IsDebugDefined&&console.log({"google#success_LoadAuth2":success}),state.NotifySuccess(true)},function(error){Calysto.Core.IsDebugDefined&&console.log(error),state.NotifyError()})},onerror:function(error){state.NotifyError(error)}})})})}Login(){return __awaiter(this,void 0,void 0,function*(){return Calysto.Tasks.TaskUtility.RunAsync(state=>{state.Watchdog(12e4),state.OnError(()=>state.NotifySuccess(false)),Calysto.Core.IsDebugDefined&&console.log({"google#Login":this.Data}),gapi.auth2.getAuthInstance().signIn().then(success=>{Calysto.Core.IsDebugDefined&&console.log({"google#success-Login":success}),this.Data.GoogleUser=success,this.Data.Data={AuthResponse:success.getAuthResponse(),GrantedScopes:success.getGrantedScopes(),isSignedIn:success.isSignedIn(),UserId:success.getId()},state.NotifySuccess(true)},error=>{state.NotifyError(error)})})})}LoadProfile(){return __awaiter(this,void 0,void 0,function*(){return Calysto.Tasks.TaskUtility.RunAsync(state=>{state.Watchdog(15e3),state.OnError(()=>state.NotifySuccess(false)),Calysto.Core.IsDebugDefined&&console.log({"google#LoadProfile":this.Data}),this.Data.BasicProfile=fnExtractBasicProfileData(this.Data.GoogleUser.getBasicProfile()),state.NotifySuccess(true)})})}}Google.GooglePromise=GooglePromise})(Google=Social.Google||(Social.Google={}))})(Social=Page.Social||(Page.Social={}))})(Page=Calysto.Page||(Calysto.Page={}))}(Calysto||(Calysto={})),function(Calysto){var Page;(function(Page){var Google;(function(Google){class AnalyticsService{constructor(trackingId){this.trackingId=trackingId,this.gtag("js",new Date),Calysto.ScriptLoader.LoadJSFile("https://www.googletagmanager.com/gtag/js?id="+trackingId,true)}gtag(){let dataLayer=window.dataLayer=window.dataLayer||[];dataLayer.push(arguments)}HitPageView(pagePath){pagePath?this.gtag("config",this.trackingId,{page_path:pagePath}):this.gtag("config",this.trackingId);return this}}Google.AnalyticsService=AnalyticsService})(Google=Page.Google||(Page.Google={}))})(Page=Calysto.Page||(Calysto.Page={}))}(Calysto||(Calysto={})),function(Calysto){var Page;(function(Page){var Preloader;(function(Preloader){function Enable(delayMs=300){_delayMs=arguments.length==0?300:delayMs,_isEnabled=true,_timer||(_timer=(new Calysto.Timer).OnTimeout(()=>{_isLoading?Calysto.Utility.Dom.AddClass(document.documentElement,"calystoAjaxLoading"):Calysto.Utility.Dom.RemoveClass(document.documentElement,"calystoAjaxLoading")})),_hasPageEvent||(_hasPageEvent=true,Calysto.Page.OnLoading(isLoading=>{_isLoading=isLoading,_isEnabled&&_timer.Abort().Start(_isLoading?_delayMs:1)}))}function Disable(){_timer&&(_isEnabled=false,_isLoading=false,_timer.Abort().Start(1))}let _isLoading=false,_delayMs=300,_isEnabled=false,_timer,_hasPageEvent=false;Preloader.Enable=Enable,Preloader.Disable=Disable})(Preloader=Page.Preloader||(Page.Preloader={}))})(Page=Calysto.Page||(Calysto.Page={}))}(Calysto||(Calysto={})),function(Calysto){var Page;(function(Page){var Diagnostic;(function(Diagnostic){function sendElmahLog(errMsg,errDetails){var xmlhttp,items22,jsitems,obj,json,bb;if(errMsg&&!(errMsg.indexOf("Blocked a frame with origin")>=0)&&!(errMsg.indexOf("null is not an object (evaluating 'elt.parentNode')")>=0)){xmlhttp=Calysto.Net.WebClient.GetXMLHttpRequest(ServerUrl),xmlhttp.open("POST",ServerUrl,true),xmlhttp.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),xmlhttp.setRequestHeader(Calysto.Constants.WsjsHeaderConstants.XAjaxHeaderKey,Calysto.Constants.WsjsHeaderConstants.XExceptionHeaderValue);var pageHtml=(document.documentElement.innerHTML||"").substr(0,100),detailsFormated=errDetails,inputValues="";try{items22=$$calysto(document.documentElement).Query("//input, //select, //textarea").Select(el=>({tagName:el.tagName,type:el.type,calystoId:el.getAttribute(Calysto.AttrName.CalystoId),id:el.id,name:el.name,value:el.value})).ToArray(),inputValues=Calysto.Json.Serialize(items22,50)}catch(ex1){Calysto.Core.IsDebugDefined&&console.error(ex1),inputValues="*error, values can no be serialized*"}jsitems={location:{},screen:{},navigator:{}},Calysto.Collections.ForEachProperties(location,function(name,value){try{jsitems.location[name]=value}catch(e){}}),Calysto.Collections.ForEachProperties(screen,function(name,value){try{jsitems.screen[name]=value}catch(e){}}),Calysto.Collections.ForEachProperties(navigator,function(name,value){try{jsitems.navigator[name]=value}catch(e){}}),obj={calystoExObj:true,errMsg:errMsg,errDetails:detailsFormated,url:window.location.href,cookie:document.cookie,userAgent:navigator.userAgent,location:Calysto.Json.Serialize(jsitems.location),screen:Calysto.Json.Serialize(jsitems.screen),navigator:Calysto.Json.Serialize(jsitems.navigator),inputValues:inputValues},Calysto.Core.IsDebugDefined,json=Calysto.Json.Serialize(obj),bb=Calysto.Utility.Encoding.Base64RndEncoder.EncodeToBase64String(json),xmlhttp.send(bb)}}function ElmahLog(errMsg,errDetails){try{ServerUrl&&sendElmahLog(errMsg,errDetails)}catch(e1){if(Calysto.Core.IsDebugDefined){try{console.error(e1)}catch(e2){}}}}function fnFormatErrorEvent(ev){var calystoEx,details;let res={};try{calystoEx=ev&&ev.error&&ev.error.CalystoException?ev.error.CalystoException:undefined,res.IsServerError=!!(calystoEx&&calystoEx.IsServerError),details=[],res.IsServerError?(res.Message=calystoEx.Message,details.push(calystoEx.Details),res.HtmlDetails=calystoEx.HtmlDetails||""):(ev=ev||window.event)&&(res.Message=ev.message,res.FileName=ev.filename,res.LineNo=ev.lineno,res.ColNo=ev.colno,ev.error&&(res.Message=ev.error.message||ev.message,ev.message&&res.Message!=ev.message&&details.push(ev.message),ev.error.description&&ev.error.description!=res.Message&&details.push(ev.error.description)),details.push("filename: "+ev.filename),details.push("lineno: "+ev.lineno),ev.colno!=null&&details.push("colno: "+ev.colno),ev.error&&(res.Stack=(ev.error||{}).stack,res.Stack&&details.push("stack:\r\n"+res.Stack),ev.error&&calystoEx&&(details.push("-----------------------------"),details.push("CalystoException.Message:"),details.push(calystoEx.Message),details.push("CalystoException.Details:"),details.push(calystoEx.Details),res.HtmlDetails=calystoEx.HtmlDetails||""))),res.Details=details.join("\r\n")}catch(e1){}return res}function errorHandler(ev){var err,dialog;try{if(err=fnFormatErrorEvent(ev),!err||!err.Message){return};if(err&&!err.IsServerError&&err.FileName&&err.Message&&err.Stack){try{Calysto.Page.Diagnostic.ElmahLog(err.Message,err.Details)}catch(e6){}}try{Calysto.Page.OnUnhandledException.Invoke(f=>f(err.Message))}catch(e5){}if(Calysto.Core.IsDebugDefined){try{dialog=Calysto.Dialog.CreateError(err.Message+"\r\n\r\n"+err.Details,"DEBUG MODE - "+(err.IsServerError?"Server Exception":"Unhandled JS Exception")).Show(),err.HtmlDetails&&dialog.AppendContent(err.HtmlDetails)}catch(e5){}}}catch(e1){}}var ServerUrl=(Calysto.Core.Constants.ServerDiagnosticUrl||"").replace("=","://");Diagnostic.ElmahLog=ElmahLog,typeof ErrorEvent!="undefined"?window.addEventListener?window.addEventListener("error",errorHandler,true):window.attachEvent&&window.attachEvent("onerror",errorHandler,true):window.onerror=function(msg,file,line,column){errorHandler({colno:column||null,lineno:line,filename:file,message:msg,type:"error"})}})(Diagnostic=Page.Diagnostic||(Page.Diagnostic={}))})(Page=Calysto.Page||(Calysto.Page={}))}(Calysto||(Calysto={})),function(Calysto){var AjaxHistory;(function(AjaxHistory){function EnsureEvents(){_eventsDone||(_eventsDone=true,Calysto.Event.Attach(window,"popstate",ev=>RestoreState(ev.state)))}function ReplaceHistoryState(stateArray){var stateObj={isCalystoState:true,url:window.location.href,pathname:window.location.pathname,search:window.location.search,hash:window.location.hash,title:document.title,stateArray:stateArray};stateObj&&stateObj.isCalystoState&&window.history.replaceState&&(EnsureEvents(),window.history.replaceState(stateObj,stateObj.title,stateObj.url))}function RestoreState(stateObj){if(stateObj&&stateObj.isCalystoState&&stateObj.stateArray&&window.history.replaceState){document.title=stateObj.title;for(let n=0;n<stateObj.stateArray.length;n++){let obj=stateObj.stateArray[n];obj.selector&&$$calysto(obj.selector).SetInnerHtml(obj.html)}}}function CreateNewRandomHash(){window.location.hash="!x"+Date.now()+"-"+Math.floor(Math.random()*1e6)}function PushState(stateArray){let currentArr=[];for(let n=0;n<stateArray.length;n++){let sel1=stateArray[n].selector;if(!sel1){throw new Error("Error in AjaxHistory, selector is null");}currentArr.push({selector:sel1,html:$$calysto(sel1).SelectInnerHtml().FirstOrDefault()})}ReplaceHistoryState(currentArr);for(let n=0;n<stateArray.length;n++){$$calysto(stateArray[n].selector).SetInnerHtml(stateArray[n].html)};CreateNewRandomHash();let newArr=[];for(let n=0;n<stateArray.length;n++){let sel1=stateArray[n].selector;newArr.push({selector:sel1,html:$$calysto(sel1).SelectInnerHtml().FirstOrDefault()})}ReplaceHistoryState(newArr)}let _eventsDone=false;AjaxHistory.PushState=PushState})(AjaxHistory=Calysto.AjaxHistory||(Calysto.AjaxHistory={}))}(Calysto||(Calysto={})),function(Calysto){function GenerateUID(prefix){return(prefix||"uid")+(Math.random()+"").substr(2)+Date.now()}function EncodeDataObj(obj){return Calysto.Json.Serialize(obj)}function DecodeDataObj(obj){try{return Calysto.Json.Deserialize(obj)}catch(e){return null}}const __EchoTestMethod="__EchoTestMethod";class PostMessage{constructor(UID){this._listenersArr=[],this._funcBag={},this._uniqueUID=UID||GenerateUID("uid"),this._funcBag[__EchoTestMethod]=msg=>"received: "+msg,this.AddDistinctListener(window.parent),this.AddDistinctListener(window.opener),Calysto.Event.Attach(window,"message",ev=>this.HandleMessageEvent(ev))}AddDistinctListener(obj){if(obj&&obj!=window){for(var n1=0;n1<this._listenersArr.length;n1++){if(this._listenersArr[n1]==obj){return}};this._listenersArr.push(obj)}}EncapsulateFunc(funcRef){if(funcRef){for(var cnt=0,funcUid;cnt++<50&&(!(funcUid=GenerateUID("fn"))||this._funcBag[funcUid]););this._funcBag[funcUid]=funcRef;return funcUid}return null}RegisterMethod(funcName,funcRef){if(typeof funcName!="string"){throw Error("PostMessage.RegisterMethod argument funcName is not string");}if(typeof funcRef!="function"){throw Error("PostMessage.RegisterMethod argument funcRef is not function");}if(this._funcBag[funcName]){throw new Error("Method is already registerd in PostMessage.RegisterMethod: "+funcName);}this._funcBag[funcName]=funcRef;return this}InvokeMethod(destinationUID,funcName,sendValue,callbackFunc){for(var curr,tt=[destinationUID,funcName,sendValue],_ttNames=["destinationUID","funcName","arg"],n=0;n<tt.length;n++){if(typeof tt[n]=="function"){throw Error("PostMessage.InvokeMethod argument "+_ttNames[n]+" can not be function");}}if(callbackFunc&&typeof callbackFunc!="function"){throw Error("PostMessage.InvokeMethod argument callbackFunc is not function");}for(n=0;n<this._listenersArr.length;n++){(curr=this._listenersArr[n])&&curr!=window&&curr.postMessage(EncodeDataObj({senderUID:this._uniqueUID,destinationUID:destinationUID,funcName:funcName,argument:sendValue,callbackFuncName:this.EncapsulateFunc(callbackFunc)}),"*")};return this}Echo(destinationUID,msg,callbackFunc){return this.InvokeMethod(destinationUID,__EchoTestMethod,msg,callbackFunc)}HandleMessageEvent(ev){var dat1,func1,result;if(ev&&ev.data&&ev.type=="message"&&typeof ev.data=="string"&&(dat1=DecodeDataObj(ev.data))&&dat1.senderUID&&dat1.destinationUID&&(Calysto.Core.IsDebugDefined,dat1.destinationUID=="*"||dat1.destinationUID==this._uniqueUID)){if(this.AddDistinctListener(ev.source),dat1.funcName&&(func1=this._funcBag[dat1.funcName])){if(result=func1(dat1.argument,ev),dat1.isCallback){delete this._funcBag[dat1.funcName]}else if(ev&&ev.source&&dat1.callbackFuncName){let data1=EncodeDataObj({senderUID:this._uniqueUID,destinationUID:dat1.senderUID,funcName:dat1.callbackFuncName,isCallback:true,argument:result});ev.source.postMessage(data1,"*")}}else throw new Error("Error in PostMessage, function not registered: "+dat1.funcName);}}static FindIframe(arg){for(var iframes=document.getElementsByTagName("iframe"),ifr,n=0;n<iframes.length;n++){if((ifr=iframes[n])&&(ifr.contentWindow==arg.source||ifr.contentWindow==arg)){return ifr}};return null}}Calysto.PostMessage=PostMessage}(Calysto||(Calysto={})),function(Calysto){var Forms;(function(Forms){function SerializeElement(element){var fn,n,option,j,fnConvert,arr,n1;if(!(element&&element.tagName&&element.type)){return{}};var elementName=element.name,tagName=element.tagName.toUpperCase(),type=element.type.toLowerCase(),finalValue=null,attr=element.getAttribute(Calysto.AttrName.CalystoGetter);if(attr){fn=Calysto.Utility.Expressions.CompileLambdaExpression(attr),finalValue=fn.call(element,element)}else switch(tagName){case"INPUT":switch(type){case"checkbox":case"radio":if(element.checked){finalValue=element.value!="on"||element.getAttribute("value")?element.value:true}else return{};break;case"file":if(finalValue=[],element.files&&element.files[0]){for(n=0;n<element.files.length;n++){finalValue.push(element.files[n])}};break;default:finalValue=element.value}break;case"TEXTAREA":finalValue=element.value;break;case"SELECT":switch(element.type){case"select":case"select-one":finalValue=element.value;break;case"select-multiple":for(finalValue=[],j=0;j<element.options.length;j++){(option=element.options[j])&&option.selected&&finalValue.push(option.value)}}}let toType=element.getAttribute(Calysto.AttrName.CalystoType);if(toType){let destType=Calysto.Type.TypeDescriptor.FromTypeName(toType);if(!destType.IsValidKnownType){throw new Error("Forms serializer error, invalid toType: "+toType);}fnConvert=function(val1){var format=element.getAttribute(Calysto.AttrName.CalystoFormat);if(val1&&format&&(destType.KnownTypeName==Calysto.Type.KnownType.Date||destType.KnownTypeName==Calysto.Type.KnownType.DateTime)){let refOut=new Calysto.BoxValue;Calysto.DateTime.TryParseDateTime(val1,format,refOut)&&(val1=refOut.GetValue())}val1=Calysto.Type.TypeConverter.ChangeType(val1,toType,true);return val1};let currType=Calysto.Type.TypeDescriptor.FromValue(finalValue);if(currType.KnownTypeName!=destType.KnownTypeName){if(Calysto.Type.TypeInspector.IsArray(finalValue)){for(arr=[],n1=0;n1<finalValue.length;n1++){arr.push(fnConvert(finalValue[n1]))};finalValue=arr}else finalValue=fnConvert(finalValue)}}return{Element:element,Name:elementName,Value:finalValue,HasValue:!Calysto.Type.TypeInspector.IsNullOrUndefined(finalValue)}}function SerializeContainer(containerSelector){var all,result,finalArr,n;if(!containerSelector){return[]};for(all=$$calysto(containerSelector).Query("*, //*").Query("input, textarea, select").ToArray(),finalArr=[],n=0;n<all.length;n++){(result=SerializeElement(all[n])).HasValue&&finalArr.push(result)};return finalArr}function EnsureDataTypeAttribute(el,data){if(!el.getAttribute(Calysto.AttrName.CalystoType)){var tt=Calysto.Type.TypeDescriptor.FromValue(data);tt.IsValidKnownType&&el.setAttribute(Calysto.AttrName.CalystoType,tt.NullableTypeName)}}function DeserializeElement(elem,pval){var attr,fn,type,tagName,listItems,optArr,arr,el,n1;let element=elem;if(EnsureDataTypeAttribute(element,pval),attr=element.getAttribute(Calysto.AttrName.CalystoSetter),attr){fn=Calysto.Utility.Expressions.CompileLambdaNoReturnCheck(attr),fn.call(element,pval);return true}type="",element.type&&(type=element.type.toLowerCase()),Calysto.Type.TypeInspector.IsNullOrUndefined(pval)&&(pval=""),tagName=element.tagName.toUpperCase();switch(tagName){case"TEXTAREA":element.value=pval;break;case"INPUT":switch(type){case"checkbox":case"radio":element.checked=element.value!="on"||element.getAttribute("value")?element.value+""==pval+"":pval===true||pval==="true"||pval==="True";break;default:element.value=Calysto.Type.TypeConverter.ToStringFormated(pval,element.getAttribute(Calysto.AttrName.CalystoFormat))}break;case"SELECT":switch(type){case"select":case"select-one":case"select-multiple":try{if(pval&&"Items"in pval){listItems=pval.Items,el=element,el.innerHTML="",optArr=listItems.ForEach(o=>{let opt=document.createElement("option");opt.innerHTML=o.Text,opt.value=o.Value,el.appendChild(opt),opt.selected=!!o.Selected;return opt});break}}catch(e){}if(type=="select-multiple"){for(Calysto.Type.TypeInspector.IsNullOrUndefined(pval)?pval=[]:Calysto.Type.TypeInspector.IsArray(pval)||(pval=[pval]),arr=pval,el=element,n1=0;n1<el.options.length;n1++){el.options[n1].selected=arr.Where(o=>o+""==el.options[n1].value).Any()}}else element.value=Calysto.Type.TypeConverter.ToStringFormated(pval,element.getAttribute(Calysto.AttrName.CalystoFormat));break;default:throw new Error(`Type ${type} not supported.`);}break;default:if("innerHTML"in element){element.innerHTML=Calysto.Type.TypeConverter.ToStringFormated(pval,element.getAttribute(Calysto.AttrName.CalystoFormat))}else return false}return true}function ResetForm(containerSelector){$$calysto(containerSelector||document.documentElement).Query("*, //*").Query("input, select, textarea, ["+Calysto.AttrName.CalystoSetter+"=*]").ForEach(o=>{var attr,tagName,fn;o.disabled||o.readOnly||(attr=o.getAttribute(Calysto.AttrName.CalystoSetter),tagName=o.tagName.toLowerCase(),attr?(fn=Calysto.Utility.Expressions.CompileLambdaNoReturnCheck(attr),fn.call(o,"")):tagName=="textarea"?o.value="":tagName=="input"?o.type=="radio"||o.type=="checkbox"?o.checked=false:o.type=="button"||o.type=="submit"||(o.value=""):tagName.indexOf("select")==0&&(o.value="",o.selectedIndex=0))})}function FormSerialize(containerSelector,trimStrings,refOutDataObj){var arr=SerializeContainer(containerSelector||document.documentElement),dic,n,name,value;let includedNames={};for(dic=refOutDataObj||{},n=0;n<arr.length;n++){if(name=arr[n].Name,name){if(includedNames[name]){continue}}else continue;includedNames[name]=true,value=arr[n].Value,trimStrings&&Calysto.Type.TypeInspector.IsString(value)&&(value=(value||"").Trim()),Calysto.Type.TypeInspector.IsNullOrUndefined(value)||String.IsNullOrEmpty(value)||(dic[name]=value)}return dic}function FormDeserialize(dataObj,containerSelector,alwaysSet){dataObj=dataObj||{},$$calysto(containerSelector||document.documentElement).Query("[name=*], //[name=*]").ForEach(o=>{var name;if(o&&(name=o.name)&&(alwaysSet||name in dataObj)&&!DeserializeElement(o,dataObj[name])){throw new Error("Element with name="+name+" is not valid for data binding");}})}function MvcSerialize(containerSelector,trimStrings,refOutDataObj){var arr=SerializeContainer(containerSelector||document.documentElement),dic,n,name,value;let includedNames={};for(dic=refOutDataObj||{},n=0;n<arr.length;n++){if(name=arr[n].Name,name){if(includedNames[name]){continue}}else continue;includedNames[name]=true,value=arr[n].Value,trimStrings&&Calysto.Type.TypeInspector.IsString(value)&&(value=(value||"").Trim()),Calysto.Type.TypeInspector.IsNullOrUndefined(value)||String.IsNullOrEmpty(value)||Calysto.DataBinder.SetValue(dic,name,value)}return dic}function MvcDeserialize(dataObj,containerSelector,alwaysSet){dataObj=dataObj||{},$$calysto(containerSelector||document.documentElement).Query("*, //*").ForEach(el=>{var name;if(el&&(name=el.name)&&!!name){let box1=new Calysto.BoxValue,hasProperty=Calysto.DataBinder.TryGetValue(dataObj,name,box1);if((alwaysSet||hasProperty)&&!DeserializeElement(el,box1.GetValue())){throw new Error("Element with name="+name+" is not valid for data binding");}}})}function CalystoSerialize(containerSelector,trimStrings,refOutDataObj){let arr=$$calysto(containerSelector||document.documentElement).Query("["+Calysto.AttrName.CalystoId+"=*], //["+Calysto.AttrName.CalystoId+"=*]").Query("input, textarea, select, ["+Calysto.AttrName.CalystoGetter+"=*]").Distinct().ToArray(),dic=refOutDataObj||{};for(let n=0;n<arr.length;n++){let el=arr[n],result,name,value,createArrayValues=!!el.getAttribute(Calysto.AttrName.CalystoIsGroup),allowDuplicates=createArrayValues||!!refOutDataObj;if(result=SerializeElement(el),!!refOutDataObj||result.HasValue){if(name=el.getAttribute(Calysto.AttrName.CalystoId),value=result.Value,!name){continue}}else continue;trimStrings&&typeof value=="string"&&(value=(value||"").Trim());let refOut=new Calysto.BoxValue;if(!allowDuplicates&&Calysto.DataBinder.TryGetValue(dic,name,refOut)){throw new Error("Error in CalystoSerialize, property "+name+" already exists.");}createArrayValues?Calysto.DataBinder.SetValue(dic,name,[refOut.GetValue()]):Calysto.DataBinder.SetValue(dic,name,value)}return dic}function CalystoDeserialize(dataObj,containerSelector,alwaysSet){dataObj&&$$calysto(containerSelector||document.documentElement).Query("["+Calysto.AttrName.CalystoId+"=*], //["+Calysto.AttrName.CalystoId+"=*]").Distinct().ForEach(el=>{let name=el.getAttribute(Calysto.AttrName.CalystoId),refObj=new Calysto.BoxValue;if(name&&Calysto.DataBinder.TryGetValue(dataObj,name,refObj)||alwaysSet){if(el.type=="text"&&el.getAttribute(Calysto.AttrName.CalystoIsGroup)){throw new Error("NotImplemented: deserialization to element with calysto-isgroup attribute");}else if(!DeserializeElement(el,refObj.GetValue())){throw new Error("Element with calysto-id="+name+" is not valid for data binding");}}})}function CalystoSerialize2(containerSelector,trimStrings,refOutDataObj){let arr=$$calysto(containerSelector||document.documentElement).Query("["+Calysto.AttrName.CalystoId+"=*], //["+Calysto.AttrName.CalystoId+"=*]").Query("input, textarea, select, ["+Calysto.AttrName.CalystoGetter+"=*]").Distinct().ToArray(),allowDuplicates=!!refOutDataObj,dic=refOutDataObj||{};for(let n=0;n<arr.length;n++){let element=arr[n],calystoid=element.getAttribute(Calysto.AttrName.CalystoId),calystouid=element.getAttribute(Calysto.AttrName.CalystoUid);calystouid||element.setAttribute(Calysto.AttrName.CalystoUid,calystouid=Calysto.Utility.Generators.GeneratePassword(20));let res=SerializeElement(element),dic2={CalystoId:calystoid,CalystoUid:calystouid,Value:res&&res.HasValue?res.Value:undefined,Enabled:$$calysto(element).WhereEnabled(true).Any(),Visible:$$calysto(element).WhereVisible(true).Any(),Name:Calysto.Utility.Html.ExtractAspNameOrId(element.name),Id:Calysto.Utility.Html.ExtractAspNameOrId(element.id),Checked:element.checked,HtmlName:element.name,HtmlValue:element.value,HtmlId:element.id,HtmlTagName:element.tagName,HtmlType:element.type},refOut=new Calysto.BoxValue;if(!allowDuplicates&&Calysto.DataBinder.TryGetValue(dic,calystoid,refOut)){throw new Error("Error in CalystoSerialize2, property "+calystoid+" already exists.");}trimStrings&&typeof dic2.Value=="string"&&(dic2.Value=(dic2.Value||"").Trim()),Calysto.DataBinder.SetValue(dic,calystoid,dic2)}return dic}function CalystoDeserialize2(dataObj,containerSelector,alwaysSet){dataObj&&$$calysto(containerSelector||document.documentElement).Query("["+Calysto.AttrName.CalystoId+"=*], //["+Calysto.AttrName.CalystoId+"=*]").Distinct().ForEach(el=>{var name=el.getAttribute(Calysto.AttrName.CalystoId),refOut=new Calysto.BoxValue;if(name&&Calysto.DataBinder.TryGetValue(dataObj,name,refOut)||alwaysSet){let item=refOut.GetValue(),val1=item?item.Value:undefined;if(DeserializeElement(el,val1)){item&&$$calysto(el).SetVisible(!!item.Visible).SetEnabled(!!item.Enabled).SetProperty("checked",!!item.Checked)}else throw new Error("Element with calysto-id="+name+" is not valid for data binding");}})}function ToMvcModelState(containerSelector){let state=new Calysto.Web.UI.Direct.CalystoMvcModelState;state.Raw=MvcSerialize(containerSelector,true),state.RootSelector=Calysto.Utility.Dom.EnsureElementId(containerSelector);return state}class SerializedElement{constructor(){this.Enabled=true,this.Visible=true}}Forms.SerializeContainer=SerializeContainer,Forms.ResetForm=ResetForm,Forms.FormSerialize=FormSerialize,Forms.FormDeserialize=FormDeserialize,Forms.MvcSerialize=MvcSerialize,Forms.MvcDeserialize=MvcDeserialize,Forms.CalystoSerialize=CalystoSerialize,Forms.CalystoDeserialize=CalystoDeserialize,Forms.CalystoSerialize2=CalystoSerialize2,Forms.CalystoDeserialize2=CalystoDeserialize2,Forms.ToMvcModelState=ToMvcModelState})(Forms=Calysto.Forms||(Calysto.Forms={}))}(Calysto||(Calysto={})),function(Calysto){class SelectorReader{constructor(selector){this.selector=selector,this.currPosition=0}Peek(forwardBy=0){return this.selector.charAt(this.currPosition+(forwardBy||0))}Pop(){return this.selector.charAt(this.currPosition++)}PopMatch(regex,origin=0){origin=origin||0;var mm=(this.selector.substr(this.currPosition+origin)||"").match(regex);if(mm&&mm[0]){this.currPosition+=mm[0].length+origin;return mm}return null}}Calysto.SelectorReader=SelectorReader}(Calysto||(Calysto={})),function(Calysto){function attrPredicateFunc(el,attrName,attrSign,attrValue){var currValue,m,index,num1,num2;if(!attrSign){return Calysto.Utility.Dom.HasAttribute(el,attrName)};if(currValue=Calysto.Utility.Dom.GetAttribute(el,attrName)||"",m=attrSign,m){if(m=="="||m=="=="){return currValue==attrValue};if(m=="=*"){return!!currValue};if(m=="~="){return(" "+currValue+" ").indexOf(" "+attrValue+" ")>=0};if(m=="*="){return currValue.indexOf(attrValue)>=0};if(m=="^="){return currValue.indexOf(attrValue)==0};if(m=="$="){index=currValue.lastIndexOf(attrValue);return index+attrValue.length==currValue.length}if(m=="!="||m=="<>"){return currValue!=attrValue};if(num1=Calysto.Type.NumberConverter.ToNumberOrDefault(currValue,NaN,"."),num2=Calysto.Type.NumberConverter.ToNumberOrDefault(attrValue,NaN,"."),!Calysto.Type.TypeInspector.IsNumber(num1)||!Calysto.Type.TypeInspector.IsNumber(num2)){return false};switch(m){case"<":return num1<num2;case">":return num1>num2;case">=":return num1>=num2;case"<=":return num1<=num2}throw new Error("Unsupported calystoSelector ("+(attrName+", "+attrSign+", "+attrValue)+") in Calysto.DomQuery.BuildLambdaExpression #2");}else return!!currValue}function CreateAttributeQuery(source,attrName,attrSign,attrValue){var func=function(attrName,attrSign,attrValue){return function(el){return attrPredicateFunc(el,attrName,attrSign,attrValue)}}(attrName,attrSign,attrValue);return source.Where(function(o){return func(o)})}function CreateIdQuery(source,id){return source.Where(function(o){return o.id==id||Calysto.Utility.Html.ExtractAspNameOrId(o.id)==id})}function CreateClassQuery(source,className){return source.Where(function(o){return Calysto.Utility.Dom.HasClass(o,className)})}function CreateTagQuery(source,tag){return source.Where(function(o){return Calysto.Utility.Dom.HasTagName(o,tag)})}function CreateColonWordQuery(source,colonWord,colonValue){var count=parseInt(colonValue,10)||1;switch(colonWord){case"visible":return source.WhereVisible(true);case"invisible":case"hidden":return source.WhereVisible(false);case"first":case"take":return source.Take(count);case"last":return source.Reverse().Take(count).Reverse();case"skip":return source.Skip(count);case"exact":return source.Exact(count).AsDomQuery();case"is":case"not":return source.Where(o=>DomQuery.FromArray([o]).Query(colonValue).Any()==(colonWord=="is"));case"reverse":return source.Reverse();case"ancestor":return source.AncestorNodes();case"descendant":return source.DescendantNodes();case"child":return source.ChildNodes();case"parent":return source.ParentNodes();case"next-sibling":return source.NextSiblings();case"previous-sibling":return source.PreviousSiblings();default:throw new Error("Unsupported calystoSelector: "+colonWord+"("+colonValue+")");}}function GetAncestors(node){for(var items=[];node.parentNode;){items.push(node.parentNode),node=node.parentNode};return items}function SetOffsetDimensions(element,offsetWidth,offsetHeight){var el=element,currStyleWidth,w1,currStyleHeight,h1;Calysto.Utility.Dom.IsElementVisible(el)&&(typeof offsetWidth=="number"&&Calysto.Type.TypeInspector.IsNumber(offsetWidth)&&(el.style.width=offsetWidth+"px",el.offsetWidth!=offsetWidth&&(currStyleWidth=Calysto.Utility.Dom.GetComputedStyle(el,"width").NumericValue,w1=offsetWidth-(el.offsetWidth-(currStyleWidth||0)),el.style.width=w1+"px")),typeof offsetHeight=="number"&&Calysto.Type.TypeInspector.IsNumber(offsetHeight)&&(el.style.height=offsetHeight+"px",el.offsetHeight!=offsetHeight&&(currStyleHeight=Calysto.Utility.Dom.GetComputedStyle(el,"height").NumericValue,h1=offsetHeight-(el.offsetHeight-(currStyleHeight||0)),el.style.height=h1+"px")))}function GetTextValueOnly(node,ignoreCase){var txt=node.tagName||"",n,attr;if(node.attributes&&node.attributes.length>0){for(n=0;n<node.attributes.length;n++){attr=node.attributes[n],txt+=" "+attr.name+'="'+attr.value+'"'}};node.nodeValue&&(txt&&txt.length>0&&(txt+=" "),txt+=node.nodeValue);return ignoreCase?txt.toLowerCase():txt}function CssClass(source,method,cssClass){return source.ForEach(function(item){Calysto.Utility.Dom[method](item,cssClass)})}function GetHoverCB(isHover,callbackFunc){return function(sender,ev){if(Calysto.Event.IsHoverChanged(sender,ev,isHover)){return callbackFunc.call(sender,sender,ev)}}}function GetTriggCountCB(triggCountMax,callbackFunc){var count=0;return function(sender,ev){var ret;ev=ev||window.event,count<triggCountMax&&(count++,ret=callbackFunc.call(sender,sender,ev));return ret}}function GetCBEncaps(callback){return(sender,ev)=>{ev=ev||window.event;var res=callback.call(sender,sender,ev);res===false?Calysto.Event.StopPropagation(ev,true):res===true&&Calysto.Event.StopPropagation(ev,false);return res}}function AddOrModify(funcName,currItemsArray,contentArgsArray){for(var cloned,k,el,allCurr=currItemsArray,elarr=Calysto.Utility.Dom.ConvertToElementsArray(contentArgsArray),allNew=[],n1=0;n1<allCurr.length;n1++){for(cloned=[],k=0;elarr&&k<elarr.length;k++){el=Calysto.Utility.Dom.CloneNodeIfHasParent(elarr[k]),cloned.push(el),allNew.push(el)};Calysto.Utility.Dom[funcName](allCurr[n1],cloned)}ExecuteInsertedScripts(allNew);return{ThisItems:allCurr,NewItems:allNew}}function ExecuteInsertedScripts(containers){DomQuery.FromArray(containers).Query("script, //script").ForEach(o=>Calysto.ScriptLoader.ReloadScriptNode(o))}function ParseXmlString(xmlDocStr){var xmlDoc,parser;window.DOMParser?(parser=new DOMParser,xmlDoc=parser.parseFromString(xmlDocStr,"text/xml")):(xmlDocStr.indexOf("<?")==0&&(xmlDocStr=xmlDocStr.substr(xmlDocStr.indexOf("?>")+2)),xmlDoc=new window.ActiveXObject("Microsoft.XMLDOM"),xmlDoc.async=false,xmlDoc.loadXML(xmlDocStr));return xmlDoc}var dimMap={absoluteTop:NaN,absoluteLeft:NaN,position:"",top:NaN,right:NaN,bottom:NaN,left:NaN,width:NaN,height:NaN,minWidth:NaN,minHeight:NaN,maxWidth:NaN,maxHeight:NaN,clientLeft:NaN,clientTop:NaN,clientWidth:NaN,clientHeight:NaN,offsetLeft:NaN,offsetTop:NaN,offsetWidth:NaN,offsetHeight:NaN,scrollLeft:NaN,scrollTop:NaN,scrollWidth:NaN,scrollHeight:NaN,paddingTop:NaN,paddingRight:NaN,paddingBottom:NaN,paddingLeft:NaN,marginTop:NaN,marginRight:NaN,marginBottom:NaN,marginLeft:NaN,borderTop:NaN,borderRight:NaN,borderBottom:NaN,borderLeft:NaN},transforms=["transform","-ms-transform","-webkit-transform"];class PoolingState{constructor(query,intervalID){this.query=query,this.intervalID=intervalID}Abort(){clearInterval(this.intervalID);return this}AsDomQuery(){return this.query}}Calysto.PoolingState=PoolingState;class DomQuery extends Calysto.CalystoEnumerable{constructor(getEnumerator){super(getEnumerator),this.OnEventAttached=(new Calysto.MulticastDelegate).AsFunc(this)}ForEach(action){return super.ForEach(action).AsDomQuery()}Skip(count){return super.Skip(count).AsDomQuery()}Take(count){return super.Take(count).AsDomQuery()}SkipWhile(predicate){return super.SkipWhile(predicate).AsDomQuery()}Reverse(){return super.Reverse().AsDomQuery()}Where(predicate){return super.Where(predicate).AsDomQuery()}Select(selector){return super.Select(selector).AsDomQuery()}Cast(){return this}SelectMany(selector){return super.SelectMany(selector).AsDomQuery()}Distinct(keySelector){return super.Distinct(keySelector).AsDomQuery()}selectFilteredSingle(source,calystoSelector){let origsrc=source,newsrc=source,selector1=calystoSelector.replace(new RegExp("['\"]","ig"),"").replace(new RegExp("(^[\\s]+)|([\\s]+$)","ig"),"").replace(new RegExp("([ ]*)([\\/\\<\\>\\!\\~\\^\\$\\*\\=]+)([ ]*)","ig"),"$2").replace(new RegExp("[ ]+")," "),ch,mm,reader=new Calysto.SelectorReader(selector1);while(ch=reader.Pop()){if(ch=="#"&&(mm=reader.PopMatch(new RegExp("^([\\w\\-_]+)")))){newsrc=CreateIdQuery(newsrc,mm[1])}else if(ch=="."&&(mm=reader.PopMatch(new RegExp("^([\\w\\-_]+)")))){newsrc=CreateClassQuery(newsrc,mm[1])}else if(ch==" "){newsrc=newsrc.DescendantNodes()}else if(ch=="/"&&reader.Peek()=="/"&&reader.Peek(1)!="/"){reader.Pop(),newsrc=newsrc.DescendantNodes()}else if(ch=="*"){newsrc=newsrc.Select(o=>o)}else if(ch=="^"){newsrc=newsrc.AncestorNodes()}else if(ch=="<"){newsrc=newsrc.ParentNodes()}else if(ch==">"){newsrc=newsrc.ChildNodes()}else if(ch=="/"&&reader.Peek()!="/"){newsrc=newsrc.ChildNodes()}else if(ch==":"&&(mm=reader.PopMatch(new RegExp("^([\\w\\-_]+)([\\(]([^\\)]*)[\\)])*")))){newsrc=CreateColonWordQuery(newsrc,mm[1],mm[3])}else if(ch=="["&&(mm=reader.PopMatch(new RegExp("^[ ]*([\\w\\-_]+)[ ]*([<>\\!\\=\\~\\^\\$\\*]*)[ ]*((([^\\[\\]])*(\\[\\d+\\])*)*)[ ]*\\]")))){newsrc=CreateAttributeQuery(newsrc,mm[1],mm[2],mm[3])}else if(mm=reader.PopMatch(new RegExp("^([\\w\\-_]+)"),-1)){newsrc=CreateTagQuery(newsrc,mm[1])}else throw new Error("Unsupported calystoSelector ("+selector1+")");}newsrc==origsrc&&(newsrc=DomQuery.FromArray([]));return newsrc}Query(calystoSelector){return this.QueryWorker(calystoSelector).Cast().AsDomQuery()}QueryWorker(calystoSelector){var source,ch,newSources,n,sel,tmpnewsrc;if(!calystoSelector){return this};if(source=this,typeof calystoSelector=="string"&&calystoSelector.indexOf("=>")>0||typeof calystoSelector=="function"){let fn1=Calysto.Utility.Expressions.CompileLambdaExpression(calystoSelector);return source.Where(fn1)}var calystoSelectorsArr=[],currPart="",digCount=0;for(n=0;n<calystoSelector.length;n++){ch=calystoSelector.charAt(n),ch==")"?(digCount--,currPart+=ch):ch=="("?(digCount++,currPart+=ch):ch==","&&digCount==0?(calystoSelectorsArr.push(currPart),currPart=""):currPart+=ch};if(currPart.length>0&&calystoSelectorsArr.push(currPart),calystoSelectorsArr.length>1){for(newSources=null,n=0;n<calystoSelectorsArr.length;n++){sel=calystoSelectorsArr[n].replace(new RegExp("((^[ ,]+)|([ ,]+$))","ig"),""),sel!=null&&sel!=""&&(tmpnewsrc=this.selectFilteredSingle(source,sel),newSources=newSources?newSources.Concat(tmpnewsrc):tmpnewsrc)};return newSources}return this.selectFilteredSingle(source,calystoSelector)}ParentNodes(calystoSelector){return this.Where(o=>!!o.parentNode).Select(o=>o.parentNode).Query(calystoSelector)}AncestorNodes(calystoSelector){return this.SelectMany(function(o){return GetAncestors(o)}).Select(o=>o).Query(calystoSelector)}ChildNodes(calystoSelector){return this.Where(o=>o.childNodes&&o.childNodes.length>0).SelectMany(o=>o.childNodes).Query(calystoSelector)}getDescendants(curr){return curr&&curr.childNodes&&curr.childNodes.length>0&&curr.nodeType&&curr.getElementsByTagName?curr.getElementsByTagName("*"):null}DescendantNodes(calystoSelector){return this.SelectMany(node=>this.getDescendants(node)).Query(calystoSelector)}NextSiblings(calystoSelector){return this.Where(function(o){return o&&o.parentNode&&o.parentNode.childNodes}).SelectMany(function(o){return DomQuery.FromArray(o.parentNode.childNodes).Select(o=>o).SkipWhile(function(k){return k!=o}).Skip(1).ToArray()}).Query(calystoSelector)}PreviousSiblings(calystoSelector){return this.Where(function(o){return o&&o.parentNode&&o.parentNode.childNodes}).SelectMany(function(o){return DomQuery.FromArray(o.parentNode.childNodes).Select(o=>o).TakeWhile(function(k){return k!=o}).ToArray()}).Reverse().Query(calystoSelector)}WhereTagName(tagName){if(!tagName){throw new Error("WhereTagName requires tagName parameter");}tagName=tagName.toLowerCase();return this.Where(function(o){return o.tagName&&o.tagName.toLowerCase()==tagName})}WhereAttribute(name,predicate){if(!name){throw new Error("WhereAttribute requires name parameter");}return this.Where(function(o){return predicate(Calysto.Utility.Dom.GetAttribute(o,name))})}WhereHasAttribute(name,hasIt=true){return this.Where(function(o){return Calysto.Utility.Dom.HasAttribute(o,name)==hasIt})}WhereStyle(name,predicate){if(!name){throw new Error("WhereAttribute requires name parameter");}return this.Where(function(o){return predicate(Calysto.Utility.Dom.GetComputedStyle(o,name).NumericValue)})}WhereId(idvalue){if(!idvalue){throw new Error("WhereId requires id parameter");}return this.WhereAttribute("id",function(o){return o==idvalue})}WhereHasClass(cssClass,hasIt=true){if(!cssClass){throw new Error("WhereHasClass requires cssClass parameter");}return this.Where(function(item){return Calysto.Utility.Dom.HasClass(item,cssClass)==hasIt})}SelectStyle(name){if(!name){throw new Error("StyleValue requires name parameter");}return this.Select(item=>{var ss=Calysto.Utility.Dom.GetComputedStyle(item,name);return Calysto.Type.TypeInspector.IsNumber(ss.NumericValue)?ss.NumericValue:ss.StyleValue})}SelectStyleMap(mapObj){return this.Select(element=>{let obj={};Calysto.Collections.ForEachOwnProperties(mapObj,name=>{var ss=Calysto.Utility.Dom.GetComputedStyle(element,name),num=Calysto.Type.NumberConverter.ToNumberOrDefault(ss.NumericValue,NaN,".");Calysto.Type.TypeInspector.IsNumber(num)||(num=ss.StyleValue),obj[name]=num});return obj})}SelectDimensionsMap(){return this.SelectStyleMap(dimMap)}ApplyStyleMap(styleMap){return this.ForEach(function(item){for(var prop in styleMap){Calysto.Utility.Dom.SetStyleValue(item,prop,styleMap[prop])}})}ApplyStyle(nameOrCssText,value){if(!nameOrCssText){return this};if(arguments.length==1){if(typeof nameOrCssText=="string"){return this.ForEach(item=>{item&&item.style&&(item.style.cssText+=";"+nameOrCssText)})};if(typeof nameOrCssText=="object"){return this.ApplyStyleMap(nameOrCssText)};throw new Error("Invalid argument in ApplyStyle: "+nameOrCssText);}else return this.ForEach(function(item){Calysto.Utility.Dom.SetStyleValue(item,nameOrCssText,value)})}SetOffsetSize(offsetWidth,offsetHeight){return this.ForEach(function(el){SetOffsetDimensions(el,offsetWidth,offsetHeight)})}FitIntoParent(){return this.ForEach(function(o){o._calystoPrevPosition=o.style.position}).ApplyStyle("position:absolute").ForEach(function(o){var newW=Calysto.Utility.Dom.GetComputedStyle(o.parentNode,"width").NumericValue,newH=Calysto.Utility.Dom.GetComputedStyle(o.parentNode,"height").NumericValue;SetOffsetDimensions(o,newW,newH)}).ForEach(function(o){o.style.position=o._calystoPrevPosition||"",delete o._calystoPrevPosition})}SelectAttribute(name){return this.Select(function(item){return Calysto.Utility.Dom.GetAttribute(item,name)})}SelectAttributeMap(mapObj){return this.Select(function(item){var obj={};Calysto.Collections.ForEachOwnProperties(mapObj,name=>{obj[name]=Calysto.Utility.Dom.GetAttribute(item,name)});return obj})}SelectAttributesAll(){return this.Select(function(item){var _a;let dic={},attributes1=(_a=item)===null||_a===void 0?void 0:_a.attributes;if(!attributes1){return dic};for(let attr of attributes1){dic[attr.name]=attr.value};return dic})}SetAttribute(name,value,add=true){if(!name){throw new Error("AttributeValue requires name parameter");}return this.ForEach(item=>{add?Calysto.Utility.Dom.SetAttribute(item,name,value):Calysto.Utility.Dom.RemoveAttribute(item,name)})}RemoveAttribute(name){return this.SetAttribute(name,null,false)}SetInnerHtml(html){(arguments.length==0||html==null||typeof html=="undefined")&&(html="");return this.ForEach(function(el){let h1=html+"";el.innerHTML=h1,h1&&ExecuteInsertedScripts([el])})}SetValueOrInnerHtml(content){return this.ForEach(function(el){let el1=el,tagName=el1.tagName.toLowerCase();switch(tagName){case"input":case"select":case"textarea":el1.value=content;break;default:el1.innerHTML=content,ExecuteInsertedScripts([el1])}})}SetProperty(property,value){return this.ForEach(function(el){el[property]=value})}SetChecked(value){return this.SetProperty("checked",value)}AppendInnerHtml(html){(arguments.length==0||html==null||typeof html=="undefined")&&(html="");return this.ForEach(function(el){el.innerHTML+=html+""})}SelectInnerHtml(){return this.Select(function(el){return el.innerHTML})}SelectInnerText(){return this.Select(function(el){return Calysto.Utility.Dom.GetInnerText(el)})}WhereText(textToSearch,ignoreCase){if(!textToSearch){throw new Error("WhereText requires textToSearch parameter");}textToSearch=ignoreCase?textToSearch.toLowerCase():textToSearch;return this.Where(function(item){return item&&GetTextValueOnly(item,ignoreCase).indexOf(textToSearch)>=0})}AddClass(cssClass,add=true){return add?CssClass(this,"AddClass",cssClass):this.RemoveClass(cssClass)}RemoveClass(cssClass){return CssClass(this,"RemoveClass",cssClass)}SetClass(cssClass){return CssClass(this,"SetClass",cssClass)}ToggleClass(cssClass){return CssClass(this,"ToggleClass",cssClass)}SelectClassNames(){return this.SelectMany(function(el){return el.className.match(new RegExp("[\\S]+","g"))})}WhereVisible(isVisible=true){isVisible=arguments.length==0||!!isVisible;return this.Where(function(o){return Calysto.Utility.Dom.IsElementVisible(o)==isVisible})}WhereInViewPort(isVisible=true,onlyPart=true){isVisible=arguments.length==0||!!isVisible;return this.Where(function(o){return Calysto.Utility.Dom.IsElementVisible(o)==isVisible&&Calysto.Utility.Dom.IsElementInViewport(o,onlyPart)==isVisible})}WhereEnabled(isEnabled=true){isEnabled=arguments.length==0||!!isEnabled;return this.Where(function(o){return!Calysto.Utility.Dom.HasAttribute(o,"disabled")==isEnabled})}On(eventFullNameOrArr,callbackFunc,useCapture,triggCountMax){var src,n,eventFullName;if(!callbackFunc){throw new Error("CallbackFunc can not be null");}if(Calysto.Type.TypeInspector.IsArray(eventFullNameOrArr)){for(src=this,n=0;n<eventFullNameOrArr.length;n++){src=this.On(eventFullNameOrArr[n],callbackFunc,useCapture,triggCountMax)};return src}eventFullName=eventFullNameOrArr,eventFullName.indexOf("on")==0&&(eventFullName=eventFullName.substr(2));var cb11=callbackFunc,parts=eventFullName.split("."),evName=parts[0];evName=="enterKey"?(parts.unshift("keydown"),cb11=function(sender,ev){if(Calysto.Event.IsEnterKey(ev)){return callbackFunc.call(sender,sender,ev)}}):evName=="escKey"&&(parts.unshift("keydown"),cb11=function(sender,ev){if(Calysto.Event.IsEscKey(ev)){return callbackFunc.call(sender,sender,ev)}});return this.ForEach(domElement=>{var cb,fnEncaps;if(domElement){cb=GetCBEncaps(cb11),evName=="hover"?(parts.unshift("mouseover"),cb=GetHoverCB(true,cb)):evName=="hout"&&(parts.unshift("mouseout"),cb=GetHoverCB(false,cb)),triggCountMax&&triggCountMax>0&&(cb=GetTriggCountCB(triggCountMax,cb)),fnEncaps=function(contextItem,cbFunc){return function(ev){cbFunc.call(contextItem,contextItem,ev)}}(domElement,cb);let def=Calysto.Event.Attach(domElement,parts.join("."),fnEncaps,useCapture);this.OnEventAttached.Invoke(f=>f(def))}})}RemoveEvent(eventFullName){return this.ForEach(function(domElement){domElement&&domElement.$$calysto_EventsArr.Where(o=>o.eventFullName==eventFullName).ForEach(o=>o.removeEvent())})}DispatchEvent(event){return this.ForEach(function(el){Calysto.Event.DispatchEvent(el,event)})}OnHover(onOver,onOut){var tt=this;onOver&&(tt=tt.On("hover",onOver)),onOut&&(tt=tt.On("hout",onOut));return tt}OnChange(callbackFunc){return this.On("change",callbackFunc)}OnChangePooling(callbackFunc){let key=Calysto.Utility.Generators.GeneratePassword(10),valueKey="__value_"+key,checkedKey="__checked_"+key,items=this.ForEach(o=>{o[valueKey]=o.value,o[checkedKey]=o.checked}).ToList(),id=setInterval(()=>{items.ForEach(o=>{(o[valueKey]!=o.value||o[checkedKey]!=o.checked)&&(o[valueKey]=o.value,o[checkedKey]=o.checked,callbackFunc(o,{type:"change",target:o,currentTarget:o}))})},100);return new PoolingState(items.AsDomQuery(),id)}OnInput(callbackFunc){return this.On("input",callbackFunc)}OnClick(callbackFunc){return this.On("click",callbackFunc)}OnDblClick(callbackFunc){return this.On("dblclick",callbackFunc)}OnMouseUp(callbackFunc){return this.On("mouseup",callbackFunc)}OnMouseDown(callbackFunc){return this.On("mousedown",callbackFunc)}OnMouseOver(callbackFunc){return this.On("mouseover",callbackFunc)}OnMouseOut(callbackFunc){return this.On("mouseout",callbackFunc)}OnLeftMouseDown(callbackFunc){function cb(sender,event){Calysto.Event.IsLeftMouseButton(event)&&callbackFunc.apply(tmp111,arguments)}let tmp111=this;return this.On("mousedown.leftmousedown",cb)}OnRightMouseDown(callbackFunc){function cb(sender,event){Calysto.Event.IsRightMouseButton(event)&&callbackFunc.apply(tmp111,arguments)}let tmp111=this;return this.On("mousedown.rightmousedown",cb)}OnMouseMove(callbackFunc){return this.On("mousemove",callbackFunc)}OnFocus(callbackFunc){return this.On("focus",callbackFunc)}OnBlur(callbackFunc){return this.On("blur",callbackFunc)}OnKeyDown(callbackFunc){return this.On("keydown",callbackFunc)}OnKeyUp(callbackFunc){return this.On("keyup",callbackFunc)}OnKeyPress(callbackFunc){return this.On("keypress",callbackFunc)}OnEnter(callbackFunc){return this.On("enterKey",callbackFunc)}OnEscKey(callbackFunc){return this.On("escKey",callbackFunc)}CloneNodes(){return this.Where(o=>!!o.cloneNode).Select(o=>o.cloneNode(true))}RemoveFromDom(){return this.ForEach(function(item){Calysto.Utility.Dom.RemoveNodeFromDom(item)})}ReplaceWith(){var _a,res=AddOrModify("InsertBefore",this.ToArray(),arguments);(_a=res.ThisItems)===null||_a===void 0?void 0:_a.ForEach(o=>Calysto.Utility.Dom.RemoveNodeFromDom(o));return res.NewItems.AsEnumerable().AsDomQuery()}ReplaceChildren(){var res=AddOrModify("ReplaceChildrenWith",this.ToArray(),arguments);return this}RemoveChildren(){return this.ReplaceChildren()}AddChildren(){var res=AddOrModify("AddChildren",this.ToArray(),arguments);return this}InsertChildren(){var res=AddOrModify("InsertChildren",this.ToArray(),[].AddRange(arguments).Reverse());return this}InsertBefore(){var res=AddOrModify("InsertBefore",this.ToArray(),arguments);return this}InsertAfter(){var res=AddOrModify("InsertAfter",this.ToArray(),[].AddRange(arguments).Reverse());return this}InsertAsChildrenTo(calystoSelector){var destinationArr=Calysto.DomQuery.FromSelector(calystoSelector).ToArray(),thisArr=this.Reverse().ToArray(),res=AddOrModify("InsertChildren",destinationArr,thisArr);return res.NewItems.AsEnumerable().AsDomQuery()}AddAsChildrenTo(calystoSelector){var destinationArr=Calysto.DomQuery.FromSelector(calystoSelector).ToArray(),thisArr=this.ToArray(),res=AddOrModify("AddChildren",destinationArr,thisArr);return res.NewItems.AsEnumerable().AsDomQuery()}InsertBeforeTo(calystoSelector){var destinationArr=Calysto.DomQuery.FromSelector(calystoSelector).ToArray(),thisArr=this.ToArray(),res=AddOrModify("InsertBefore",destinationArr,thisArr);return res.NewItems.AsEnumerable().AsDomQuery()}InsertAfterTo(calystoSelector){var destinationArr=Calysto.DomQuery.FromSelector(calystoSelector).ToArray(),thisArr=this.ToArray(),res=AddOrModify("InsertAfter",destinationArr,thisArr);return res.NewItems.AsEnumerable().AsDomQuery()}Sleep(sleepMs,onExpired){var aa=this;setTimeout(function(){onExpired.call(aa,aa)},sleepMs);return this}ToAnimator(finalMap){if(!finalMap){throw new Error("ToAnimator requires finalMap");}var animator=new Calysto.Animator;this.ForEach(item=>{for(var prop in finalMap){animator.AddElement(item,prop,finalMap[prop])}});return animator}SetSelectable(isSelectable=true){return isSelectable?this.RemoveClass("calystoNoUserSelect"):this.AddClass("calystoNoUserSelect")}SetEnabled(isEnabled=true){return this.ForEach(function(item){Calysto.Utility.Dom.SetEnabled(item,isEnabled)})}SetVisible(isVisible=true){return this.ForEach(item=>{var val;item&&item.style&&(isVisible?(item.style.display=="none"&&(item.style.display=""),val=Calysto.Utility.Dom.GetComputedStyle(item,"display").StyleValue,val=="none"&&(item.style.display=item.tagName.toLowerCase()=="div"?"block":"inherit"),item.style.visibility=="hidden"&&(item.style.visibility=""),val=Calysto.Utility.Dom.GetComputedStyle(item,"visibility").StyleValue,(val=="hidden"||val=="collapse")&&(item.style.visibility="inherit")):item.style.display="none")})}SetReadOnly(isReadonly=true){return isReadonly?this.SetAttribute("readonly","readonly"):this.RemoveAttribute("readonly")}SetOpacity(value){value>1&&(value=value/100);return this.ApplyStyle("filter","alpha(opacity="+value*100+")").ApplyStyle("opacity",value)}SetClip(clipValue){return this.ForEach(function(o){Calysto.Utility.Dom.SetClip(o,clipValue)})}SetTransition(propertyName="all",durationMs=0,func="linear",delayMs=0){arguments.length<1&&(propertyName="all"),arguments.length<2&&(durationMs=400),arguments.length<3&&(func="linear"),arguments.length<4&&(delayMs=0);var val=propertyName=="none"?"":propertyName+" "+durationMs+"ms "+func+" "+delayMs+"ms";this.ApplyStyle("transition",val),this.ApplyStyle("-webkit-transition",val);return this}SetTransform(transformFunc){(arguments.length==0||transformFunc=="none")&&(transformFunc="");for(var n=0;n<transforms.length;n++){this.ApplyStyle(transforms[n],transformFunc)};return this}ApplyTransform(transformFunc){if(arguments.length==0||transformFunc=="none"){return this.SetTransform("none")};var fnames=transformFunc.match(new RegExp("[\\w]+","ig"));return this.ForEach(o=>{if(o&&o.style&&fnames&&fnames.length>0){var newval=transformFunc,curr=o.style.transform||o.style.msTransform||o.style.webkitTransform;curr&&(newval=curr.replace(new RegExp("("+fnames.join("|")+")[\\s]*\\([^\\)]*\\)","ig"),"")+" "+transformFunc),Calysto.DomQuery.FromSelector(o).SetTransform(newval)}})}SelectTransform(){return this.Select(function(o){return Calysto.Utility.Dom.SelectTransform(o)})}SetLinearGradient(degrees,color0){var arr,n;if(arguments.length==0||degrees=="none"){return this.ApplyStyle("background-color","").ApplyStyle("background-image","")};for(degrees=parseFloat(degrees),Calysto.Features.GetBrowser().Kind==Calysto.Features.BrowserKindEnum.Safari&&(degrees=(degrees-90)*-1),degrees+="deg",arr=[degrees],n=1;n<arguments.length;n++){arr.push(arguments[n])};var str=arr.join(", "),pp=["-webkit-","-moz-","-ms-","-o-",""],ss=["background-color:"+(color0||"").split(" ")[0]];for(n=0;n<pp.length;n++){ss.push("background-image:"+pp[n]+"linear-gradient("+str+")")};ss.push(""),console.log(ss.join(";")),this.ApplyStyle(ss.join(";"));return this}ToAnimatorScrollIntoView(alignToTop=false){let animator=new Calysto.Animator;this.ForEach(item=>{let el1=item,scrollableAncestor=Calysto.Utility.Dom.GetScrollableAncestors(el1)[0];if(scrollableAncestor){let elPosition=Calysto.Utility.Dom.GetElementScreenPosition(el1),elAncestorPosition=Calysto.Utility.Dom.GetElementScreenPosition(scrollableAncestor),scrollTop=elPosition.top-elAncestorPosition.top,scrollLeft=elPosition.left-elAncestorPosition.left;alignToTop||(scrollTop+=scrollableAncestor.clientHeight-el1.clientHeight,scrollLeft+=scrollableAncestor.clientHeight-el1.clientWidth),animator.AddElement(scrollableAncestor,"scrollTop",scrollTop),animator.AddElement(scrollableAncestor,"scrollLeft",scrollLeft)}});return animator}static FromArray(arr){return new DomQuery(()=>Calysto.CalystoEnumerator.From(arr))}static FromSelector(calystoSelector){var n;let argsAll=arguments;if(argsAll.length>1){let qq;for(n=0;n<argsAll.length;n++){let innerSel=Calysto.DomQuery.FromSelector(argsAll[n]);qq=qq?qq.addPredicateInfo("Concat",argsAll[n]).Concat(innerSel):innerSel}return qq}if(!calystoSelector){return DomQuery.FromArray([])};if(typeof calystoSelector=="string"){switch(calystoSelector.charAt(0)){case" ":case"/":calystoSelector=calystoSelector.TrimStart([" ","/"])}}if(calystoSelector==window){return DomQuery.FromArray([calystoSelector])};if(calystoSelector==document){return DomQuery.FromArray([calystoSelector])};if(calystoSelector.nodeType>0&&calystoSelector.cloneNode){return DomQuery.FromArray([calystoSelector])};if(calystoSelector=="html"){return DomQuery.FromArray([document.documentElement])};if(calystoSelector=="body"){return DomQuery.FromArray([document.body])};if(calystoSelector.constructor==Calysto.DomQuery){return calystoSelector};if(calystoSelector.GetEnumerator){return new Calysto.DomQuery(()=>calystoSelector.GetEnumerator())};if(calystoSelector.childNodes){return DomQuery.FromArray([calystoSelector])};if(typeof calystoSelector=="string"&&calystoSelector.length>0){return DomQuery.FromArray([document]).DescendantNodes().Query(calystoSelector)};if(calystoSelector.push&&calystoSelector.pop){let qq1=null;for(n=0;n<calystoSelector.length;n++){let tmp2=Calysto.DomQuery.FromSelector(calystoSelector[n]);qq1=qq1?qq1.Concat(tmp2).AsDomQuery():tmp2}return qq1||DomQuery.FromArray([])}if(calystoSelector&&calystoSelector.length>0&&calystoSelector[0]&&calystoSelector[0].nodeType>0){let qq1=null;for(n=0;n<calystoSelector.length;n++){let tmp2=Calysto.DomQuery.FromSelector(calystoSelector[n]);qq1=qq1?qq1.Concat(tmp2).AsDomQuery():tmp2}return qq1||DomQuery.FromArray([])}if(calystoSelector){return DomQuery.FromArray([calystoSelector])};throw new Error("Unknown calystoSelector in GetDomNodesEnumerable");}static FromXml(xmlString){var xmlDocument=ParseXmlString(xmlString),docEl=xmlDocument.documentElement;return DomQuery.FromArray([docEl])}static FromHtml(htmlString){var arr=Calysto.Utility.Dom.ConvertToElementsArray(htmlString);return DomQuery.FromArray(arr)}static CreateElement(tagName){return DomQuery.FromArray([document.createElement(tagName)])}}Calysto.DomQuery=DomQuery}(Calysto||(Calysto={})),$$calysto=Calysto.DomQuery.FromSelector,function(Calysto){var Colorspace;(function(Colorspace){function toInt(str,def,min,max){var n=parseFloat(str);return isNaN(n)||!isFinite(n)?def:(typeof str=="string"&&str.indexOf("%")>0&&(n=n/100),n<min)?min:n>max?max:n}function pad(val,len){for(val=String(val),len=len||2;val.length<len;){val="0"+val};return val}Colorspace.NamedColors={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgrey:"#a9a9a9",darkgreen:"#006400",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",grey:"#808080",green:"#008000",greenyellow:"#adff2f",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgrey:"#d3d3d3",lightgreen:"#90ee90",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370d8",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#d87093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"};let ColorConverter;(function(ColorConverter){function ParseToRGB(colorStr){var hex,arr,str,i;if(colorStr&&(hex=Colorspace.NamedColors[colorStr])&&hex.indexOf("#")==0){return ColorConverter.ParseToRGB(hex)};if(colorStr.indexOf("rgb")==0){arr=colorStr.match(new RegExp("[\\d\\.]+","ig"));return new RGB(arr[0],arr[1],arr[2],arr[3])}if(colorStr.indexOf("hsl")==0){arr=colorStr.match(new RegExp("[\\d\\.\\%]+","ig"));return new HSL(arr[0],arr[1],arr[2],arr[3]).ToRGB()}if(colorStr.indexOf("#")==0){str=colorStr.substr(1);let h=str.match(new RegExp("(.{"+str.length/3+"})","g"));for(i=0;i<h.length;i++){h[i]=parseInt(h[i].length==1?h[i]+h[i]:h[i],16)};return new RGB(h[0],h[1],h[2],h[3])}throw Error(colorStr+" can not be parsed to RGB color");}ColorConverter.ParseToRGB=ParseToRGB})(ColorConverter=Colorspace.ColorConverter||(Colorspace.ColorConverter={}));class HSL{constructor(hue,saturation,luminance,alpha){this.h=(parseInt(hue)||0)%360,this.s=toInt(saturation,1,0,1),this.l=toInt(luminance,.5,0,1),this.a=toInt(alpha,1,0,1)}static Parse(colorStr){var arr,rgba;if(colorStr.indexOf("hsl")==0){arr=colorStr.match(new RegExp("[\\d\\.\\%]+","ig"));return new HSL(arr[0],arr[1],arr[2],arr[3])}rgba=ColorConverter.ParseToRGB(colorStr);return rgba.ToHSL()}Clone(){return new HSL(this.h,this.s,this.l,this.a)}Set(fn){fn(this);return this}ToHslString(){var hasAlpha=this.a!=1&&(this.a>0||this.a===0),str="hsl";hasAlpha&&(str+="a"),str+="("+this.h+","+this.s*100+"%,"+this.l*100+"%",hasAlpha&&(str+=","+this.a),str+=")";return str}ToRGB(){var hsla=this,h=hsla.h/360,s=hsla.s,v=hsla.l,a=hsla.a;if(s==0){return new RGB(v*255,v*255,v*255,a)};var var_h=h*6,var_i=Math.floor(var_h),var_1=v*(1-s),var_2=v*(1-s*(var_h-var_i)),var_3=v*(1-s*(1-(var_h-var_i))),var_r,var_g,var_b;var_i==0?(var_r=v,var_g=var_3,var_b=var_1):var_i==1?(var_r=var_2,var_g=v,var_b=var_1):var_i==2?(var_r=var_1,var_g=v,var_b=var_3):var_i==3?(var_r=var_1,var_g=var_2,var_b=v):var_i==4?(var_r=var_3,var_g=var_1,var_b=v):(var_r=v,var_g=var_1,var_b=var_2);return new RGB(var_r*255,var_g*255,var_b*255,a)}}Colorspace.HSL=HSL;class RGB{constructor(r,g,b,alpha){this.r=Math.round(toInt(r,255,0,255)),this.g=Math.round(toInt(g,255,0,255)),this.b=Math.round(toInt(b,255,0,255)),this.a=toInt(alpha,1,0,1)}static Parse(colorStr){if(colorStr.indexOf("rgb")){var arr=colorStr.match(new RegExp("[\\d\\.]+","ig"));return new RGB(arr[0],arr[1],arr[2],arr[3])}return ColorConverter.ParseToRGB(colorStr)}Clone(){return new RGB(this.r,this.g,this.b,this.a)}Set(fn){fn(this);return this}ToRgbString(){var hasAlpha=this.a!=1&&(this.a>0||this.a===0),str="rgb";hasAlpha&&(str+="a"),str+="("+this.r+","+this.g+","+this.b,hasAlpha&&(str+=","+this.a),str+=")";return str}ToHexString(){return"#"+pad(Number(Math.round(this.r||0)).toString(16),2)+pad(Number(Math.round(this.g||0)).toString(16),2)+pad(Number(Math.round(this.b||0)).toString(16),2)}ToHSL(){var rgba=this,result={h:NaN,s:NaN,l:NaN,a:NaN},r=rgba.r/255,g=rgba.g/255,b=rgba.b/255;result.a=rgba.a;var minVal=Math.min(r,g,b),maxVal=Math.max(r,g,b),delta=maxVal-minVal;if(result.l=maxVal,delta==0){result.h=0,result.s=0}else{result.s=delta/maxVal;var del_R=((maxVal-r)/6+delta/2)/delta,del_G=((maxVal-g)/6+delta/2)/delta,del_B=((maxVal-b)/6+delta/2)/delta;r==maxVal?result.h=del_B-del_G:g==maxVal?result.h=1/3+del_R-del_B:b==maxVal&&(result.h=2/3+del_G-del_R),result.h<0&&(result.h+=1),result.h>1&&(result.h-=1)}result.h=result.h*360,result.s=result.s,result.l=result.l;return new HSL(result.h,result.s,result.l,result.a)}ToCMYK(){var RGB=this,result={k:NaN,c:NaN,m:NaN,y:NaN},r=RGB.r/255,g=RGB.g/255,b=RGB.b/255;result.k=Math.min(1-r,1-g,1-b),result.c=(1-r-result.k)/(1-result.k),result.m=(1-g-result.k)/(1-result.k),result.y=(1-b-result.k)/(1-result.k),result.c=Math.round(result.c*100),result.m=Math.round(result.m*100),result.y=Math.round(result.y*100),result.k=Math.round(result.k*100);return new CMYK(result.c,result.m,result.y,result.k)}}Colorspace.RGB=RGB;class CMYK{constructor(c,m,y,k){this.c=toInt(c,100,0,100),this.m=toInt(m,100,0,100),this.y=toInt(y,100,0,100),this.k=toInt(k,100,0,100)}ToRGB(){var CMYK=this,result={},c=CMYK.c/100,m=CMYK.m/100,y=CMYK.y/100,k=CMYK.k/100;result.r=1-Math.min(1,c*(1-k)+k),result.g=1-Math.min(1,m*(1-k)+k),result.b=1-Math.min(1,y*(1-k)+k),result.r=Math.round(result.r*255),result.g=Math.round(result.g*255),result.b=Math.round(result.b*255);return new RGB(result.r,result.g,result.b,result.a)}}Colorspace.CMYK=CMYK})(Colorspace=Calysto.Colorspace||(Calysto.Colorspace={}))}(Calysto||(Calysto={})),function(Calysto){let EasingHelper;(function(EasingHelper){function InvokeEasing(easingName,startValue,finalValue,currentTimeFraction){currentTimeFraction<0&&(currentTimeFraction=0),currentTimeFraction>1&&(currentTimeFraction=1);var easingFunc=null;if(typeof easingName=="string"){easingFunc=easings[easingName]}else if(typeof easingName=="function"){throw new Error("Easing function not supported: "+easingName);}if(!easingFunc){throw new Error("Unknown easing function: "+easingName);}return easingFunc(currentTimeFraction,currentTimeFraction*100,startValue,finalValue-startValue,100)}const easings={linear:function(p,n,firstNum,diff){return firstNum+diff*p},swing:function(p,n,firstNum,diff){return(-Math.cos(p*Math.PI)/2+.5)*diff+firstNum},easeInQuad:function(x,t,b,c,d){return c*(t/=d)*t+b},easeOutQuad:function(x,t,b,c,d){return-c*(t/=d)*(t-2)+b},easeInOutQuad:function(x,t,b,c,d){return(t/=d/2)<1?c/2*t*t+b:-c/2*(--t*(t-2)-1)+b},easeInCubic:function(x,t,b,c,d){return c*(t/=d)*t*t+b},easeOutCubic:function(x,t,b,c,d){return c*((t=t/d-1)*t*t+1)+b},easeInOutCubic:function(x,t,b,c,d){return(t/=d/2)<1?c/2*t*t*t+b:c/2*((t-=2)*t*t+2)+b},easeInQuart:function(x,t,b,c,d){return c*(t/=d)*t*t*t+b},easeOutQuart:function(x,t,b,c,d){return-c*((t=t/d-1)*t*t*t-1)+b},easeInOutQuart:function(x,t,b,c,d){return(t/=d/2)<1?c/2*t*t*t*t+b:-c/2*((t-=2)*t*t*t-2)+b},easeInQuint:function(x,t,b,c,d){return c*(t/=d)*t*t*t*t+b},easeOutQuint:function(x,t,b,c,d){return c*((t=t/d-1)*t*t*t*t+1)+b},easeInOutQuint:function(x,t,b,c,d){return(t/=d/2)<1?c/2*t*t*t*t*t+b:c/2*((t-=2)*t*t*t*t+2)+b},easeInSine:function(x,t,b,c,d){return-c*Math.cos(t/d*(Math.PI/2))+c+b},easeOutSine:function(x,t,b,c,d){return c*Math.sin(t/d*(Math.PI/2))+b},easeInOutSine:function(x,t,b,c,d){return-c/2*(Math.cos(Math.PI*t/d)-1)+b},easeInExpo:function(x,t,b,c,d){return t==0?b:c*Math.pow(2,10*(t/d-1))+b},easeOutExpo:function(x,t,b,c,d){return t==d?b+c:c*(-Math.pow(2,-10*t/d)+1)+b},easeInOutExpo:function(x,t,b,c,d){return t==0?b:t==d?b+c:(t/=d/2)<1?c/2*Math.pow(2,10*(t-1))+b:c/2*(-Math.pow(2,-10*--t)+2)+b},easeInCirc:function(x,t,b,c,d){return-c*(Math.sqrt(1-(t/=d)*t)-1)+b},easeOutCirc:function(x,t,b,c,d){return c*Math.sqrt(1-(t=t/d-1)*t)+b},easeInOutCirc:function(x,t,b,c,d){return(t/=d/2)<1?-c/2*(Math.sqrt(1-t*t)-1)+b:c/2*(Math.sqrt(1-(t-=2)*t)+1)+b},easeInElastic:function(x,t,b,c,d){var s=1.70158,p=0,a=c;if(t==0){return b};if((t/=d)==1){return b+c};p||(p=d*.3),a<Math.abs(c)?(a=c,s=p/4):s=p/(2*Math.PI)*Math.asin(c/a);return-(a*Math.pow(2,10*(t-=1))*Math.sin((t*d-s)*2*Math.PI/p))+b},easeOutElastic:function(x,t,b,c,d){var s=1.70158,p=0,a=c;if(t==0){return b};if((t/=d)==1){return b+c};p||(p=d*.3),a<Math.abs(c)?(a=c,s=p/4):s=p/(2*Math.PI)*Math.asin(c/a);return a*Math.pow(2,-10*t)*Math.sin((t*d-s)*2*Math.PI/p)+c+b},easeInOutElastic:function(x,t,b,c,d){var s=1.70158,p=0,a=c;return t==0?b:(t/=d/2)==2?b+c:(p||(p=d*.3*1.5),a<Math.abs(c)?(a=c,s=p/4):s=p/(2*Math.PI)*Math.asin(c/a),t<1)?-.5*a*Math.pow(2,10*(t-=1))*Math.sin((t*d-s)*2*Math.PI/p)+b:a*Math.pow(2,-10*(t-=1))*Math.sin((t*d-s)*2*Math.PI/p)*.5+c+b},easeInBack:function(x,t,b,c,d,s){s==undefined&&(s=1.70158);return c*(t/=d)*t*((s+1)*t-s)+b},easeOutBack:function(x,t,b,c,d,s){s==undefined&&(s=1.70158);return c*((t=t/d-1)*t*((s+1)*t+s)+1)+b},easeInOutBack:function(x,t,b,c,d,s){return(s==undefined&&(s=1.70158),(t/=d/2)<1)?c/2*t*t*(((s*=1.525)+1)*t-s)+b:c/2*((t-=2)*t*(((s*=1.525)+1)*t+s)+2)+b},easeInBounce:function(x,t,b,c,d){return c-this.easeOutBounce(x,d-t,0,c,d)+b},easeOutBounce:function(x,t,b,c,d){return(t/=d)<1/2.75?c*7.5625*t*t+b:t<2/2.75?c*(7.5625*(t-=1.5/2.75)*t+.75)+b:t<2.5/2.75?c*(7.5625*(t-=2.25/2.75)*t+.9375)+b:c*(7.5625*(t-=2.625/2.75)*t+.984375)+b},easeInOutBounce:function(x,t,b,c,d){return t<d/2?this.easeInBounce(x,t*2,0,c,d)*.5+b:this.easeOutBounce(x,t*2-d,0,c,d)*.5+c*.5+b}};EasingHelper.InvokeEasing=InvokeEasing})(EasingHelper||(EasingHelper={}));let AnimationFrameHelper;(function(AnimationFrameHelper){function RequestAnimationFrame(fnCallback){return _ff(()=>fnCallback())}var _ff=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame;if(!_ff){Calysto.Core.IsDebugDefined&&console.log("requestAnimationFrame not supported");var _timeoutId,_buffer=[],fnInvoke=()=>{var arr=_buffer,n1;for(_buffer=[],n1=0;n1<arr.length;n1++){arr[n1]()}},fnStart=()=>{_timeoutId||(_timeoutId=setTimeout(()=>{_timeoutId=null,fnInvoke()},20))};_ff=fnCallback=>{_buffer.push(fnCallback),fnStart()}}AnimationFrameHelper.RequestAnimationFrame=RequestAnimationFrame})(AnimationFrameHelper||(AnimationFrameHelper={}));class AnimItem{}let AnimState;(function(AnimState){AnimState[AnimState.Unstarted=0]="Unstarted",AnimState[AnimState.Running=1]="Running",AnimState[AnimState.Completed=2]="Completed",AnimState[AnimState.Aborted=3]="Aborted"})(AnimState||(AnimState={}));class Animator{constructor(){this.durationMs=400,this.easing="linear",this.state=AnimState.Unstarted,this.items=[]}static RequestAnimationFrame(onAcquired){return AnimationFrameHelper.RequestAnimationFrame(onAcquired)}Items(){return this.items.ToArray()}ToList(){return new Calysto.List(this.items.Select(o=>o.element).Where(o=>!!o)).ToList()}AsDomQuery(){return this.ToList().AsDomQuery()}AddElement(element,styleName,finalValue,onTick){var aa=new AnimItem;aa.element=element,aa.elStyleName=styleName,aa.elFinalValue=finalValue,aa.onTick=onTick,this.items.push(aa);return this}AddValue(startValue,finalValue,onTick){var aa=new AnimItem;aa.numStart=startValue,aa.numFinal=finalValue,aa.onTick=onTick,aa.isNumValue=true,this.items.push(aa);return this}Clear(){this.items.Clear();return this}Duration(durationMs=400){(durationMs||0)>0||(durationMs=1),this.durationMs=durationMs;return this}OnProgress(callback){this.onProgress=callback;return this}OnStart(callback){this.onStart=callback;return this}OnComplete(callback){this.onComplete=callback;return this}OnAbort(callback){this.onAbort=callback;return this}Easing(easingType){this.easing=typeof easingType=="string"?easingType:"linear";return this}initializeFirstRun(item){var vvv,dd,ccc,curr1;if(item.element&&Calysto.Type.TypeInspector.IsNullOrUndefined(item.elFinalValue)){throw new Error("Error in Animator, no elFinalValue");}else if(item.element&&item.elStyleName&&item.elStyleName.Contains("color",true)){vvv=Calysto.Utility.Dom.GetComputedStyle(item.element,item.elStyleName).StyleValue,item.rgbStart=Calysto.Colorspace.ColorConverter.ParseToRGB(vvv),dd=document.createElement("div"),dd.style.position="absolute",dd.style.width="1px",dd.style.height="1px",dd.style.zIndex="-1000",document.body.appendChild(dd),dd.style.backgroundColor=item.elFinalValue,ccc=Calysto.Utility.Dom.GetComputedStyle(dd,"backgroundColor").StyleValue,dd.parentNode&&dd.parentNode.removeChild(dd),item.rgbFinal=Calysto.Colorspace.ColorConverter.ParseToRGB(ccc),item.rgbCurrent=item.rgbStart.Clone()}else if(item.element&&item.elStyleName=="clip"){curr1=Calysto.Utility.Dom.GetClip(item.element),item.clipStart=curr1,item.clipCurrent=Object.assign({},curr1),item.clipFinal=Calysto.Utility.Dom.CalculateClip(item.element,item.elFinalValue)}else if(item.element&&item.elStyleName=="transform"){var currList=(Calysto.Utility.Dom.SelectTransform(item.element)||"").split(")").Where(o=>!!o).Select(o=>o.Trim()+")").Select(o=>({statement:o,kind:((o||"").match(new RegExp("[\\w]+"))||[])[0],args:((o||"").match(new RegExp("([\\-]?[\\.\\d]+)","ig"))||[]).Select(kk=>parseFloat(kk))})),finalList=item.elFinalValue.split(")").Where(o=>!!o).Select(o=>o.Trim()+")").Select(o=>({statement:o,kind:((o||"").match(new RegExp("[\\w]+"))||[])[0],args:((o||"").match(new RegExp("([\\-]?[\\.\\d]+)","ig"))||[]).Select(kk=>parseFloat(kk))})),mainList=finalList.Select(finalVal=>{var curr=currList.Where(cc=>cc.kind==finalVal.kind).pop(),finalHasMoreArgs;for(curr||(curr={statement:finalVal.statement,kind:finalVal.kind,args:finalVal.args.Select(()=>finalVal.kind.indexOf("scale")==0?1:0)}),finalHasMoreArgs=false;curr.args.length<finalVal.args.length;){finalHasMoreArgs=true,curr.args.push(curr.args.length>0?curr.args[curr.args.length-1]:finalVal.kind.indexOf("scale")==0?1:0)};while(curr.args.length>finalVal.args.length){finalVal.args.push(finalVal.args.length>0?finalVal.args[finalVal.args.length-1]:finalVal.kind.indexOf("scale")==0?1:0)};return{startValuesArr:curr.args,finalValuesArr:finalVal.args,stringFormat:finalHasMoreArgs?finalVal.statement:curr.statement}}),index=0;item.transformStart=mainList.AsEnumerable().SelectMany(o=>o.startValuesArr).ToArray(),item.transformCurrent=item.transformStart.ToArray(),item.transformFinal=mainList.AsEnumerable().SelectMany(o=>o.finalValuesArr).ToArray(),item.transformFormat=mainList.Select(o=>o.stringFormat).join(" ").replace(new RegExp("([\\-]?[\\.\\d]+)","ig"),function(){return"{"+index+++"}"})}else if(item.element){let styleItem=Calysto.Utility.Dom.GetComputedStyle(item.element,item.elStyleName);item.numStart=styleItem.NumericValue,item.elUnits||(item.elUnits=typeof item.elFinalValue=="string"&&item.elFinalValue.indexOf("%")>0?"%":styleItem.Units);let originalValue;if(item.elUnits=="%"&&item.elStyleName.indexOf("margin")==0){item.elUnits=null;switch(Calysto.Utility.Dom.ConvertCssNameToCamel(item.elStyleName)){case"marginTop":case"marginBottom":originalValue=item.element.offsetHeight;break;case"marginLeft":case"marginRight":originalValue=item.element.offsetWidth}}if(Calysto.Type.TypeInspector.IsNullOrUndefined(item.elFinalValue)){throw new Error("Error in Animator, finalValue is not defined");}if(item.numFinal=Calysto.Utility.Dom.CalculateNumericValue(styleItem.NumericValue,item.elFinalValue),item.numCurrent=item.numStart,!Calysto.Type.TypeInspector.IsNumber(item.numStart)||!Calysto.Type.TypeInspector.IsNumber(item.numFinal)){throw new Error("Calysto.Animator error, invalid start/stop value. Name: "+item.elStyleName+", styleFinal: "+item.elFinalValue+", numStart: "+item.numStart+", numFinal: "+item.numFinal);}}else item.isNumValue&&(item.numCurrent=item.numStart)}GetCurrent(elapsedTimeMs,startValue,finalValue){return Animator.InvokeEasing(this.easing,startValue,finalValue,elapsedTimeMs/this.durationMs)}TimerTick(firstRun){var isCompleted,elapsedTime,item,val,nn,percent;if(this.state==AnimState.Running){if(isCompleted=false,elapsedTime=0,firstRun){for(this.items=this.items.Where(o=>o.isNumValue||!!o.element&&!!o.elStyleName&&!Calysto.Type.TypeInspector.IsNullOrUndefined(o.elFinalValue)),nn=0;nn<this.items.length;nn++){this.initializeFirstRun(this.items[nn])};this.animateStartTicks=Date.now()}else elapsedTime=Date.now()-(this.animateStartTicks||0),isCompleted=(this.durationMs||0)<=(elapsedTime||0);for(nn=0;nn<this.items.length;nn++){if(item=this.items[nn],item.onTick){item.onTick(this,item.numCurrent)};if(item.rgbStart){Calysto.Collections.ForEach(["r","g","b","a"],o=>{var val=isCompleted?item.rgbFinal[o]:this.GetCurrent(elapsedTime,item.rgbStart[o],item.rgbFinal[o]);item.rgbCurrent[o]=o=="a"?val:Math.floor(val)}),Calysto.Utility.Dom.SetStyleValue(item.element,item.elStyleName,item.rgbCurrent.ToRgbString())}else if(item.clipStart){Calysto.Collections.ForEach(["top","right","bottom","left"],o=>{item.clipCurrent[o]=isCompleted?item.clipFinal[o]:Math.floor(this.GetCurrent(elapsedTime,item.clipStart[o],item.clipFinal[o]))}),Calysto.Utility.Dom.SetClip(item.element,item.clipCurrent)}else if(item.transformStart){for(val=item.transformFormat,nn=0;nn<item.transformCurrent.length;nn++){item.transformCurrent[nn]=isCompleted?item.transformFinal[nn]:this.GetCurrent(elapsedTime,item.transformStart[nn],item.transformFinal[nn]),val=val.replace("{"+nn+"}",item.transformCurrent[nn]+"")};$$calysto(item.element).ApplyTransform(val)}else item.numCurrent=isCompleted?item.numFinal:this.GetCurrent(elapsedTime,item.numStart,item.numFinal),item.element&&((item.elUnits=="px"||item.elUnits=="%")&&(item.numCurrent=Math.round(item.numCurrent)),Calysto.Utility.Dom.SetStyleValue(item.element,item.elStyleName,item.numCurrent,item.elUnits));if(item.onTick){item.onTick(this,item.numCurrent)}}if(this.onProgress){percent=elapsedTime/this.durationMs*100,percent>100&&(percent=100);this.onProgress(this,percent)}if(isCompleted){if(this.state=AnimState.Completed,this.onComplete){this.onComplete(this)}}else Calysto.Animator.RequestAnimationFrame(()=>this.TimerTick(false))}}IsRunning(){return this.state==AnimState.Running}Start(delayMs=0){if(this.IsRunning()){throw new Error("animation is already running");}if(this._delayTimeoutId&&(clearTimeout(this._delayTimeoutId),this._delayTimeoutId=null),delayMs>0){this._delayTimeoutId=setTimeout(()=>this.Start(),delayMs);return this}if(this.state=AnimState.Running,this.onStart){this.onStart(this)};this.TimerTick(true);return this}Abort(){if(this._delayTimeoutId&&(clearTimeout(this._delayTimeoutId),this._delayTimeoutId=null),this.state=AnimState.Aborted,this.onAbort){this.onAbort(this)};return this}}Animator.InvokeEasing=EasingHelper.InvokeEasing,Calysto.Animator=Animator}(Calysto||(Calysto={})),function(Calysto){var Preloaders;(function(Preloaders){function Squares(color="#98c7ef",backColor="#4b84b5",rotateCCV=false){let beginArr=[0,.125,.25,.375,.5,.625,.75,.875],en1=rotateCCV?beginArr.reverse().AsEnumerable().GetEnumerator():beginArr.AsEnumerable().GetEnumerator();return`	<svg class="lds-blocks" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 100 100" preserveAspectRatio="xMidYMid">
		<rect x="17" y="17" width="20" height="20" fill="${backColor}">
			<animate attributeName="fill" values="${color};${backColor};${backColor}" keyTimes="0;0.125;1" dur="1s" repeatCount="indefinite" begin="${en1.GetNext().GetValue()}s" calcMode="discrete"></animate>
		</rect>
		<rect x="40" y="17" width="20" height="20" fill="${backColor}">
			<animate attributeName="fill" values="${color};${backColor};${backColor}" keyTimes="0;0.125;1" dur="1s" repeatCount="indefinite" begin="${en1.GetNext().GetValue()}s" calcMode="discrete"></animate>
		</rect>
		<rect x="63" y="17" width="20" height="20" fill="${backColor}">
			<animate attributeName="fill" values="${color};${backColor};${backColor}" keyTimes="0;0.125;1" dur="1s" repeatCount="indefinite" begin="${en1.GetNext().GetValue()}s" calcMode="discrete"></animate>
		</rect>
		<rect x="63" y="40" width="20" height="20" fill="${backColor}">
			<animate attributeName="fill" values="${color};${backColor};${backColor}" keyTimes="0;0.125;1" dur="1s" repeatCount="indefinite" begin="${en1.GetNext().GetValue()}s" calcMode="discrete"></animate>
		</rect>
		<rect x="63" y="63" width="20" height="20" fill="${backColor}">
			<animate attributeName="fill" values="${color};${backColor};${backColor}" keyTimes="0;0.125;1" dur="1s" repeatCount="indefinite" begin="${en1.GetNext().GetValue()}s" calcMode="discrete"></animate>
		</rect>
		<rect x="40" y="63" width="20" height="20" fill="${backColor}">
			<animate attributeName="fill" values="${color};${backColor};${backColor}" keyTimes="0;0.125;1" dur="1s" repeatCount="indefinite" begin="${en1.GetNext().GetValue()}s" calcMode="discrete"></animate>
		</rect>
		<rect x="17" y="63" width="20" height="20" fill="${backColor}">
			<animate attributeName="fill" values="${color};${backColor};${backColor}" keyTimes="0;0.125;1" dur="1s" repeatCount="indefinite" begin="${en1.GetNext().GetValue()}s" calcMode="discrete"></animate>
		</rect>
		<rect x="17" y="40" width="20" height="20" fill="${backColor}">
			<animate attributeName="fill" values="${color};${backColor};${backColor}" keyTimes="0;0.125;1" dur="1s" repeatCount="indefinite" begin="${en1.GetNext().GetValue()}s" calcMode="discrete"></animate>
		</rect>
	</svg>`}function Snake(color="black",rotateCCV=false){let values="0 0 0; 45 0 0; 90 0 0; 135 0 0; 180 0 0; 225 0 0 ; 270 0 0; 315 0 0; 360 0 0",rArr=[5.375,6.438,8.063,10.063,10.75,12.531,14.344,16],en1=rArr.AsEnumerable().GetEnumerator();rotateCCV&&(values=values.split(";").reverse().join(";"),en1=rArr.reverse().AsEnumerable().GetEnumerator());return`<svg class="snake-main" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 128 128" x="384" y="0">
				<circle cx="16" cy="64" r="${en1.GetNext().GetValue()}" fill="${color}" />
				<circle cx="16" cy="64" r="${en1.GetNext().GetValue()}" fill="${color}" transform="rotate(45 64 64)" />
				<circle cx="16" cy="64" r="${en1.GetNext().GetValue()}" fill="${color}" transform="rotate(90 64 64)" />
				<circle cx="16" cy="64" r="${en1.GetNext().GetValue()}" fill="${color}" transform="rotate(135 64 64)" />
				<circle cx="16" cy="64" r="${en1.GetNext().GetValue()}" fill="${color}" transform="rotate(180 64 64)" />
				<circle cx="16" cy="64" r="${en1.GetNext().GetValue()}" fill="${color}" transform="rotate(225 64 64)" />
				<circle cx="16" cy="64" r="${en1.GetNext().GetValue()}" fill="${color}" transform="rotate(270 64 64)" />
				<circle cx="16" cy="64" r="${en1.GetNext().GetValue()}" fill="${color}" transform="rotate(315 64 64)" />
				<animateTransform attributeName="transform" type="rotate" calcMode="discrete" values="${values}" keyTimes="0;0.125;0.25;0.375;0.5;0.625;0.75;0.875;1" dur="1s" begin="0s" repeatCount="indefinite"></animateTransform>
			</svg>`}function BallsRing(color="black",rotateCCV=false){let values="0 0 0; 45 0 0; 90 0 0; 135 0 0; 180 0 0; 225 0 0 ; 270 0 0; 315 0 0; 360 0 0",aArr=[.1,.2,.35,.5,.7,.8,.9],en1=aArr.AsEnumerable().GetEnumerator();rotateCCV&&(values=values.split(";").reverse().join(";"),en1=aArr.reverse().AsEnumerable().GetEnumerator());let main1=Calysto.Colorspace.ColorConverter.ParseToRGB(color);return`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 128 128" x="448" y="0">
			<circle cx="16" cy="64" r="16" fill="${main1.ToRgbString()}" />
			<circle cx="16" cy="64" r="16" fill="${main1.Set(o=>o.a=en1.GetNext().GetValue()).ToRgbString()}" transform="rotate(45, 64, 64)" />
			<circle cx="16" cy="64" r="16" fill="${main1.Set(o=>o.a=en1.GetNext().GetValue()).ToRgbString()}" transform="rotate(90,64,64)" />
			<circle cx="16" cy="64" r="16" fill="${main1.Set(o=>o.a=en1.GetNext().GetValue()).ToRgbString()}" transform="rotate(135,64,64)" />
			<circle cx="16" cy="64" r="16" fill="${main1.Set(o=>o.a=en1.GetNext().GetValue()).ToRgbString()}" transform="rotate(180,64,64)" />
			<circle cx="16" cy="64" r="16" fill="${main1.Set(o=>o.a=en1.GetNext().GetValue()).ToRgbString()}" transform="rotate(225,64,64)" />
			<circle cx="16" cy="64" r="16" fill="${main1.Set(o=>o.a=en1.GetNext().GetValue()).ToRgbString()}" transform="rotate(270,64,64)" />
			<circle cx="16" cy="64" r="16" fill="${main1.Set(o=>o.a=en1.GetNext().GetValue()).ToRgbString()}" transform="rotate(315,64,64)" />
			<animateTransform attributeName="transform" type="rotate" calcMode="discrete" values="${values}" keyTimes="0;0.125;0.25;0.375;0.5;0.625;0.75;0.875;1" dur="1s" begin="0s" repeatCount="indefinite"></animateTransform>
		</svg>`}function MsRing(color="black",backColor="gainsboro",rotateCCV=false){let values="0 64 64; 45 64 64; 90 64 64; 135 64 64; 180 64 64; 225 64 64; 270 64 64; 315 64 64; 360 64 64";rotateCCV&&(values=values.split(";").reverse().join(";"));return`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 128 128" x="576" y="0">
			<path d="M38.52 33.37L21.36 16.2A63.6 63.6 0 0 1 59.5.16v24.3a39.5 39.5 0 0 0-20.98 8.92z" fill="${backColor}" />
			<path d="M38.52 33.37L21.36 16.2A63.6 63.6 0 0 1 59.5.16v24.3a39.5 39.5 0 0 0-20.98 8.92z" fill="${backColor}" transform="rotate(45 64 64)" />
			<path d="M38.52 33.37L21.36 16.2A63.6 63.6 0 0 1 59.5.16v24.3a39.5 39.5 0 0 0-20.98 8.92z" fill="${backColor}" transform="rotate(90 64 64)" />
			<path d="M38.52 33.37L21.36 16.2A63.6 63.6 0 0 1 59.5.16v24.3a39.5 39.5 0 0 0-20.98 8.92z" fill="${backColor}" transform="rotate(135 64 64)" />
			<path d="M38.52 33.37L21.36 16.2A63.6 63.6 0 0 1 59.5.16v24.3a39.5 39.5 0 0 0-20.98 8.92z" fill="${backColor}" transform="rotate(180 64 64)" />
			<path d="M38.52 33.37L21.36 16.2A63.6 63.6 0 0 1 59.5.16v24.3a39.5 39.5 0 0 0-20.98 8.92z" fill="${backColor}" transform="rotate(225 64 64)" />
			<path d="M38.52 33.37L21.36 16.2A63.6 63.6 0 0 1 59.5.16v24.3a39.5 39.5 0 0 0-20.98 8.92z" fill="${backColor}" transform="rotate(270 64 64)" />
			<path d="M38.52 33.37L21.36 16.2A63.6 63.6 0 0 1 59.5.16v24.3a39.5 39.5 0 0 0-20.98 8.92z" fill="${backColor}" transform="rotate(315 64 64)" />
			<path d="M38.52 33.37L21.36 16.2A63.6 63.6 0 0 1 59.5.16v24.3a39.5 39.5 0 0 0-20.98 8.92z" fill="${color}">
				<animateTransform attributeName="transform" type="rotate" calcMode="discrete" values="${values}" keyTimes="0;0.125;0.25;0.375;0.5;0.625;0.75;0.875;1" dur="1s" begin="0s" repeatCount="indefinite"></animateTransform>
			</path>
		</svg>`}function TwoArrows(color="black"){return`<svg xmlns="http://www.w3.org/2000/svg" viewBox="10 10 108 108" x="704" y="0">
			<path fill="${color}" d="M109.25 55.5h-36l12-12a29.54 29.54 0 0 0-49.53 12H18.75A46.04 46.04 0 0 1 96.9 31.84l12.35-12.34v36zm-90.5 17h36l-12 12a29.54 29.54 0 0 0 49.53-12h16.97A46.04 46.04 0 0 1 31.1 96.16L18.74 108.5v-36z">
			</path>
			<animateTransform attributeName="transform" type="rotate" calcMode="linear" values="0 0 0;360 0 0" keyTimes="0;1" dur="1s" begin="0s" repeatCount="indefinite"></animateTransform>
		</svg>`}function Flower(color="black",rotateCCV=false){let main1=Calysto.Colorspace.ColorConverter.ParseToRGB(color),aArr=[.1,.1,.1,.1,.2,.3,.4,.5,.6,.7,.8,.9],en1=aArr.AsEnumerable().GetEnumerator(),values="0 0 0;30 0 0;60 0 0;90 0 0;120 0 0;150 0 0;180 0 0;210 0 0;240 0 0;270 0 0;300 0 0;330 0 0;360 0 0";rotateCCV&&(values=values.split(";").reverse().join(";"),en1=aArr.reverse().AsEnumerable().GetEnumerator());return`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 128 128" x="640" y="0">
			<path d="M59.6 0h8v40h-8V0z" fill="${main1.ToRgbString()}" />
			<path d="M59.6 0h8v40h-8V0z" fill="${main1.Set(o=>o.a=en1.GetNext().GetValue()).ToRgbString()}" transform="rotate(30 64 64)" />
			<path d="M59.6 0h8v40h-8V0z" fill="${main1.Set(o=>o.a=en1.GetNext().GetValue()).ToRgbString()}" transform="rotate(60 64 64)" />
			<path d="M59.6 0h8v40h-8V0z" fill="${main1.Set(o=>o.a=en1.GetNext().GetValue()).ToRgbString()}" transform="rotate(90 64 64)" />
			<path d="M59.6 0h8v40h-8V0z" fill="${main1.Set(o=>o.a=en1.GetNext().GetValue()).ToRgbString()}" transform="rotate(120 64 64)" />
			<path d="M59.6 0h8v40h-8V0z" fill="${main1.Set(o=>o.a=en1.GetNext().GetValue()).ToRgbString()}" transform="rotate(150 64 64)" />
			<path d="M59.6 0h8v40h-8V0z" fill="${main1.Set(o=>o.a=en1.GetNext().GetValue()).ToRgbString()}" transform="rotate(180 64 64)" />
			<path d="M59.6 0h8v40h-8V0z" fill="${main1.Set(o=>o.a=en1.GetNext().GetValue()).ToRgbString()}" transform="rotate(210 64 64)" />
			<path d="M59.6 0h8v40h-8V0z" fill="${main1.Set(o=>o.a=en1.GetNext().GetValue()).ToRgbString()}" transform="rotate(240 64 64)" />
			<path d="M59.6 0h8v40h-8V0z" fill="${main1.Set(o=>o.a=en1.GetNext().GetValue()).ToRgbString()}" transform="rotate(270 64 64)" />
			<path d="M59.6 0h8v40h-8V0z" fill="${main1.Set(o=>o.a=en1.GetNext().GetValue()).ToRgbString()}" transform="rotate(300 64 64)" />
			<path d="M59.6 0h8v40h-8V0z" fill="${main1.Set(o=>o.a=en1.GetNext().GetValue()).ToRgbString()}" transform="rotate(330 64 64)" />
			<animateTransform attributeName="transform" type="rotate" calcMode="discrete" values="${values}" keyTimes="0;0.08;0.16;0.25;0.33;0.42;0.5;0.58;0.67;0.75;0.83;0.92;1" dur="1s" begin="0s" repeatCount="indefinite"></animateTransform>
		</svg>`}function ThreeArcs(color="black",rotateCCV=false){return`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100" preserveAspectRatio="xMidYMid" class="lds-dual-ring">
			<circle cx="50" cy="50" fill="none" stroke-linecap="round" r="40" stroke-width="15" stroke="${color}" stroke-dasharray="42.411500823462205 42.411500823462205" transform="rotate(60 50 50)">
				<animateTransform attributeName="transform" type="rotate" calcMode="linear" values="${rotateCCV?360:0} 50 50;${rotateCCV?0:360} 50 50" keyTimes="0;1" dur="1s" begin="0s" repeatCount="indefinite"></animateTransform>
			</circle>
		</svg>`}function ThreeDots(color="black"){return`<svg viewBox="0 -45 120 120" xmlns="http://www.w3.org/2000/svg" fill="${color}">
    <circle cx="15" cy="15" r="15">
        <animate attributeName="r" from="15" to="15"
                 begin="0s" dur="0.8s"
                 values="15;9;15" calcMode="linear"
                 repeatCount="indefinite" />
        <animate attributeName="fill-opacity" from="1" to="1"
                 begin="0s" dur="0.8s"
                 values="1;.5;1" calcMode="linear"
                 repeatCount="indefinite" />
    </circle>
    <circle cx="60" cy="15" r="9" fill-opacity="0.3">
        <animate attributeName="r" from="9" to="9"
                 begin="0s" dur="0.8s"
                 values="9;15;9" calcMode="linear"
                 repeatCount="indefinite" />
        <animate attributeName="fill-opacity" from="0.5" to="0.5"
                 begin="0s" dur="0.8s"
                 values=".5;1;.5" calcMode="linear"
                 repeatCount="indefinite" />
    </circle>
    <circle cx="105" cy="15" r="15">
        <animate attributeName="r" from="15" to="15"
                 begin="0s" dur="0.8s"
                 values="15;9;15" calcMode="linear"
                 repeatCount="indefinite" />
        <animate attributeName="fill-opacity" from="1" to="1"
                 begin="0s" dur="0.8s"
                 values="1;.5;1" calcMode="linear"
                 repeatCount="indefinite" />
    </circle>
</svg>
`}function BallTriangle(color="black"){return`<svg viewBox="0 0 57 57" xmlns="http://www.w3.org/2000/svg" stroke="${color}">
    <g fill="none" fill-rule="evenodd">
        <g transform="translate(1 1)" stroke-width="2">
            <circle cx="5" cy="50" r="5">
                <animate attributeName="cy"
                     begin="0s" dur="2.2s"
                     values="50;5;50;50"
                     calcMode="linear"
                     repeatCount="indefinite" />
                <animate attributeName="cx"
                     begin="0s" dur="2.2s"
                     values="5;27;49;5"
                     calcMode="linear"
                     repeatCount="indefinite" />
            </circle>
            <circle cx="27" cy="5" r="5">
                <animate attributeName="cy"
                     begin="0s" dur="2.2s"
                     from="5" to="5"
                     values="5;50;50;5"
                     calcMode="linear"
                     repeatCount="indefinite" />
                <animate attributeName="cx"
                     begin="0s" dur="2.2s"
                     from="27" to="27"
                     values="27;49;5;27"
                     calcMode="linear"
                     repeatCount="indefinite" />
            </circle>
            <circle cx="49" cy="50" r="5">
                <animate attributeName="cy"
                     begin="0s" dur="2.2s"
                     values="50;50;5;50"
                     calcMode="linear"
                     repeatCount="indefinite" />
                <animate attributeName="cx"
                     from="49" to="49"
                     begin="0s" dur="2.2s"
                     values="49;5;27;49"
                     calcMode="linear"
                     repeatCount="indefinite" />
            </circle>
        </g>
    </g>
</svg>`}function Bars(color="black"){return`<svg viewBox="0 0 135 140" xmlns="http://www.w3.org/2000/svg" fill="${color}">
    <rect y="10" width="15" height="120" rx="6">
        <animate attributeName="height"
             begin="0.5s" dur="1s"
             values="120;110;100;90;80;70;60;50;40;140;120" calcMode="linear"
             repeatCount="indefinite" />
        <animate attributeName="y"
             begin="0.5s" dur="1s"
             values="10;15;20;25;30;35;40;45;50;0;10" calcMode="linear"
             repeatCount="indefinite" />
    </rect>
    <rect x="30" y="10" width="15" height="120" rx="6">
        <animate attributeName="height"
             begin="0.25s" dur="1s"
             values="120;110;100;90;80;70;60;50;40;140;120" calcMode="linear"
             repeatCount="indefinite" />
        <animate attributeName="y"
             begin="0.25s" dur="1s"
             values="10;15;20;25;30;35;40;45;50;0;10" calcMode="linear"
             repeatCount="indefinite" />
    </rect>
    <rect x="60" width="15" height="140" rx="6">
        <animate attributeName="height"
             begin="0s" dur="1s"
             values="120;110;100;90;80;70;60;50;40;140;120" calcMode="linear"
             repeatCount="indefinite" />
        <animate attributeName="y"
             begin="0s" dur="1s"
             values="10;15;20;25;30;35;40;45;50;0;10" calcMode="linear"
             repeatCount="indefinite" />
    </rect>
    <rect x="90" y="10" width="15" height="120" rx="6">
        <animate attributeName="height"
             begin="0.25s" dur="1s"
             values="120;110;100;90;80;70;60;50;40;140;120" calcMode="linear"
             repeatCount="indefinite" />
        <animate attributeName="y"
             begin="0.25s" dur="1s"
             values="10;15;20;25;30;35;40;45;50;0;10" calcMode="linear"
             repeatCount="indefinite" />
    </rect>
    <rect x="120" y="10" width="15" height="120" rx="6">
        <animate attributeName="height"
             begin="0.5s" dur="1s"
             values="120;110;100;90;80;70;60;50;40;140;120" calcMode="linear"
             repeatCount="indefinite" />
        <animate attributeName="y"
             begin="0.5s" dur="1s"
             values="10;15;20;25;30;35;40;45;50;0;10" calcMode="linear"
             repeatCount="indefinite" />
    </rect>
</svg>
`}function Oval(color="black",backColor="gainsboro",rotateCCV=false){return`<svg viewBox="0 0 38 38" xmlns="http://www.w3.org/2000/svg" stroke="${color}">
    <g fill="none" fill-rule="evenodd">
        <g transform="translate(1 1)" stroke-width="2">
            <circle stroke="${backColor}" stroke-opacity="1" cx="18" cy="18" r="18"/>
            <path d="M36 18c0-9.94-8.06-18-18-18">
                <animateTransform
                    attributeName="transform"
                    type="rotate"
                    from="${rotateCCV?360:0} 18 18"
                    to="${rotateCCV?0:360} 18 18"
                    dur="1s"
                    repeatCount="indefinite"/>
            </path>
        </g>
    </g>
</svg>`}function Messenger(color){return`<svg class="lds-message" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100" preserveAspectRatio="xMidYMid"><g transform="translate(20 50)">
<circle cx="0" cy="0" r="7" fill="${color||"#e15b64"}" transform="scale(0.99275 0.99275)">
  <animateTransform attributeName="transform" type="scale" begin="-0.375s" calcMode="spline" keySplines="0.3 0 0.7 1;0.3 0 0.7 1" values="0;1;0" keyTimes="0;0.5;1" dur="1s" repeatCount="indefinite"></animateTransform>
</circle>
</g><g transform="translate(40 50)">
<circle cx="0" cy="0" r="7" fill="${color||"#f47e60"}" transform="scale(0.773605 0.773605)">
  <animateTransform attributeName="transform" type="scale" begin="-0.25s" calcMode="spline" keySplines="0.3 0 0.7 1;0.3 0 0.7 1" values="0;1;0" keyTimes="0;0.5;1" dur="1s" repeatCount="indefinite"></animateTransform>
</circle>
</g><g transform="translate(60 50)">
<circle cx="0" cy="0" r="7" fill="${color||"#f8b26a"}" transform="scale(0.42525 0.42525)">
  <animateTransform attributeName="transform" type="scale" begin="-0.125s" calcMode="spline" keySplines="0.3 0 0.7 1;0.3 0 0.7 1" values="0;1;0" keyTimes="0;0.5;1" dur="1s" repeatCount="indefinite"></animateTransform>
</circle>
</g><g transform="translate(80 50)">
<circle cx="0" cy="0" r="7" fill="${color||"#abbd81"}" transform="scale(0.113418 0.113418)">
  <animateTransform attributeName="transform" type="scale" begin="0s" calcMode="spline" keySplines="0.3 0 0.7 1;0.3 0 0.7 1" values="0;1;0" keyTimes="0;0.5;1" dur="1s" repeatCount="indefinite"></animateTransform>
</circle>
</g></svg>`}function RotatingBalls(color){return`<svg class="lds-microsoft" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100" preserveAspectRatio="xMidYMid"><g transform="rotate(0)"><circle cx="81.73413361164941" cy="74.35045716034882" fill="${color||"#e15b64"}" r="5" transform="rotate(340.001 49.9999 50)">
  <animateTransform attributeName="transform" type="rotate" calcMode="spline" values="0 50 50;360 50 50" times="0;1" keySplines="0.5 0 0.5 1" repeatCount="indefinite" dur="1.5s" begin="0s"></animateTransform>
</circle><circle cx="74.35045716034882" cy="81.73413361164941" fill="${color||"#f47e60"}" r="5" transform="rotate(348.352 50.0001 50.0001)">
  <animateTransform attributeName="transform" type="rotate" calcMode="spline" values="0 50 50;360 50 50" times="0;1" keySplines="0.5 0 0.5 1" repeatCount="indefinite" dur="1.5s" begin="-0.0625s"></animateTransform>
</circle><circle cx="65.3073372946036" cy="86.95518130045147" fill="${color||"#f8b26a"}" r="5" transform="rotate(354.236 50 50)">
  <animateTransform attributeName="transform" type="rotate" calcMode="spline" values="0 50 50;360 50 50" times="0;1" keySplines="0.5 0 0.5 1" repeatCount="indefinite" dur="1.5s" begin="-0.125s"></animateTransform>
</circle><circle cx="55.22104768880207" cy="89.65779445495241" fill="${color||"#abbd81"}" r="5" transform="rotate(357.958 50.0002 50.0002)">
  <animateTransform attributeName="transform" type="rotate" calcMode="spline" values="0 50 50;360 50 50" times="0;1" keySplines="0.5 0 0.5 1" repeatCount="indefinite" dur="1.5s" begin="-0.1875s"></animateTransform>
</circle><circle cx="44.77895231119793" cy="89.65779445495241" fill="${color||"#849b87"}" r="5" transform="rotate(359.76 50.0064 50.0064)">
  <animateTransform attributeName="transform" type="rotate" calcMode="spline" values="0 50 50;360 50 50" times="0;1" keySplines="0.5 0 0.5 1" repeatCount="indefinite" dur="1.5s" begin="-0.25s"></animateTransform>
</circle><circle cx="34.692662705396415" cy="86.95518130045147" fill="${color||"#e15b64"}" r="5" transform="rotate(0.183552 50 50)">
  <animateTransform attributeName="transform" type="rotate" calcMode="spline" values="0 50 50;360 50 50" times="0;1" keySplines="0.5 0 0.5 1" repeatCount="indefinite" dur="1.5s" begin="-0.3125s"></animateTransform>
</circle><circle cx="25.649542839651176" cy="81.73413361164941" fill="${color||"#f47e60"}" r="5" transform="rotate(1.86457 50 50)">
  <animateTransform attributeName="transform" type="rotate" calcMode="spline" values="0 50 50;360 50 50" times="0;1" keySplines="0.5 0 0.5 1" repeatCount="indefinite" dur="1.5s" begin="-0.375s"></animateTransform>
</circle><circle cx="18.2658663883506" cy="74.35045716034884" fill="${color||"#f8b26a"}" r="5" transform="rotate(5.45126 50 50)">
  <animateTransform attributeName="transform" type="rotate" calcMode="spline" values="0 50 50;360 50 50" times="0;1" keySplines="0.5 0 0.5 1" repeatCount="indefinite" dur="1.5s" begin="-0.4375s"></animateTransform>
</circle><animateTransform attributeName="transform" type="rotate" calcMode="spline" values="0 50 50;0 50 50" times="0;1" keySplines="0.5 0 0.5 1" repeatCount="indefinite" dur="1.5s"></animateTransform></g></svg>`}Preloaders.Squares=Squares,Preloaders.Snake=Snake,Preloaders.BallsRing=BallsRing,Preloaders.MsRing=MsRing,Preloaders.TwoArrows=TwoArrows,Preloaders.Flower=Flower,Preloaders.ThreeArcs=ThreeArcs,Preloaders.ThreeDots=ThreeDots,Preloaders.BallTriangle=BallTriangle,Preloaders.Bars=Bars,Preloaders.Oval=Oval,Preloaders.Messenger=Messenger,Preloaders.RotatingBalls=RotatingBalls})(Preloaders=Calysto.Preloaders||(Calysto.Preloaders={}))}(Calysto||(Calysto={})),function(Calysto){function CreateObject(columns,itemsArray){for(var obj={},k=0;k<columns.length;k++){obj[columns[k]]=itemsArray[k]};return obj}function CreateColumns(obj){var columns=[],p;if(columns.length==0){for(p in obj){columns.push(p)}};return columns}function GetItemsArray(obj,columns){for(var values=[],n=0;n<columns.length;n++){values.push(obj[columns[n]])};return values}class DataTable{constructor(){this.Columns=[],this.Rows=[]}ToObjectsArray(){for(var arr=[],n=0;n<this.Rows.length;n++){arr.push(CreateObject(this.Columns,this.Rows[n]))};return arr}Clone(){var dt=new Calysto.DataTable;dt.Columns=this.Columns.slice(),dt.Rows=this.Rows.slice(),dt.TotalCount=this.TotalCount,dt.TableName=this.TableName;return dt}fromObjectsArray(objArray){for(var obj,itemsArray,n=0;n<objArray.length;n++){obj=objArray[n],n==0&&(this.Columns=CreateColumns(obj)),itemsArray=GetItemsArray(obj,this.Columns),this.Rows.push(itemsArray)}}fromDataTable(dataTable){this.Columns=dataTable.Columns.slice(0),this.Rows=dataTable.Rows.slice(0),this.TotalCount=dataTable.TotalCount,this.TableName=dataTable.TableName}static CreateFrom(data){var dt=new DataTable;if(data){if(data.Columns&&data.Rows){dt.fromDataTable(data)}else if(data.push&&data.pop){dt.fromObjectsArray(data)}else throw new Error("Calysto.DataTable: Invalid data, can't create data table");}return dt}}Calysto.DataTable=DataTable}(Calysto||(Calysto={})),function(Calysto){function CreateArray(source){return source?source.ToArray?source.ToArray():Calysto.CalystoEnumerable.From(source).ToArray():[]}class List extends Calysto.CalystoEnumerable{constructor(source){if(super(()=>Calysto.CalystoEnumerator.From(this.array)),this.array=[],typeof source=="string"){throw new Error("List source can not be string");}for(let item of CreateArray(source)){this.array.push(item)}}get InnerArray(){return this.array}Add(value){this.array.push(value);return this}AddRange(arr){this.array.AddRange(arr);return this}Count(){return this.array.length}Any(){return this.array.length>0}Insert(index,value){this.array.splice(index,0,value);return this}ElementAt(index,defaultValue){return this.array.length>index?this.array[index]:defaultValue}Remove(value){return this.RemoveAt(this.IndexOf(value))}RemoveAt(index){return this.RemoveRange(index,1)}RemoveRange(index,count){(index>0||index==0)&&this.array.splice(index,count||1);return this}Reverse(){this.array.reverse();return this}IndexOf(value){return this.array.indexOf(value)}Contains(value){return this.IndexOf(value)>=0}Clear(){this.array.splice(0,this.array.length);return this}ToArray(){return this.array.slice(0)}ToList(){return new Calysto.List(this.array.slice(0))}ToStringJoined(separator){return this.array.join(separator||"")}ForEach(action){typeof action=="string"&&(action=Calysto.Utility.Expressions.CompileLambdaNoReturnCheck(action)),Calysto.Collections.ForEach(this.array,action);return this}FirstOrDefault(defaultValue){return this.array.length>0?this.array[0]:defaultValue}First(){var _a;if(((_a=this.array)===null||_a===void 0?void 0:_a.length)>0){return this.array[0]};throw new Error("Error in First(), no items");}LastOrDefault(defaultValue){return this.array.length>0?this.array[this.array.length-1]:defaultValue}Last(){var _a;if(((_a=this.array)===null||_a===void 0?void 0:_a.length)>0){return this.array[this.array.length-1]};throw new Error("Error in Last(), no items");}}Calysto.List=List}(Calysto||(Calysto={})),function(Calysto){var Utility;(function(Utility){class ComprResult{constructor(){this.Pass=-1}}class StringCompressor{CompressImpl(text,currentPass){var arr=new Calysto.Regex("(.+?)\\1+?").SelectSegments(text).Select(function(o){return o.Value}).Distinct().ToList(),phrases=arr.OrderByDescending(function(o){return o.length}).Skip(arr.Take(2).Count()>1?1:0).ToList(),index=0,phraseIndex=phrases.AsEnumerable().ToDictionary(function(o){return o},function(){return index++}).ToRawObject(true),strre=phrases.AsEnumerable().Select(function(o){return"("+RegExp.Escape(o)+")"}).ToStringJoined("|"),indexesArr=new Calysto.Regex(strre).SelectSegments(text).Select(function(o){o.Success||phraseIndex[o.Value]||(phraseIndex[o.Value]=index++,phrases.Add(o.Value));return phraseIndex[o.Value]}).ToArray(),obj={Dic:phrases.ToArray(),Cont:indexesArr,Pass:currentPass};return Calysto.Json.Serialize(obj)}Compress(text,passesMax){var pass,previousResult,result;for(arguments.length<2&&(passesMax=1),pass=0,previousResult=text;pass<=passesMax;){if(result=this.CompressImpl(previousResult,pass),result.length>previousResult.length){return previousResult};previousResult=result,pass++}return previousResult}Decompress(json){if(!json.Contains('"Dic"')||!json.Contains('"Cont"')||!json.Contains('"Pass"')){return json};var obj=Calysto.Json.Deserialize(json),index=0,indexPhrase=obj.Dic.AsEnumerable().ToDictionary(function(){return"n"+index++},function(o){return o}).ToRawObject(true),txt=obj.Cont.AsEnumerable().Select(function(o){return indexPhrase["n"+o]}).ToStringJoined();return obj.Pass>0?this.Decompress(txt):txt}}Utility.StringCompressor=StringCompressor})(Utility=Calysto.Utility||(Calysto.Utility={}))}(Calysto||(Calysto={})),function(Calysto){var Security;(function(Security){var Cryptography;(function(Cryptography){class SimpleEncryptor{constructor(password){password+="!(&#@`#)#$%^*(_+~`";var list1=password.ToCharArray().AsEnumerable().Cycle(1e3).Select((ch,fromByte)=>({ch:ch.charCodeAt(0),fromByte:fromByte})).Take(256).OrderBy(o=>o.ch).Select((o,toByte)=>({ch:o.ch,fromByte:o.fromByte,toByte:toByte})).ToList();this._dicEncryption=list1.AsEnumerable().ToDictionary(o=>o.fromByte+"_",o=>o.toByte).ToRawObject(true),this._dicDecryption=list1.AsEnumerable().ToDictionary(o=>o.toByte+"_",o=>o.fromByte).ToRawObject(true)}Encrypt(rawData){typeof rawData=="string"&&(rawData=Calysto.Utility.Encoding.UTF8.GetBytes(rawData));return rawData.Select(o=>this._dicEncryption[o+"_"])}Decrypt(encryptedData){return encryptedData.Select(o=>this._dicDecryption[o+"_"])}DecryptToString(encryptedData){return Calysto.Utility.Encoding.UTF8.GetString(this.Decrypt(encryptedData))}}Cryptography.SimpleEncryptor=SimpleEncryptor})(Cryptography=Security.Cryptography||(Security.Cryptography={}))})(Security=Calysto.Security||(Calysto.Security={}))}(Calysto||(Calysto={})),function(Calysto){var TestTools;(function(TestTools){var UnitTesting;(function(UnitTesting){let Assert;(function(Assert){function ShowError(msg){console.error(msg);return false}function ConvertToString(value){return typeof value=="string"?value:value===undefined?"undefined":value===null?"null":isNaN(value)?"NaN":JSON.stringify(value)}function AreEqual(expected,actual,message,parameters){return Calysto.Type.TypeInspector.AreValuesEqual(expected,actual)?true:ShowError(new MessageBuilder("Assert.AreEqual failed.").AddNameValue("Expected",expected).AddNameValue("Actual",actual).AddCustom(message,parameters).ToStringFormated())}function AreNotEqual(notExpected,actual,message,parameters){return Calysto.Type.TypeInspector.AreValuesEqual(notExpected,actual)?ShowError(new MessageBuilder("Assert.AreNotEqual failed.").AddNameValue("NotExpected",notExpected).AddNameValue("Actual",actual).AddCustom(message,parameters).ToStringFormated()):true}function AreSame(expected,actual,message,parameters){return expected===actual?true:ShowError(new MessageBuilder("Assert.AreSame failed.").AddNameValue("Expected",expected).AddNameValue("Actual",actual).AddCustom(message,parameters).ToStringFormated())}function AreNotSame(expected,actual,message,parameters){return expected!==actual?true:ShowError(new MessageBuilder("Assert.AreNotSame failed.").AddNameValue("Expected",expected).AddNameValue("Actual",actual).AddCustom(message,parameters).ToStringFormated())}function Fail(message,parameters){return ShowError(new MessageBuilder(`Assert.Fail.`).AddCustom(message,parameters).ToStringFormated())}function Inconclusive(message,parameters){return ShowError(new MessageBuilder(`Assert.Inconclusive.`).AddCustom(message,parameters).ToStringFormated())}function IsFalse(condition,message,parameters){return condition===false?ShowError(new MessageBuilder(`Assert.IsFalse failed.`).AddCustom(message,parameters).ToStringFormated()):true}function IsTrue(condition,message,parameters){return condition===true?true:ShowError(new MessageBuilder(`Assert.IsTrue failed.`).AddCustom(message,parameters).ToStringFormated())}function IsNull(value,message,parameters){return Calysto.Type.TypeInspector.IsNullOrUndefined(value)?true:ShowError(new MessageBuilder(`Assert.IsNull failed.`).AddNameValue("Actual",value).AddCustom(message,parameters).ToStringFormated())}function IsNotNull(value,message,parameters){return Calysto.Type.TypeInspector.IsNullOrUndefined(value)?ShowError(new MessageBuilder(`Assert.IsNotNull failed.`).AddNameValue("Actual",value).AddCustom(message,parameters).ToStringFormated()):true}function ThrowsException(action,message,parameters){try{action()}catch(err){return true}return ShowError(new MessageBuilder(`Assert.ThrowsException failed. Exception was not thrown.`).AddCustom(message,parameters).ToStringFormated())}class MessageBuilder{constructor(mainMsg){this._lines=[],this._lines.push(mainMsg)}AddNameValue(name,value){this._lines.Add(name+":<"+ConvertToString(value)+">.");return this}AddCustom(message,parameters){message&&this._lines.Add(message.FormatWith(parameters));return this}ToStringFormated(separator="\r\n"){return this._lines.join(separator)}}Assert.AreEqual=AreEqual,Assert.AreNotEqual=AreNotEqual,Assert.AreSame=AreSame,Assert.AreNotSame=AreNotSame,Assert.Fail=Fail,Assert.Inconclusive=Inconclusive,Assert.IsFalse=IsFalse,Assert.IsTrue=IsTrue,Assert.IsNull=IsNull,Assert.IsNotNull=IsNotNull,Assert.ThrowsException=ThrowsException})(Assert=UnitTesting.Assert||(UnitTesting.Assert={}))})(UnitTesting=TestTools.UnitTesting||(TestTools.UnitTesting={}))})(TestTools=Calysto.TestTools||(Calysto.TestTools={}))}(Calysto||(Calysto={})),function(Calysto){var TestTools;(function(TestTools){var TestRunner;(function(TestRunner){function AddTest(fn){_tests.push(fn)}function RunTests(){for(let fn of _tests){fn()};let res1="UnitTests complete: "+_tests.length;console.log(res1);return res1}let _tests=[];TestRunner.AddTest=AddTest,TestRunner.RunTests=RunTests,Calysto.Core.IsTddSpecific&&Calysto.Page.OnInteractive(()=>TestRunner.RunTests())})(TestRunner=TestTools.TestRunner||(TestTools.TestRunner={}))})(TestTools=Calysto.TestTools||(Calysto.TestTools={}))}(Calysto||(Calysto={})),function(Calysto){function EnsureCssAdded(){_cssAdded||(_cssAdded=true,Calysto.ScriptLoader.LoadCSS(Calysto.Utility.Html.Minify(_css1)))}let _css1=`
.calystoConsole {
	position:fixed;
	top:0;
	left:0;
	width:400px;
	height:100px;
	overflow:auto;
	border:solid 1px black;
	background:#f3f37a;
	color:black;
	font-size:11px;
	z-index:1000000;
}

.calystoConsole * {
	font-size:inherit;
}
`,_cssAdded=false;class Console{constructor(){this.LineMaxLength=1e3}EnsureCreated(){if(Calysto.Core.IsDebugDefined){if(this._consoleDiv){return};EnsureCssAdded();let div1=document.createElement("div");div1.innerHTML="<div class='calystoConsole'><\/div>",this._consoleDiv=div1.childNodes[0],document.body.appendChild(this._consoleDiv)}}ApplyStyle(style){Calysto.Core.IsDebugDefined&&(this.EnsureCreated(),$$calysto(this._consoleDiv).ApplyStyle(style))}ConverToString(txt){return typeof txt=="string"?txt:txt===undefined?"undefined":txt===null?"null":txt==NaN?"NaN":typeof txt=="function"?txt+"":JSON.stringify(txt)}WriteLine(txt){if(Calysto.Core.IsDebugDefined){this.EnsureCreated();let str1=this.ConverToString(txt);str1.length>this.LineMaxLength&&(str1=str1.substr(0,this.LineMaxLength)+"...[truncated]"),$$calysto(this._consoleDiv).AddChildren(Calysto.DomQuery.CreateElement("div").AddChildren(str1)),this._consoleDiv.scrollTop=this._consoleDiv.scrollHeight}}Clear(){this._consoleDiv&&(this._consoleDiv.innerHTML="")}Destroy(){this._consoleDiv&&($$calysto(this._consoleDiv).RemoveFromDom(),this._consoleDiv=null)}}Console.Current=new Console,Calysto.Console=Console}(Calysto||(Calysto={})),function(Calysto){var CacheProvider;(function(CacheProvider){function AdjustExpiration(item){item.SlidingDuration>0&&(item.Expiration=Math.round(Date.now()+1e3*item.SlidingDuration))}function IsExpired(item){return item.Expiration&&item.Expiration<Date.now()}function Set(storage,key,item,expirationAfterSeconds,slidingDurationSeconds){var expires=expirationAfterSeconds?Math.round(Date.now()+1e3*expirationAfterSeconds):null;let cached1={Content:item,Expiration:expires,SlidingDuration:slidingDurationSeconds};AdjustExpiration(cached1);let json1=JSON.stringify(cached1);storage.setItem(key,json1)}function Get(storage,key){let json1=storage.getItem(key);if(json1){let cached1=JSON.parse(json1);if(IsExpired(cached1)){storage.removeItem(key)}else{AdjustExpiration(cached1);return cached1.Content}}return null}function Remove(storage,key){storage.removeItem(key)}function Clear(storage){storage.clear()}CacheProvider.Set=Set,CacheProvider.Get=Get,CacheProvider.Remove=Remove,CacheProvider.Clear=Clear})(CacheProvider=Calysto.CacheProvider||(Calysto.CacheProvider={}))}(Calysto||(Calysto={})),function(Calysto){var Mvc;(function(Mvc){var AjaxForm;(function(AjaxForm){function IsAjaxFormSubmitEnabled(){return _isEnabled&&!_isDisabled}function UseAjaxFormSubmit(enable=true){enable===false?_isDisabled=true:_isEnabled||(_isEnabled=true,Calysto.Page.OnEndResponse(()=>fnInitFormsInterceptor()))}function SubmitForm(formSelector,delay=0){setTimeout(()=>{let form=$$calysto(formSelector).First();fnCreateAndSendRequest(form)},delay)}function fnInitFormsInterceptor(){$$calysto("form").Where(f=>!f.$$CalystoInterceptor).ForEach(frm=>{frm.$$CalystoInterceptor=true;let f1=frm;f1.submitBase=f1.submit,f1.submit=function(){let _safethis14=this;setTimeout(()=>fnHandleSubmitRequest(_safethis14),1);return false}}).On("submit",sender=>{setTimeout(()=>fnHandleSubmitRequest(sender),1);return false})}function fnHandleSubmitRequest(sender){var _a;if(!IsAjaxFormSubmitEnabled()||((_a=Calysto.DataAnnotations.FindValidationService(sender))===null||_a===void 0?void 0:_a.Validate().Render().Interactive(true).HasErrors())){return false};fnCreateAndSendRequest(sender);return false}function fnCreateAndSendRequest(frm){var _a;if(!frm){throw new Error("Form is null.");}let receivedHandler1=frm.getAttribute(Calysto.Constants.CalystoDomAttributes.CalystoFormHandler),targetSel1=frm.getAttribute(Calysto.Constants.CalystoDomAttributes.CalystoFormTarget);if(!targetSel1&&!receivedHandler1){Calysto.Core.IsDebugDefined&&console.log("Form has no target and no received handler.");return}let selectorId=Calysto.Utility.Dom.EnsureElementId(targetSel1||frm),appendArr=[{Key:"__RootSelectorKey",Value:selectorId}],items1=Calysto.Forms.SerializeContainer(frm);for(let item1 of items1){((_a=item1.Element)===null||_a===void 0?void 0:_a.disabled)&&appendArr.push({Key:item1.Name,Value:item1.Value})};Calysto.Core.IsDebugDefined;let mode1=frm.getAttribute(Calysto.Constants.CalystoDomAttributes.CalystoFormMode),timeout1=parseInt(frm.getAttribute("calysto-timeout"))||9e4,spinner1=Calysto.Mvc.UseCalystoSpinner(frm,false),actionUrl=frm.getAttribute(Calysto.Constants.CalystoDomAttributes.CalystoFormDestination);if(!actionUrl){throw new Error("Invalid action url.");}else actionUrl=Calysto.Utility.Encoding.CalystoBase64.DecodeBase64StringToString(actionUrl);Calysto.Page.OnBeginRequest.Invoke();return new Calysto.Net.WebClient(actionUrl).AddRequestHeader(Calysto.Constants.WsjsHeaderConstants.XCalystoAjaxFormKey,Calysto.Constants.WsjsHeaderConstants.XCalystoAjaxFormValue).SetTimeout(timeout1).UploadHtmlForm(frm,appendArr).OnError((wclient,ev)=>{Calysto.Core.IsDebugDefined&&Calysto.Dialog.CreateError(ev+"").Show()}).OnLoad(wclient=>{let txt=wclient.GetResponseText(),loc1=wclient.xhr.getResponseHeader("location");if(loc1){location.assign(loc1);return}if(spinner1.Remove(),wclient.xhr.status<200||wclient.xhr.status>=300){let title1=wclient.xhr.status+" "+(wclient.xhr.statusText||Calysto.Net.HttpStatusCode[wclient.xhr.status]||""),body1=txt||title1;Calysto.Dialog.CreateError(body1,title1).Show()}else if(wclient.xhr.getResponseHeader(Calysto.Constants.WsjsHeaderConstants.XCalystoResponseContainerKey)==Calysto.Constants.WsjsHeaderConstants.XCalystoResponseContainerValue){let state=fnCreateResponseState();Calysto.Net.WebService.AjaxResponseReceivedHandler(wclient,state)}else{if(receivedHandler1){let result=new Calysto.BoxValue;if(receivedHandler1.Contains("=>")){let fn1=Calysto.Utility.Expressions.CompileLambdaNoReturnCheck(receivedHandler1);fn1(txt)}else if(Calysto.DataBinder.TryGetValue(window,receivedHandler1,result)){result.GetValue()(txt)}else throw new Error("Received handler supported: "+receivedHandler1);}if(targetSel1){mode1=mode1||"ReplaceChildren";for(let sel1 of targetSel1.split(",")){sel1=sel1.Trim();let items=Calysto.DomQuery.FromHtml(txt).Query(`${sel1}, //${sel1}`).Distinct().ChildNodes().ToArray();$$calysto(targetSel1)[mode1]((items===null||items===void 0?void 0:items.Any())?items:txt)}}}Calysto.Page.OnEndResponse.Invoke()}).Start()}function fnCreateResponseState(){return{fnErrorCallback:a=>{Calysto.Core.IsDebugDefined&&Calysto.Dialog.CreateError(a).Show()},fnResponseContainerCallback:a=>{Calysto.Core.IsDebugDefined&&console.log("fnResponseContainerCallback",a)},fnReturnValueCallback:a=>{Calysto.Core.IsDebugDefined&&console.log("fnReturnValueCallback",a)},fnResponseEndCallback:()=>{Calysto.Core.IsDebugDefined&&console.log("fnResponseEndCallback")}}}let _isEnabled=false,_isDisabled=false;AjaxForm.IsAjaxFormSubmitEnabled=IsAjaxFormSubmitEnabled,AjaxForm.UseAjaxFormSubmit=UseAjaxFormSubmit,AjaxForm.SubmitForm=SubmitForm})(AjaxForm=Mvc.AjaxForm||(Mvc.AjaxForm={}))})(Mvc=Calysto.Mvc||(Calysto.Mvc={}))}(Calysto||(Calysto={})),function(Calysto){var Mvc;(function(Mvc){function UseCalystoSpinner(containerSelector,autoRemoval){return CalystoSpinner.Start(containerSelector,autoRemoval)}class CalystoSpinner{constructor(){}static Start(containerSelector,autoRemoval){let disabledElements=$$calysto(containerSelector).Query("//button, //a").WhereEnabled(true).SetEnabled(false),spinners=$$calysto(containerSelector).Query("//div.calysto-spinner").ToArray(),timers=[];for(let spinner1 of spinners){let spinnerDelay=parseInt(spinner1.getAttribute("calysto-spinner-delay"))||300,timer=new Calysto.Timer(()=>{spinner1.className+=" calysto-visible"}).Start(spinnerDelay);timers.push(timer)}let spinner1=new CalystoSpinner,cb1=spinner1.Remove=()=>{for(let timer of timers){timer===null||timer===void 0?void 0:timer.Abort()};spinners.AsEnumerable().AsDomQuery().RemoveClass("calysto-visible"),disabledElements.SetEnabled(true)};autoRemoval&&Calysto.Page.OnEndResponse.MCD.AddOnce(cb1);return spinner1}Remove(){}}Mvc.UseCalystoSpinner=UseCalystoSpinner})(Mvc=Calysto.Mvc||(Calysto.Mvc={}))}(Calysto||(Calysto={})),function(Calysto){var Binding;(function(Binding){let TemplateKind;(function(TemplateKind){TemplateKind[TemplateKind.NoData=1]="NoData",TemplateKind[TemplateKind.Header=2]="Header",TemplateKind[TemplateKind.Footer=3]="Footer",TemplateKind[TemplateKind.Separator=4]="Separator",TemplateKind[TemplateKind.Item=5]="Item",TemplateKind[TemplateKind.AlternatingItem=6]="AlternatingItem"})(TemplateKind=Binding.TemplateKind||(Binding.TemplateKind={}))})(Binding=Calysto.Binding||(Calysto.Binding={}))}(Calysto||(Calysto={})),function(Calysto){var Binding;(function(Binding){var Setup;(function(Setup){class BindingSetup{constructor(){this.Bindings=[],this.ViewListeners=[],this.Repeaters=[],this.Templates=[],this.DataListeners=[],this.Sources=[]}}class BindingService{constructor(uid,factory){this._uid=uid,this._setup=factory}GetCsvValues(csv){if(csv){if(typeof csv=="string"){var arr=csv===null||csv===void 0?void 0:csv.Split(",").Select(o=>o.Trim()).Where(o=>!String.IsNullOrEmpty(o)).ToArray();if(arr&&arr.length>1){throw new Error("Single string value is expected or string[]. Provided CSV: "+csv);}return arr.Any()?arr:null}if(Calysto.Type.TypeInspector.IsArray(csv)){return csv};throw new Error("Invalid argument, requires string or string[]. Provided: "+csv);}else return[]}Root(){if(this._setup.RootUid){throw new Error("Root is already defined.");}this._setup.RootUid=this._uid;return this}Bind(elementPath,dataSourcePath,jsSetConvert,jsGetConvert,eventNames){let elPaths1=this.GetCsvValues(elementPath);if((elPaths1===null||elPaths1===void 0?void 0:elPaths1.length)!=1){throw new Error("Single element property path is required, but provided: "+elementPath);}let dsPaths1=this.GetCsvValues(dataSourcePath);if((dsPaths1===null||dsPaths1===void 0?void 0:dsPaths1.length)!=1){throw new Error("Single data source property path is required, but provided: "+dataSourcePath);}this._setup.Bindings.push({Uid:this._uid,ElementPath:elPaths1[0],DataSourcePath:dsPaths1[0],JsSetConvert:jsSetConvert,JsGetConvert:jsGetConvert,EventNames:this.GetCsvValues(eventNames)});return this}ListenData(dataSourcePaths,jsHandler){this._setup.DataListeners.push({Uid:this._uid,DataSourcePaths:this.GetCsvValues(dataSourcePaths),JsHandler:jsHandler});return this}ListenView(eventNames,jsHandler){this._setup.ViewListeners.push({Uid:this._uid,EventNames:this.GetCsvValues(eventNames),JsHandler:jsHandler});return this}Source(dataSourcePath){this._setup.Sources.push({Uid:this._uid,DataSourcePath:dataSourcePath});return this}Repeater(dataSourcePath){this._setup.Repeaters.push({Uid:this._uid,DataSourcePath:dataSourcePath});return this}Template(kind){this._setup.Templates.push({Uid:this._uid,TemplateKind:kind});return this}}class BindingFactory{constructor(){this._setup=new BindingSetup}GetSetup(){return this._setup}GetRoot(){return this._setup.RootUid}Assign(uid,action){let service=new BindingService(uid,this._setup);action(service);return this}}Setup.BindingFactory=BindingFactory})(Setup=Binding.Setup||(Binding.Setup={}))})(Binding=Calysto.Binding||(Calysto.Binding={}))}(Calysto||(Calysto={})),function(Calysto){var Binding;(function(Binding){var Attributes;(function(Attributes){Attributes.ComponentSetting="calysto-binding-component",Attributes.Uid="calysto-binding-uid"})(Attributes=Binding.Attributes||(Binding.Attributes={}))})(Binding=Calysto.Binding||(Calysto.Binding={}))}(Calysto||(Calysto={})),function(Calysto){var Binding;(function(Binding){var BindingCache;(function(BindingCache){function GetRepeaterSetting(element){let uid=GetElementUid(element);return globalRepeatersDic[uid]}function GetBindingElement(uid){return globalElementsDic[uid]}function GetElementUid(element){return element.getAttribute(Binding.Attributes.Uid)}function FindSettings(rootElement){let json1=$$calysto(rootElement).Query(`//div[${Calysto.Binding.Attributes.ComponentSetting}=*]`).SelectInnerHtml().FirstOrDefault();return Calysto.Json.Deserialize(json1)}function InitializeBindings(rootElement,settings){let fullSettings=settings||FindSettings(rootElement);rootElement.$$observable_RootSetting=fullSettings;let elementsArr=$$calysto(rootElement).Query(`[${Calysto.Binding.Attributes.Uid}], //[${Calysto.Binding.Attributes.Uid}]`).Select(o=>({Uid:o.getAttribute(Calysto.Binding.Attributes.Uid),Element:o})).ToArray();elementsArr.ForEach(o=>{if(!o.Uid){throw new Error(`Uid is undefined for ${o.Element.tagName} element`);}if(globalElementsDic[o.Uid]){throw new Error(`Multiple elements with the same uid: ${o.Uid}`);}let sett1={RootUid:fullSettings.RootUid,Bindings:fullSettings.Bindings.Where(k=>k.Uid==o.Uid).ToArray(),ViewListeners:fullSettings.ViewListeners.Where(k=>k.Uid==o.Uid).ToArray(),DataListeners:fullSettings.DataListeners.Where(k=>k.Uid==o.Uid).ToArray(),Sources:fullSettings.Sources.Where(k=>k.Uid==o.Uid).ToArray(),Repeaters:fullSettings.Repeaters.Where(k=>k.Uid==o.Uid).ToArray(),Templates:fullSettings.Templates.Where(k=>k.Uid==o.Uid).ToArray()};if(!sett1.RootUid&&!sett1.Bindings.Any()&&!sett1.ViewListeners.Any()&&!sett1.DataListeners.Any()&&!sett1.Sources.Any()&&!sett1.Repeaters.Any()&&!sett1.Templates.Any()){throw new Error(`No settings found for element with uid: ${o.Uid}`);}globalElementsDic[o.Uid]={Element:o.Element,Settings:sett1}});let elementsDic=elementsArr.AsEnumerable().ToRawObject(o=>o.Uid,o=>o.Element),templates=fullSettings.Templates.AsEnumerable().Select(o=>{let repeater1;try{repeater1=elementsDic[o.Uid].parentElement}catch(err){throw new Error(err+", Uid: "+o.Uid);}return{Template:o,Element:elementsDic[o.Uid],RepeaterElement:repeater1,RepeaterUid:repeater1.getAttribute(Calysto.Binding.Attributes.Uid)}}).ToArray(),invalidTemplates=templates.Where(o=>!o.RepeaterUid).ToArray();if(invalidTemplates.Any()){throw new Error("Template has no parent element.");}let invalidRepeaters=templates.Where(o=>$$calysto(o.RepeaterElement).WhereVisible().Any()).ToArray();if(invalidRepeaters.Any()){throw new Error("Repeater must have style='display:none'");}let fnGetTemplate=(repeaterUid,templateKind)=>templates.AsEnumerable().Where(o=>o.RepeaterUid==repeaterUid&&o.Template.TemplateKind==templateKind).Select(o=>o.Element).FirstOrDefault();fullSettings.Repeaters.ForEach(rep=>{globalRepeatersDic[rep.Uid]||(globalRepeatersDic[rep.Uid]={header:fnGetTemplate(rep.Uid,Binding.TemplateKind.Header),item:fnGetTemplate(rep.Uid,Binding.TemplateKind.Item),alternating:fnGetTemplate(rep.Uid,Binding.TemplateKind.AlternatingItem),separator:fnGetTemplate(rep.Uid,Binding.TemplateKind.Separator),footer:fnGetTemplate(rep.Uid,Binding.TemplateKind.Footer),nodata:fnGetTemplate(rep.Uid,Binding.TemplateKind.NoData)})}),$$calysto(templates.Select(o=>o.Element).ToArray()).RemoveFromDom()}let globalRepeatersDic={};BindingCache.GetRepeaterSetting=GetRepeaterSetting;let globalElementsDic={};Calysto.Core.IsDebugDefined&&(window.$$globalRepeatersDic=globalRepeatersDic,window.$$globalElementsDic=globalElementsDic),BindingCache.GetBindingElement=GetBindingElement,BindingCache.GetElementUid=GetElementUid,BindingCache.InitializeBindings=InitializeBindings})(BindingCache=Binding.BindingCache||(Binding.BindingCache={}))})(Binding=Calysto.Binding||(Calysto.Binding={}))}(Calysto||(Calysto={})),function(Calysto){var Binding;(function(Binding){class BindingDataSource{constructor(dataSource){this.dsListeners=new Binding.BindingDictionaryTree,this.dataSource={},dataSource&&this.SetDataSource(dataSource),window.dsListeners=this.dsListeners}SetDataSource(dataSource){this.dataSource=dataSource||{};return this}GetDataSource(){return this.dataSource}SetValue(path,value,dontNotify){if(dontNotify){Calysto.DataBinder.SetValue(this.dataSource,path,value)}else{var curr=Calysto.DataBinder.GetValue(this.dataSource,path);Calysto.Type.TypeInspector.AreValuesEqual(curr,value)||(Calysto.DataBinder.SetValue(this.dataSource,path,value),this.NotifyPropertyChanged(path))}return this}GetValue(path){return Calysto.DataBinder.GetValue(this.dataSource,path)}SetValueSilent(dataProperty,value){return this.SetValue(dataProperty,value,true)}SetValueLoud(dataProperty,value){this.SetValue(dataProperty,value,true),this.NotifyPropertyChanged(dataProperty);return this}NotifyPropertyChanged(propertyPath){if(!propertyPath||propertyPath.length==0){throw new Error("NotifyPropertyChanged(...) requires an argument");}let listenersArr=this.dsListeners.GetListenersAndDescendants(propertyPath);for(let item of listenersArr){item.CallbackFunc(item.FullPath)};return this}}Binding.BindingDataSource=BindingDataSource})(Binding=Calysto.Binding||(Calysto.Binding={}))}(Calysto||(Calysto={})),function(Calysto){var Binding;(function(Binding){class DataSourceListenerItem{constructor(Owner,Element,FullPath,CallbackFunc){this.Owner=Owner,this.Element=Element,this.FullPath=FullPath,this.CallbackFunc=CallbackFunc}RemoveListener(){this.Owner.$$$_listeners.Remove(this),this.Owner.$$$_ownerTree.InvalidateCache()}}Binding.DataSourceListenerItem=DataSourceListenerItem;class TreeNode{constructor(ownerTree,fullPath){this.$$$_ownerTree=ownerTree,this.$$$_fullPath=fullPath,this.$$$_listeners=[]}AddListener(item){this.$$$_listeners.push(item)}}class BindingDictionaryTree{constructor(){this.itemsCache={}}GetTreeNode(propertyPath){if(Calysto.Core.IsDebugDefined,this.rootNode||(this.rootNode=new TreeNode(this,"@")),!propertyPath){throw new Error("GetTreeNode(path) requires an argument");}if(propertyPath=="@"||propertyPath=="@."){return this.rootNode};var obj=Calysto.DataBinder.GetValue(this.rootNode,propertyPath);if(!obj){let tmpParent=this.rootNode,arr2=[];propertyPath.split(".").ForEach(propertyPath=>{arr2.push(propertyPath);let p2=arr2.join(".");obj=Calysto.DataBinder.GetValue(tmpParent,p2),obj||(obj=new TreeNode(this,p2),Calysto.DataBinder.SetValue(this.rootNode,p2,obj))})}return obj}AddListener(propertyPath,element,callback){if(!propertyPath||propertyPath.length==0){throw new Error("AddListener(...) requires an argument");}let treeNode=this.GetTreeNode(propertyPath),listener=new DataSourceListenerItem(treeNode,element,treeNode.$$$_fullPath,callback);treeNode.AddListener(listener),this.InvalidateCache();return listener}GetListeners(node,includeDescendants){var arr=node&&node.$$$_listeners?node.$$$_listeners.slice(0):[];node&&includeDescendants&&Calysto.Collections.ForEachOwnProperties(node,name=>{if(name.indexOf("$$$_")!=0){var descArr=this.GetListeners(node[name],includeDescendants);descArr&&arr.AddRange(descArr)}});return arr}GetListenersAndDescendants(propertyPath){if(!propertyPath||propertyPath.length==0){throw new Error("GetDescendantListeners(...) requires an argument");}var items=this.GetFromCache(propertyPath);if(items){Calysto.Core.IsDebugDefined;return items}items=this.GetListeners(this.GetTreeNode(propertyPath),true),this.AddToCache(propertyPath,items);return items}InvalidateCache(){Calysto.Core.IsDebugDefined,this.itemsCache={}}AddToCache(propertyPath,items){Calysto.Core.IsDebugDefined,this.itemsCache[propertyPath+""]=items}GetFromCache(propertyPath){return this.itemsCache[propertyPath+""]}}Binding.BindingDictionaryTree=BindingDictionaryTree})(Binding=Calysto.Binding||(Calysto.Binding={}))}(Calysto||(Calysto={})),function(Calysto){var Binding;(function(Binding){class BindingElementPathResolver{constructor(Element){this.Element=Element,this._pathCache={}}static GetInstance(element){return element.$$observable_PathResolver||(element.$$observable_PathResolver=new BindingElementPathResolver(element))}FindDataBinder(){if(this._binder){return this._binder};let el=this.Element;while(el){if(el.$$observable_Binder){return this._binder=el.$$observable_Binder};el=el.parentNode}return this._binder}GetDataBinder(){let binder=this.FindDataBinder();if(binder){return binder};throw new Error("Data binder not found");}ResolveAbsolutePath(relativePath){let partsArr=relativePath.split(".");partsArr[0]=="DataItem"&&partsArr.shift();let el=this.Element;while(el){if(el.$$observable_DataPath){let tmpArr=el.$$observable_DataPath.split(".");partsArr.unshift(...tmpArr)}if(partsArr[0]=="@"){return partsArr};if(el.$$observable_Binder){break}else el=el.parentNode}throw new Error("Data path can not be resolved for: "+relativePath);}CreateAbsoluteDataPath(relativePath){let res1=this._pathCache[relativePath];if(res1){return res1};if(relativePath&&relativePath.charAt(0)=="@"){this._pathCache[relativePath]=relativePath;return relativePath}let resolvedArr=this.ResolveAbsolutePath(relativePath),resolvedPath=resolvedArr.join(".");return this._pathCache[relativePath]=resolvedPath}}Binding.BindingElementPathResolver=BindingElementPathResolver})(Binding=Calysto.Binding||(Calysto.Binding={}))}(Calysto||(Calysto={})),function(Calysto){var Binding;(function(Binding){class BindingObservable extends Binding.BindingDataSource{constructor(){super(),this._cachedDataSourceTypes={},this._recursions=0}WriteLog(element,line){Calysto.Core.IsDebugDefined&&(element.$$observable_Log||(element.$$observable_Log=[]),element.$$observable_Log.push(line))}SetElementValue(element,elProperty,value){if(this.WriteLog(element,`SetElementValue(${elProperty}, ${value})`),elProperty=="options"&&element.tagName.toLowerCase()=="select"){element.innerHTML="";var items=value;for(let o of items.ToArray()){let opt=document.createElement("option");opt.innerHTML=o.Text,opt.value=Calysto.Type.TypeConverter.ToStringFormated(o.Value,element.getAttribute(Calysto.AttrName.CalystoFormat)),element.appendChild(opt),opt.selected=!!o.Selected}}else elProperty=="enabled"||elProperty=="disabled"?!value&&elProperty=="enabled"||value&&elProperty=="disabled"?(element.setAttribute("disabled","disabled"),element.disabled=true):(element.removeAttribute("disabled"),element.disabled=false):elProperty=="visible"?element.style.display=value?"":"none":elProperty=="invisible"?element.style.display=value?"none":"":elProperty=="innerHTML"||elProperty=="value"?(Calysto.Type.TypeInspector.IsNullOrUndefined(value)?value="":typeof value!="string"&&(value=Calysto.Type.TypeConverter.ToStringFormated(value)),element[elProperty]=value):Calysto.DataBinder.SetValue(element,elProperty,value)}RemoveElementAndListeners(element){Calysto.Event.Detach(element),Calysto.Utility.Dom.RemoveNodeFromDom(element),element.$$observable_DataSourceListeners&&element.$$observable_DataSourceListeners.ForEach(listener=>listener.RemoveListener())}CloneNodeSafe(el){let el1=el.cloneNode(true);el1.style.display="none";return el1}BindDataToRepeater(repeaterEl,absoluteDataPath,sourceList){repeaterEl.$$observable_DataPath=absoluteDataPath,this.WriteLog(repeaterEl,`BindDataToRepeater(${absoluteDataPath}, ${sourceList})`);let repeater=Binding.BindingCache.GetRepeaterSetting(repeaterEl);sourceList&&sourceList.ToArray&&(sourceList=sourceList.ToArray());var total=sourceList&&sourceList.length?sourceList.length:0;repeaterEl.style.minHeight=repeaterEl.offsetHeight+"px",$$calysto(repeaterEl).DescendantNodes().ToArray().ForEach(el=>this.RemoveElementAndListeners(el)),repeaterEl.innerHTML="";let items3=[repeaterEl];if(total>0){let nn;repeater.header&&(repeaterEl.appendChild(nn=this.CloneNodeSafe(repeater.header)),nn.$$observable_DataPath=absoluteDataPath,items3.push(nn));for(let index=0;index<sourceList.length;index++){let item=sourceList[index];repeater.separator&&index>0&&(repeaterEl.appendChild(nn=this.CloneNodeSafe(repeater.separator)),nn.$$observable_DataPath=absoluteDataPath+"."+index,nn.$$observable_ItemIndex=index,items3.push(nn)),repeater.alternating&&index%2==1?(repeaterEl.appendChild(nn=this.CloneNodeSafe(repeater.alternating)),nn.$$observable_DataPath=absoluteDataPath+"."+index,nn.$$observable_ItemIndex=index,items3.push(nn)):repeater.item&&(repeaterEl.appendChild(nn=this.CloneNodeSafe(repeater.item)),nn.$$observable_DataPath=absoluteDataPath+"."+index,nn.$$observable_ItemIndex=index,items3.push(nn))}repeater.footer&&(repeaterEl.appendChild(nn=this.CloneNodeSafe(repeater.footer)),nn.$$observable_DataPath=absoluteDataPath,items3.push(nn))}else if(repeater.nodata){let nn;repeaterEl.appendChild(nn=this.CloneNodeSafe(repeater.nodata)),nn.$$observable_DataPath=absoluteDataPath,items3.push(nn)}let items2=$$calysto(repeaterEl).Query(`//[${Binding.Attributes.Uid}]`).ToArray();for(let item of items2){this.WriteLog(item,`Inside repeater, init listeners`),this.CreateViewListeners(item),this.CreateDataListeners(item)};for(let item of items2){if(item!=repeaterEl&&item.$$observable_DataSourceListeners&&item.$$observable_DataSourceListeners.Any()){for(let listener of item.$$observable_DataSourceListeners){listener.CallbackFunc(listener.FullPath)}}};items3.ForEach(o=>o.style.display=""),repeaterEl.style.minHeight=""}GetUpperPath(path){let arr1=path.split(".").ToArray();arr1.RemoveAt(arr1.length-1);return arr1.join(".")}ResolveHandlerFunction(jsHandler,pathResolver){if(typeof jsHandler=="function"){return{Func:jsHandler}};if(jsHandler.Contains("=>")){return{Func:Calysto.Utility.Expressions.CompileLambdaExpression(jsHandler)}};let absoluteDataPath=pathResolver.CreateAbsoluteDataPath(jsHandler),arr1=absoluteDataPath.split("."),tmpPath,fn1;while((tmpPath=arr1.join("."))&&!Calysto.Type.TypeInspector.IsFunction(fn1=this.GetValue(tmpPath))){fn1=null,arr1.length>1?arr1.splice(arr1.length-2,1):arr1.length>0&&arr1.splice(0,1)};if(!fn1){let fn1=Calysto.DataBinder.GetValue(window,jsHandler);if(fn1){if(Calysto.Type.TypeInspector.IsFunction(fn1)){return{Func:fn1}};throw new Error("Handler path is not function: "+jsHandler);}}if(!fn1){throw new Error("Function is expected at "+absoluteDataPath+", but found: "+fn1);}let context1=this.GetValue(this.GetUpperPath(tmpPath));return{Func:fn1,HandlerContext:context1}}CreateHtmlEventContext(context,element,eventsNames,event,dsDataPath){return{Binder:this,Element:element,DataSource:this.GetDataSource(),DataPath:dsDataPath,HandlerContext:context,ListeningEventsNames:eventsNames,Event:event}}CreateViewListeners(element){if(!element.$$observable_hasHtmlListenersAttached){element.$$observable_hasHtmlListenersAttached=true,element.$$observable_Uid||(element.$$observable_Uid=Binding.BindingCache.GetElementUid(element));let pathResolver=Binding.BindingElementPathResolver.GetInstance(element),settings=element.$$observable_ElementSetting=Binding.BindingCache.GetBindingElement(element.$$observable_Uid).Settings;this.WriteLog(element,`inside CreateHtmlListeners`),settings.ViewListeners&&settings.ViewListeners.ForEach(item1=>{this.WriteLog(element,"Create HtmlListeners: "+item1.EventNames+", jsHandler: "+item1.JsHandler);let fnHandler=this.ResolveHandlerFunction(item1.JsHandler,pathResolver),dsDataPath=pathResolver.CreateAbsoluteDataPath("DataItem");$$calysto(element).On(item1.EventNames,(sender,ev)=>fnHandler.Func(this.CreateHtmlEventContext(fnHandler.HandlerContext,element,item1.EventNames,ev,dsDataPath)))});let tagName=element.tagName.toLowerCase(),isInput=tagName=="input"||tagName=="select"||tagName=="textarea";settings.Bindings&&isInput&&settings.Bindings.ForEach(item1=>{let absoluteDsPath=pathResolver.CreateAbsoluteDataPath(item1.DataSourcePath),bindEvents=item1.EventNames;bindEvents&&bindEvents.length!=0||(bindEvents=element.type=="checkbox"||element.type=="radio"?["change"]:["change"]),this.WriteLog(element,"Create Binding DomListeners: "+bindEvents);let fnGetConvert;item1.JsGetConvert&&(fnGetConvert=this.ResolveHandlerFunction(item1.JsGetConvert,pathResolver)),$$calysto(element).On(bindEvents,(sender,ev)=>{let value=undefined,hasValue=false;if(tagName=="select"&&item1.ElementPath=="options"){let obj1=this.GetValue(absoluteDsPath);[].AddRange(sender.options).ForEach((o,n)=>{Calysto.DataBinder.SetValue(obj1,n+".Selected",!!o.selected)}),this.NotifyPropertyChanged(absoluteDsPath);return}if(tagName=="input"&&item1.ElementPath=="checked"){if(element.name&&(element.type=="radio"||element.type=="checkbox")){let upperPath=this.GetUpperPath(absoluteDsPath),ds1=this.GetValue(upperPath);if(Calysto.Type.TypeInspector.IsArray(ds1)||(upperPath=this.GetUpperPath(upperPath),ds1=this.GetValue(upperPath)),Calysto.Type.TypeInspector.IsArray(ds1)){element.type=="radio"?ds1.ForEach(o=>o[item1.DataSourcePath]=false):element.type=="checkbox",this.SetValueSilent(absoluteDsPath,element.checked),this.NotifyPropertyChanged(upperPath);return}}value=element[item1.ElementPath],hasValue=true}else if(item1.ElementPath=="enabled"){value=!element.disabled,hasValue=true}else if(item1.ElementPath=="disabled"){value=!!element.disabled,hasValue=true}else if(item1.ElementPath=="visible"){value=$$calysto(element).WhereVisible(true).Any(),hasValue=true}else if(item1.ElementPath=="invisible"){value=!$$calysto(element).WhereVisible(true).Any(),hasValue=true}else if(item1.ElementPath=="value"){value=element[item1.ElementPath],hasValue=true}else throw new Error("Not supported: "+item1.ElementPath);if(hasValue){if(item1.JsGetConvert){value=fnGetConvert.Func(this.CreateHtmlEventContext(fnGetConvert.HandlerContext,element,bindEvents||[],ev,absoluteDsPath),value)}else{let dsType=this._cachedDataSourceTypes[absoluteDsPath];if(!dsType){let dsValue=this.GetValue(absoluteDsPath);Calysto.Type.TypeInspector.IsNullOrUndefined(dsValue)||(dsType=Calysto.Type.TypeDescriptor.FromValue(dsValue),this._cachedDataSourceTypes[absoluteDsPath]=dsType)}dsType&&(value=Calysto.Type.TypeConverter.ChangeType(value,dsType))}this.SetValue(absoluteDsPath,value)}})})}}CreateDataSourceContext(context,element,listeningDataPaths,dataPath,values){return{Binder:this,Element:element,DataSource:this.GetDataSource(),DataPath:dataPath,HandlerContext:context,ListeningDataPaths:listeningDataPaths,Values:values}}GetDataSourceValue(element,dataSourcePath){if(dataSourcePath.EndsWith("ItemIndex")){for(var tmpel=element;tmpel&&tmpel!=document;){if(tmpel.$$observable_ItemIndex==0||tmpel.$$observable_ItemIndex>0){return tmpel.$$observable_ItemIndex};tmpel=tmpel.parentNode}throw new Error("ItemIndex not found");}return super.GetValue(dataSourcePath)}CreateDataListeners(element){if(!element.$$observable_hasDataListenersAttached){element.$$observable_hasDataListenersAttached=true,element.$$observable_Uid||(element.$$observable_Uid=Binding.BindingCache.GetElementUid(element)),element.$$observable_DataSourceListeners||(element.$$observable_DataSourceListeners=[]);let listenersItems=element.$$observable_DataSourceListeners,settings=element.$$observable_ElementSetting=Binding.BindingCache.GetBindingElement(element.$$observable_Uid).Settings;this.WriteLog(element,`inside CreateDataSourceListeners`);let pathResolver=Binding.BindingElementPathResolver.GetInstance(element);settings.Sources&&settings.Sources.ForEach(item=>{element.$$observable_DataPath=item.DataSourcePath}),settings.DataListeners&&settings.DataListeners.ForEach(item1=>{let absoluteDataPaths=item1.DataSourcePaths.Select(o=>pathResolver.CreateAbsoluteDataPath(o));absoluteDataPaths.ForEach(path1=>{this.WriteLog(element,"Create DataListener: "+path1);let fnHandler=this.ResolveHandlerFunction(item1.JsHandler,pathResolver);listenersItems.Add(this.dsListeners.AddListener(path1,element,dataPath=>{if(!Calysto.Utility.Dom.IsElementInDom(element)){this.RemoveElementAndListeners(element);return}let valuesArr=absoluteDataPaths.Select(o=>this.GetDataSourceValue(element,o));return fnHandler.Func(this.CreateDataSourceContext(fnHandler.HandlerContext,element,absoluteDataPaths,dataPath,valuesArr),...valuesArr)}))})}),settings.Bindings&&settings.Bindings.ForEach(item1=>{let absolutePath=pathResolver.CreateAbsoluteDataPath(item1.DataSourcePath);this.WriteLog(element,"Create Binding DataSourceListener: "+absolutePath);let fnSetConvert;item1.JsSetConvert&&(fnSetConvert=this.ResolveHandlerFunction(item1.JsSetConvert,pathResolver)),listenersItems.Add(this.dsListeners.AddListener(absolutePath,element,currentPath=>{if(!Calysto.Utility.Dom.IsElementInDom(element)){this.RemoveElementAndListeners(element);return}let value=this.GetDataSourceValue(element,absolutePath);item1.JsSetConvert&&(value=fnSetConvert.Func(this.CreateDataSourceContext(fnSetConvert.HandlerContext,element,[absolutePath],currentPath,[value]),value)),this.SetElementValue(element,item1.ElementPath,value)}))}),settings.Repeaters&&settings.Repeaters.ForEach(item=>{let absolutePath=pathResolver.CreateAbsoluteDataPath(item.DataSourcePath);this.WriteLog(element,"Create Repeater DataSourceListener: "+absolutePath),listenersItems.Add(this.dsListeners.AddListener(absolutePath,element,()=>{if(!Calysto.Utility.Dom.IsElementInDom(element)){this.RemoveElementAndListeners(element);return}let value=this.GetDataSourceValue(element,absolutePath);this.BindDataToRepeater(element,absolutePath,value)}))})}}EnsureRootElement(){var _a,root,arr1,el;if(!this._rootElement){if(!this._rootSelector){throw new Error("Root selector not defined.");}if(root=$$calysto(this._rootSelector).Take(2).ToList(),root.Count()>1){throw new Error("DataBind selector selects "+root.Count()+" elements");}if(this._rootElement=root.FirstOrDefault(),!this._rootElement){throw new Error("DataBind root element not found: "+this._rootElement);}this._rootElement.$$observable_Binder=this,this._rootElement.$$observable_DataPath="@",Binding.BindingCache.InitializeBindings(this._rootElement,(_a=this._factory)===null||_a===void 0?void 0:_a.GetSetup()),arr1=$$calysto(this._rootElement).Query("*, //*").Query(`[${Calysto.Binding.Attributes.Uid}=*]`).Cast().ToArray();for(el of arr1){this.CreateDataListeners(el),this.CreateViewListeners(el)}}}NotifyPropertyChanged(propertyPath){if(!propertyPath||propertyPath.length==0){throw new Error("NotifyPropertyChanged(...) requires an argument");}if(this._recursions++,Math.abs(this._recursions)>100){throw Error("NotifyPropertyChanged recursion overflow");}this.EnsureRootElement(),super.NotifyPropertyChanged(propertyPath),this._recursions--;return this}SetRootElement(calystoSelector){this._rootSelector=calystoSelector;return this}SetFactory(factory){this._factory=factory;let root=factory.GetRoot();root&&(this._rootSelector=`[${Binding.Attributes.Uid}=${factory.GetRoot()}]`);return this}DataBind(){this.NotifyPropertyChanged("@");return this}}Binding.BindingObservable=BindingObservable})(Binding=Calysto.Binding||(Calysto.Binding={}))}(Calysto||(Calysto={})),function(Calysto){var Web;(function(Web){class CalystoVirtualPathHelper{constructor(path){this._path=path}ToAppRelativeUrlPath(){var _a;return(_a=this._appRelative)!==null&&_a!==void 0?_a:this._appRelative=CalystoVirtualPathHelper.CreateAppRelativePath(this._path)}ToVirtualUrlPath(){var _a;return(_a=this._virtualPath)!==null&&_a!==void 0?_a:this._virtualPath=CalystoVirtualPathHelper.CombineToVirtualPath([CalystoVirtualPathHelper.GetBasePath(),this.ToAppRelativeUrlPath()])}static CreateAppRelativePath(anyPath){let str1=anyPath,index;if((index=anyPath.lastIndexOf("/~/"))>=0&&(str1=anyPath.Substring(index+1)),str1.StartsWith("~/")){return str1};let basePath=CalystoVirtualPathHelper.GetBasePath();anyPath.StartsWith(basePath,true)&&(str1=anyPath.Substring(basePath.length));return str1.StartsWith("~/")?str1:str1.StartsWith("/")?"~"+str1:"~/"+str1}static CombineToVirtualPath(paths){let str1=paths.join("/").ReplaceAll("~/","/").ReplaceAll("\\","/").TrimEnd(["/"]);(String.IsNullOrEmpty(str1)||str1=="~")&&(str1+="/");return str1.replace(new RegExp("[/]{2,}","g"),"/")}static GetBasePath(){let basePath=Calysto.Core.Constants.UrlPathBase||"";return basePath=="/"?"":basePath.EndsWith("/")?basePath.TrimEnd(["/"]):basePath}}Web.CalystoVirtualPathHelper=CalystoVirtualPathHelper})(Web=Calysto.Web||(Calysto.Web={}))}(Calysto||(Calysto={})),function(Calysto){var DataAnnotations;(function(DataAnnotations){var Validators;(function(Validators){function GetValidators(sender,context){let validators=[],dic=$$calysto(sender).SelectAttributesAll().First();for(let name in dic){switch(name){case"data-val-required":validators.push(new RequiredValidator(dic[name]));break;case"data-val-email":validators.push(new EmailAddressValidator(dic[name]));break;case"data-val-length":validators.push(new StringLengthValidator(dic[name],parseInt(sender.getAttribute("data-val-length-min")),parseInt(sender.getAttribute("data-val-length-max"))));break;case"data-val-regex":validators.push(new RegularExpressionValidator(dic[name],sender.getAttribute("data-val-regex-pattern")));break;case"data-val-range":validators.push(new RangeValidator(dic[name],parseFloat(sender.getAttribute("data-val-range-min")),parseFloat(sender.getAttribute("data-val-range-max"))));break;case"data-val-minlength":validators.push(new MinLengthValidator(dic[name],parseFloat(sender.getAttribute("data-val-minlength-min"))));break;case"data-val-maxlength":validators.push(new MaxLengthValidator(dic[name],parseFloat(sender.getAttribute("data-val-maxlength-max"))));break;case"data-val-fileextensions":validators.push(new FileExtensionsValidator(dic[name],sender.getAttribute("data-val-fileextensions-extensions")));break;case"data-val-equalto":validators.push(new CompareValidator(dic[name],sender.getAttribute("data-val-equalto-other"),context))}}return validators}Validators.GetValidators=GetValidators;class RequiredValidator{constructor(ErrorText){this.ErrorText=ErrorText}IsValid(value){return!Calysto.Type.TypeInspector.IsNullOrUndefined(value)&&!String.IsNullOrWhiteSpace(value+"")}}class EmailAddressValidator{constructor(ErrorText){this.ErrorText=ErrorText}IsValid(value){if(Calysto.Type.TypeInspector.IsNullOrUndefined(value)){return true};let str1=value+"";return new RegExp("[^@]+[@][^@]+").test(str1)}}class StringLengthValidator{constructor(ErrorText,MinimumLength,MaximumLength){this.ErrorText=ErrorText,this.MinimumLength=MinimumLength,this.MaximumLength=MaximumLength}IsValid(value){if(Calysto.Type.TypeInspector.IsNullOrUndefined(value)){return true};let str1=value+"";return str1.length>=(this.MinimumLength||0)&&str1.length<=(this.MaximumLength||Number.MAX_VALUE)}}class RegularExpressionValidator{constructor(ErrorText,RegexPattern){this.ErrorText=ErrorText,this.RegexPattern=RegexPattern}IsValid(value){if(Calysto.Type.TypeInspector.IsNullOrUndefined(value)){return true};let str1=value+"";return String.IsNullOrEmpty(str1)?true:new RegExp(this.RegexPattern).test(str1)}}class RangeValidator{constructor(ErrorText,Minimum,Maximum){this.ErrorText=ErrorText,this.Minimum=Minimum,this.Maximum=Maximum}IsValid(value){if(Calysto.Type.TypeInspector.IsNullOrUndefined(value)){return true};let val1=parseFloat(value+"");return Calysto.Type.TypeInspector.IsNumber(val1)?val1>=(this.Minimum||Number.MIN_VALUE)&&val1<=(this.Maximum||Number.MAX_VALUE):false}}class MinLengthValidator{constructor(ErrorText,Length){this.ErrorText=ErrorText,this.Length=Length}IsValid(value){if(Calysto.Type.TypeInspector.IsNullOrUndefined(value)){return true};let str1=value+"";return str1.length>=(this.Length||0)}}class MaxLengthValidator{constructor(ErrorText,Length){this.ErrorText=ErrorText,this.Length=Length}IsValid(value){if(Calysto.Type.TypeInspector.IsNullOrUndefined(value)){return true};let str1=value+"";return str1.length<=(this.Length||Number.MAX_VALUE)}}class FileExtensionsValidator{constructor(ErrorText,Extensions){this.ErrorText=ErrorText,this.Extensions=Extensions}IsValid(filename){if(Calysto.Type.TypeInspector.IsNullOrUndefined(filename)){return true};let str1=filename+"",match1=str1.match(new RegExp("[\\w]+$"));if(match1&&match1[0]){let extension=match1[0];return(","+this.Extensions+",").Contains(","+extension+",")}return false}}class CompareValidator{constructor(ErrorText,OtherProperty,Context){this.ErrorText=ErrorText,this.OtherProperty=OtherProperty,this.Context=Context}IsValid(value2){var _a;let prop2=this.OtherProperty.ReplaceAll("*","");for(let prop1 in this.Context.inputs){if(prop1==prop2||prop2.charAt(0)=="."&&prop1.EndsWith(prop2)){let value1=(_a=this.Context.inputs[prop1])===null||_a===void 0?void 0:_a.value;return Calysto.Type.TypeInspector.AreValuesEqual(value2,value1)}}return false}}})(Validators=DataAnnotations.Validators||(DataAnnotations.Validators={}))})(DataAnnotations=Calysto.DataAnnotations||(Calysto.DataAnnotations={}))}(Calysto||(Calysto={})),function(Calysto){var DataAnnotations;(function(DataAnnotations){function FindContainerForm(sender){sender.$$validationContainer||(sender.$$validationContainer=sender.tagName.toLowerCase()=="form"?sender:$$calysto(sender).AncestorNodes("form").First());return sender.$$validationContainer}function FindValidationService(element){let form=FindContainerForm(element);return UseValidationService(form)}function UseValidationService(containerSelector){let form=$$calysto(containerSelector).First(),context=GetOrCreateValidationContext(form);return new CalystoValidationService(context)}function GetOrCreateValidationContext(form){let guid=form.$$validationGuid||(form.$$validationGuid=Calysto.Utility.Generators.GenerateLabel(20)),context=_contextCache[guid]||(_contextCache[guid]={});context.form=form,context.errors=context.errors||[],context.inputsArr=$$calysto(form).Query("//[data-val=true][name]").ToArray(),context.inputs=$$calysto(context.inputsArr).ToRawObject(o=>o.name),context.spans=$$calysto("[data-valmsg-for]").ToRawObject(o=>o.getAttribute("data-valmsg-for"),o=>o),context.summary=$$calysto("[data-valmsg-summary]").ToArray();return context}function InitializeInteractiveValidation(context){$$calysto(context.inputsArr).Where(o=>!o.$$validationInitialized).ForEach(o=>o.$$validationInitialized=true).ForEach(o=>o.$$validationContext=context).OnInput(sender=>{context.isInteractive&&(Calysto.Core.IsDebugDefined,RunValidationSingle(context,sender),RenderErrorsWorker(context))})}function RunValidationSingle(context,sender){Calysto.Core.IsDebugDefined,context.errors.RemoveBy(o=>o.FormsNamePath==sender.name);let value1=sender.value===""?null:sender.value,validators=sender.$$validationValidators||(sender.$$validationValidators=DataAnnotations.Validators.GetValidators(sender,context).Reverse());for(let validator of validators){validator.IsValid(value1)||context.errors.Add({FormsNamePath:sender.name,ErrorText:validator.ErrorText})};Calysto.Core.IsDebugDefined}function RenderErrorsWorker(context){let state=new Calysto.Web.UI.Direct.CalystoMvcModelState;state.RootSelector=context.form;for(let err1 of context.errors){state.Errors.push(new Calysto.KeyValue(err1.FormsNamePath,err1.ErrorText))};state.Render()}class CalystoValidationService{constructor(Context){this.Context=Context}Validate(){this.Context.errors.Clear();for(let name in this.Context.inputs){RunValidationSingle(this.Context,this.Context.inputs[name])};return this}Render(){RenderErrorsWorker(this.Context);return this}HasErrors(){return this.Context.errors.Any()}Interactive(enable){this.Context.isInteractive=!!enable,enable&&InitializeInteractiveValidation(this.Context);return this}}DataAnnotations.FindValidationService=FindValidationService,DataAnnotations.UseValidationService=UseValidationService;let _contextCache={}})(DataAnnotations=Calysto.DataAnnotations||(Calysto.DataAnnotations={}))}(Calysto||(Calysto={})),function(Calysto){var WebControls;(function(WebControls){var CalystoTable;(function(CalystoTable){function EnsureCss(){if(!_cssLoaded){_cssLoaded=true;let url=new Calysto.Web.CalystoVirtualPathHelper(`~/Engine/Src/Core/WebControls/Table/Table.css?v=${Calysto.Core.Constants.ModuleVersion}`).ToVirtualUrlPath();Calysto.ScriptLoader.LoadCSSFile(url)}}function MakeSortable(tableSlector){EnsureCss(),$$calysto(tableSlector).AddClass("calystoSortableTable").Where(o=>!o.$$tableIsSortable).ForEach(o=>{o.$$tableIsSortable=true,MakeTableSortable(o)})}function MakeTableSortable(table){let headTds=$$calysto(table).Query("table tr:take(1)").Query(">td, >th").ForEach((td,index)=>td.$$columnIndex=index).ToArray();headTds.AsEnumerable().AsDomQuery().OnHover(sender=>{sender.style.cursor="pointer",sender.style.textDecoration="underline"},sender=>{sender.style.cursor="",sender.style.textDecoration=""}).OnClick(sender=>{SortBy(sender,table,headTds)})}function GetSortClass(sort){switch(sort){case SortDirection.Asc:return"sortasc";case SortDirection.Desc:return"sortdesc";default:return""}}function SortBy(headTd,table,headTds){(headTd.$$sortDirection||SortDirection.None)==SortDirection.None&&(table.$$unsortedRows?table.$$unsortedRows.ForEach(tr=>{var _a;if((_a=tr.parentNode)!==null&&_a!==void 0){return _a.appendChild(tr)}}):table.$$unsortedRows=$$calysto(table).Query("table tr:skip(1)").ToArray()),headTd.$$sortDirection=((headTd.$$sortDirection||SortDirection.None)+1)%3,headTds.Where(o=>o!=headTd).ForEach(o=>o.$$sortDirection=SortDirection.None),$$calysto(headTds).RemoveClass("sortasc").RemoveClass("sortdesc").Where(o=>o==headTd).ForEach(o=>o.className+=" "+GetSortClass(o.$$sortDirection));var items=$$calysto(table).Query("table tr:skip(1)").Select(tr=>{var val=$$calysto(tr).ChildNodes("td").Where((o,n)=>n==headTd.$$columnIndex).Select(o=>Calysto.Utility.Dom.GetInnerText(o)).FirstOrDefault(),numStr=(val||"").ReplaceAll(",",".").ReplaceAll(" ","").ReplaceAll(" ",""),number=parseFloat(numStr),txt=val.toLowerCase(),considerNumber=numStr==""||numStr==" "||numStr==number+""||numStr.indexOf(number+"")==0;return{tr:tr,str:txt,num:isNaN(number)||considerNumber&&isNaN(number)?Number.MIN_VALUE:number,isNum:considerNumber}}).ToList().AsDomQuery(),numericSort=items.All(o=>o.isNum);let sortedRows,sortDesc=headTd.$$sortDirection==SortDirection.Desc;sortedRows=(headTd.$$sortDirection||0)==SortDirection.None?table.$$unsortedRows:items.OrderBy(o=>numericSort?o.num:o.str,sortDesc).Select(o=>o.tr).ToArray(),sortedRows.ForEach(tr=>{var _a;if((_a=tr.parentNode)!==null&&_a!==void 0){return _a.appendChild(tr)}})}let _cssLoaded=false;let SortDirection;(function(SortDirection){SortDirection[SortDirection.None=0]="None",SortDirection[SortDirection.Desc=1]="Desc",SortDirection[SortDirection.Asc=2]="Asc"})(SortDirection||(SortDirection={})),CalystoTable.MakeSortable=MakeSortable})(CalystoTable=WebControls.CalystoTable||(WebControls.CalystoTable={}))})(WebControls=Calysto.WebControls||(Calysto.WebControls={}))}(Calysto||(Calysto={})),function(Calysto){var Web;(function(Web){var UI;(function(UI){var Direct;(function(Direct){function GetKindColor(kind){switch(kind){case"Message":return"black";case"Error":return"red";case"Warning":return"orange";case"Success":return"green";case"Info":return"blue";default:return"black"}}let Kind;(function(Kind){Kind[Kind.Message=0]="Message",Kind[Kind.Error=1]="Error",Kind[Kind.Warning=2]="Warning",Kind[Kind.Success=3]="Success",Kind[Kind.Info=4]="Info"})(Kind=Direct.Kind||(Direct.Kind={}));class CalystoHtmlBuilder{constructor(){this._messages=[]}AddMessage(kind,text){this._messages.Add(new Calysto.KeyValue(kind,text));return this}GetMessagesTags(){let _this11=this,fn1=function*(){for(var item of _this11._messages){let color=GetKindColor(item.Key);yield`<div class="calysto-html-builder-message-${color}" style="color:${color}">${Calysto.Utility.Html.HtmlEncode(item.Value)}</div>`}};return new Calysto.CalystoEnumerable(()=>Calysto.CalystoEnumerator.From(fn1))}GetHtmlElements(){return this.GetMessagesTags()}HasElements(){return this.GetHtmlElements().Any()}ToHtml(){return this.GetHtmlElements().ToStringJoined()}}Direct.CalystoHtmlBuilder=CalystoHtmlBuilder})(Direct=UI.Direct||(UI.Direct={}))})(UI=Web.UI||(Web.UI={}))})(Web=Calysto.Web||(Calysto.Web={}))}(Calysto||(Calysto={})),function(Calysto){var Web;(function(Web){var UI;(function(UI){var Direct;(function(Direct){class CalystoMvcModelState{constructor(raw,rootSelector,errors,values){this.Errors=[],this.Values=[],this.Raw=raw||{},rootSelector&&(this.RootSelector=rootSelector),errors&&(this.Errors=errors),values&&(this.Values=values)}AddError(pathExpression,errorMsg){this.Errors.push(new Calysto.KeyValue(Calysto.Utility.Expressions.ParsePath(pathExpression),errorMsg))}SetValue(pathExpression,value){let path=Calysto.Utility.Expressions.ParsePath(pathExpression),item=this.Values.Where(o=>o.Key==path).pop();item?item.Value=value:this.Values.push(new Calysto.KeyValue(path,value+"")),Calysto.DataBinder.SetValue(this.Raw,path,value)}Query(pathExpression){let path=Calysto.Utility.Expressions.ParsePath(pathExpression);return $$calysto("[name="+path+"]")}UseDirectQuery(selector,action){let query;query=this.RootSelector?$$calysto(this.RootSelector).Query("*, //*").Query(selector):$$calysto(selector),action(query);return this}ClearErrors(){this.UseDirectQuery("input[name], textarea[name], select[name]",a=>a.RemoveClass("input-validation-error")).UseDirectQuery("span[data-valmsg-for]",a=>a.SetInnerHtml(null).RemoveClass("field-validation-error").AddClass("field-validation-valid")).UseDirectQuery("div[data-valmsg-summary]",a=>a.SetInnerHtml(null).RemoveClass("validation-summary-errors").AddClass("validation-summary-valid"))}RenderErrors(){if(this.Errors.AsEnumerable().GroupBy(o=>o.Key).ToList().ForEach(group=>{this.UseDirectQuery(`[name=${group.Key}]`,a=>a.AddClass("input-validation-error")),this.UseDirectQuery(`[data-valmsg-for=${group.Key}]`,a=>a.AddClass("field-validation-error").AddChildren(group.Select(err=>`<span>${Calysto.Utility.Html.HtmlEncodeSimple(err.Value)}</span>`).ToStringJoined("<br/>")))}),this.Errors.Any()){let lis=this.Errors.Select(err=>`<li>${Calysto.Utility.Html.HtmlEncodeSimple(err.Value)}</li>`).ToStringJoined();this.UseDirectQuery("div[data-valmsg-summary]",a=>a.AddChildren(`<ul>${lis}</ul>`).RemoveClass("validation-summary-valid").AddClass("validation-summary-errors"))}}RenderValues(){for(let val1 of this.Values){this.UseDirectQuery(`[name=${val1.Key}]`,a=>a.SetValueOrInnerHtml(val1.Value))}}Render(){this.ClearErrors(),this.RenderErrors(),this.RenderValues()}}Direct.CalystoMvcModelState=CalystoMvcModelState})(Direct=UI.Direct||(UI.Direct={}))})(UI=Web.UI||(Web.UI={}))})(Web=Calysto.Web||(Calysto.Web={}))}(Calysto||(Calysto={})),function(Calysto){var WebControls;(function(WebControls){function EnsureCss(){if(!_cssLoaded){_cssLoaded=true;let url=new Calysto.Web.CalystoVirtualPathHelper(`~/Engine/Src/Core/WebControls/Scroller/Scroller.css?v=${Calysto.Core.Constants.ModuleVersion}`).ToVirtualUrlPath();Calysto.ScriptLoader.LoadCSSFile(url)}}let _cssLoaded=false;var _html=`<div class="calystoScrollerCtrl calystoScrollerY">
			<div class="calystoScrollerMarker"></div>
		</div>
		<div class="calystoScrollerCtrl calystoScrollerX">
			<div class="calystoScrollerMarker"></div>
		</div>`;class CalystoScroller{constructor(mainElement){this.MinOpacity=10,this.MaxOpacity=100,this.firstInitDone=false,this.contentElWidth=-1,this.contentElHeight=-1,this.mainElWidth=-1,this.mainElHeight=-1,EnsureCss(),this.mainEl=mainElement}get CurrentTop(){return this._currentTop}set CurrentTop(value){this.SetScrollPosition(value,null)}get CurrentLeft(){return this._currentLeft}set CurrentLeft(value){this.SetScrollPosition(null,value)}ScrollersAdjustContent(top,left){let top1=-1*(top/this.maxMarkerTop)*(this.contentEl.scrollHeight-this.mainEl.clientHeight),left1=-1*(left/this.maxMarkerLeft)*(this.contentEl.scrollWidth-this.mainEl.clientWidth);return this.SetScrollPosition(top1,left1)}SetScrollPosition(top,left){var markerTop,markerLeft;typeof top=="number"&&(this.minContentTop=this.mainEl.clientHeight-this.contentEl.scrollHeight,top>0&&(top=0),top<this.minContentTop&&(top=this.minContentTop),top=Math.round(top),this._currentTop=top,this.contentEl.style.marginTop=top+"px",markerTop=-1*this.contentEl.offsetTop/this.contentEl.scrollHeight*this.vSliderEl.offsetHeight,this.vMarkerEl.style.top=Math.round(markerTop)+"px"),typeof left=="number"&&(this.minContentLeft=this.mainEl.clientWidth-this.contentEl.scrollWidth,left>0&&(left=0),left<this.minContentLeft&&(left=this.minContentLeft),left=Math.round(left),this._currentLeft=left,this.contentEl.style.marginLeft=left+"px",markerLeft=-1*this.contentEl.offsetLeft/this.contentEl.scrollWidth*this.hSliderEl.offsetWidth,this.hMarkerEl.style.left=Math.round(markerLeft)+"px");return{endH:left==0||left==this.minContentLeft,endV:top==0||top==this.minContentTop}}WheelAdjustSliderX(sender,ev){var deltaX,left;this.showHorizontal&&(ev=ev||{},deltaX=0,"deltaX"in ev?deltaX=ev.deltaX:"wheelDeltaX"in ev&&(deltaX=-ev.wheelDeltaX),ev.deltaMode==1&&(deltaX*=30),left=this.contentEl.offsetLeft-deltaX,this.SetScrollPosition(null,left))}WheelAdjustSliderY(sender,ev){var deltaY,left,top;(this.showVertical||(ev===null||ev===void 0?void 0:ev.shiftKey))&&(ev=ev||{},deltaY=0,"deltaY"in ev?deltaY=ev.deltaY:"wheelDeltaY"in ev&&(deltaY=-ev.wheelDeltaY),ev.deltaMode==1&&(deltaY*=30),ev.shiftKey?(left=this.contentEl.offsetLeft-deltaY,this.SetScrollPosition(null,left)):(top=this.contentEl.offsetTop-deltaY,this.SetScrollPosition(top,null)))}WheelAdjustSliders(sender,ev){this.WheelAdjustSliderX(sender,ev),this.WheelAdjustSliderY(sender,ev)}CreateAnimator(sender,velocity,isAxisY){this.accelerationAbort=false;var lastVal=0,animator=(new Calysto.Animator).AddValue(0,velocity/3,(anim,currVal)=>{if(this.accelerationAbort){anim.Abort()}else{var obj={};obj[isAxisY?"deltaY":"deltaX"]=lastVal-currVal,isAxisY?this.WheelAdjustSliderY(sender,obj):this.WheelAdjustSliderX(sender,obj),lastVal=currVal}}).Easing("easeOutQuart").Duration(1e3).Start()}CalculateVelocity(sender,statArr){var dt=(new Date).getTime(),list=new Calysto.List(statArr).Reverse().Take(10).ToList(),first=list.FirstOrDefault(),last=list.LastOrDefault();return first&&last&&first.ev&&last.ev&&first.time&&last.time?{deltaX:last.ev.pageX-first.ev.pageX,deltaY:last.ev.pageY-first.ev.pageX,velocityX:(last.ev.pageX-first.ev.pageX)/(last.time-first.time)*1e3||0,velocityY:(last.ev.pageY-first.ev.pageY)/(last.time-first.time)*1e3||0,items:statArr===null||statArr===void 0?void 0:statArr.length}:undefined}HandleAcceleration(sender,statArr){var velocityObj=this.CalculateVelocity(sender,statArr);velocityObj&&(this.showVertical&&velocityObj.velocityY&&Math.abs(velocityObj.deltaY||0)>10&&this.CreateAnimator(sender,velocityObj.velocityY,true),this.showHorizontal&&velocityObj.velocityX&&Math.abs(velocityObj.deltaX||0)>10&&this.CreateAnimator(sender,velocityObj.velocityX,false))}InitElements(){var _a,_b,_c,_d;this.firstInitDone||(this.firstInitDone=true,this.contentEl=$$calysto(this.mainEl).ApplyStyle("overflow:hidden;position:relative;").ChildNodes().Where(function(o){return o.nodeType==1}).First(),$$calysto(this.mainEl).AddChildren(_html));let contentWidth=this.contentEl.scrollWidth;this.contentEl.style.width=contentWidth+"px",this.hSliderEl=$$calysto(this.mainEl).Query("//.calystoScrollerX").SetOpacity(0).ApplyStyle("display","block").First(),this.hMarkerEl=$$calysto(this.hSliderEl).Query("//.calystoScrollerMarker").First(),this.hAR=this.mainEl.clientWidth/contentWidth,this.showHorizontal=this.hAR<1;let contentHeight=this.contentEl.scrollHeight;this.contentEl.style.height=contentHeight+"px",this.vSliderEl=$$calysto(this.mainEl).Query("//.calystoScrollerY").SetOpacity(0).ApplyStyle("display","block").First(),this.vMarkerEl=$$calysto(this.vSliderEl).Query("//.calystoScrollerMarker").First(),this.vAR=this.mainEl.clientHeight/contentHeight,this.showVertical=this.vAR<1,$$calysto(this.vSliderEl).SetOpacity(this.MinOpacity).ApplyStyle("display",this.showVertical?"block":"none"),$$calysto(this.hSliderEl).SetOpacity(this.MinOpacity).ApplyStyle("display",this.showHorizontal?"block":"none"),this.hMarkerEl.style.width=Math.round(this.hSliderEl.offsetWidth*this.hAR)+"px",this.maxMarkerLeft=((_b=(_a=this.hMarkerEl)===null||_a===void 0?void 0:_a.parentNode)===null||_b===void 0?void 0:_b.clientWidth)-this.hMarkerEl.offsetWidth,this.vMarkerEl.style.height=Math.round(this.vSliderEl.offsetHeight*this.vAR)+"px",this.maxMarkerTop=((_d=(_c=this.vMarkerEl)===null||_c===void 0?void 0:_c.parentNode)===null||_d===void 0?void 0:_d.clientHeight)-this.vMarkerEl.offsetHeight}CopyEvent(ev){return ev?{pageX:ev.pageX,pageY:ev.pageY,clientX:ev.clientX,clientY:ev.clientX}:null}InitializeEvents(){$$calysto([this.hMarkerEl,this.vMarkerEl]).On(["mousedown","touchstart"],sender=>{this.markerDragging=sender});let faderAnimator,currentShowState="None",fnScrollbarsShow=()=>{currentShowState!="Showing"&&(currentShowState="Showing",faderAnimator===null||faderAnimator===void 0?void 0:faderAnimator.Abort(),faderAnimator=$$calysto([this.hSliderEl,this.vSliderEl]).ToAnimator({opacity:this.MaxOpacity}).Start())},fnScrollbarsHide=()=>{currentShowState!="Hiding"&&(currentShowState="Hiding",faderAnimator===null||faderAnimator===void 0?void 0:faderAnimator.Abort(),faderAnimator=$$calysto([this.hSliderEl,this.vSliderEl]).ToAnimator({opacity:this.MinOpacity}).Start())};$$calysto(this.mainEl).ForEach(el=>{$$calysto([this.hSliderEl,this.vSliderEl]).SetOpacity(this.MinOpacity),this.WheelAdjustSliders(el,null)}).On(["hover","mouseover","mousemove","wheel"],()=>{fnScrollbarsShow()}).On(["hout"],()=>{fnScrollbarsHide()}).On(["scroll","mousewheel","wheel","DOMMouseScroll"],(sender,ev)=>{let doAdjust=false;if(this.showVertical&&(ev.type=="wheel"||ev.type=="mousewheel")?doAdjust=true:this.showHorizontal&&(ev===null||ev===void 0?void 0:ev.shiftKey)?doAdjust=true:this.showHorizontal&&(Math.abs(ev===null||ev===void 0?void 0:ev.deltaX)>0||Math.abs(ev===null||ev===void 0?void 0:ev.wheelDeltaX)>0)&&(doAdjust=true),doAdjust){this.WheelAdjustSliders(sender,ev);return false}return true}).On(["mousedown","touchstart"],(sender,ev)=>{ev.type=="touchstart"&&(ev=ev.touches[0]),this.moveStatistics=[],this.accelerationAbort=true,this.startCondition={event:this.CopyEvent(ev),contentLeft:this.contentEl.offsetLeft,contentTop:this.contentEl.offsetTop,vMarkerTop:this.vMarkerEl.offsetTop,hMarkerLeft:this.hMarkerEl.offsetLeft}}),$$calysto(document).On(["mouseup","touchend"],()=>{this.moveStatistics&&!this.markerDragging&&this.HandleAcceleration(this.mainEl,this.moveStatistics),this.moveStatistics=null,this.markerDragging=null,this.startCondition=null}),$$calysto([document,this.mainEl]).On(["mousemove","touchmove"],(sender,ev)=>{var left,top;if(!this.startCondition){return true};if(ev.type=="touchmove"&&(ev=ev.touches[0]),fnScrollbarsShow(),this.moveStatistics.push({time:(new Date).getTime(),ev:this.CopyEvent(ev)}),this.markerDragging==this.hMarkerEl){left=Math.round(this.startCondition.hMarkerLeft-(this.startCondition.event.pageX-ev.pageX)),this.ScrollersAdjustContent(null,left);return false}if(this.markerDragging==this.vMarkerEl){top=Math.round(this.startCondition.vMarkerTop-(this.startCondition.event.pageY-ev.pageY)),this.ScrollersAdjustContent(top,null);return false}if(!this.markerDragging){var deltaY=this.startCondition.event.pageY-ev.pageY,deltaX=this.startCondition.event.pageX-ev.pageX,top=Math.round(this.startCondition.contentTop-deltaY),left=Math.round(this.startCondition.contentLeft-deltaX),res=this.SetScrollPosition(top,left);return Math.abs(deltaX)>10&&(res===null||res===void 0?void 0:res.endH)?true:Math.abs(deltaY)>10&&(res===null||res===void 0?void 0:res.endV)?true:false}return true})}Start(){this.InitElements(),this.InitializeEvents();var _interval1=setInterval(()=>{this.contentEl&&this.mainEl&&this.contentEl.scrollHeight>0&&this.contentEl.scrollWidth>0&&(this.contentEl.scrollWidth!=this.contentElWidth||this.contentEl.scrollHeight!=this.contentElHeight||this.mainEl.clientWidth!=this.mainElWidth||this.mainEl.clientHeight!=this.mainElHeight)&&(this.contentElWidth=this.contentEl.scrollWidth,this.contentElHeight=this.contentEl.scrollHeight,this.mainElWidth=this.mainEl.clientWidth,this.mainElHeight=this.mainEl.clientHeight,this.InitElements())},2e3)}static Create(selector){$$calysto(selector||".calystoScroller").Where(function(o){return!o.__calystoScroller}).ForEach(function(o){o.__calystoScroller=true}).ForEach(function(o){let scr1=new CalystoScroller(o);scr1.Start(),o.__calystoScroller=scr1})}}WebControls.CalystoScroller=CalystoScroller})(WebControls=Calysto.WebControls||(Calysto.WebControls={}))}(Calysto||(Calysto={})),Calysto.TestTools.TestRunner.AddTest(()=>{var res1=[{Ime:"ante",Godine:[1,2,3,4]},{Ime:"ante2",Godine:[13,2,3,4]},{Ime:"ante",Godine:[5,43,4]}].AsEnumerable().SelectMany(o=>o.Godine).ToArray(),res2=["fsdagasd","fdder","ff","tt","oc","one","one","one","two","two","nemza","temza","aa","bb","cc"].AsEnumerable().OrderBy(o=>o.length,true).ThenBy(o=>o,true).ThenBy(o=>o.length,true).Skip(1).Take(4).ToStringJoined("; ");console.log("CalystoEnumerable test successful")}),Calysto.TestTools.TestRunner.AddTest(()=>{var dic=new Calysto.Dictionary,res1,dic2,res2;dic.Add("dva","fasdf"),dic.Add(1,3),dic.Add(5,342352362344237623453734),dic.Add(51,344237623453734),dic.Add(true,344237623453734),dic.Add(false,344237623453734),res1=[dic.Count(),dic.GetValue(5),dic.ContainsKey(51),dic.ContainsKey("51"),dic.GetKeys().join(","),dic.GetValues().join(",")].join(";");Calysto.TestTools.UnitTesting.Assert.AreEqual("6;3.423523623442376e+23;true;false;dva,1,5,51,true,false;fasdf,3,3.423523623442376e+23,344237623453734,344237623453734,344237623453734",res1),dic2=new Calysto.Dictionary,dic2.Add("name","first").Add("last","lastname"),res2=[dic2.Count(),dic2.GetValues().join(","),dic2.GetKeys().join(",")].join(";"),Calysto.TestTools.UnitTesting.Assert.AreEqual("2;first,lastname;name,last",res2),console.log("Dictionary test successful")}),Calysto.TestTools.TestRunner.AddTest(()=>{var res1=[Calysto.Enum.GetNames(Calysto.Type.KnownType).join(","),Calysto.Enum.GetValues(Calysto.Type.KnownType).join(","),Calysto.Enum.GetValue(Calysto.Type.KnownType,"Boolean"),Calysto.Enum.GetValue(Calysto.Type.KnownType,"Number"),Calysto.Enum.GetName(Calysto.Type.KnownType,3),Calysto.Enum.GetName(Calysto.DayOfWeek,2),Calysto.Enum.GetValue(Calysto.DayOfWeek,"Monday"),Calysto.Enum.HasName(Calysto.DayOfWeek,"Monday"),Calysto.Enum.HasName(Calysto.DayOfWeek,"somename"),Calysto.Enum.HasName(Calysto.DayOfWeek,""),Calysto.Enum.HasValue(Calysto.DayOfWeek,3),Calysto.Enum.HasValue(Calysto.DayOfWeek,33),Calysto.Enum.HasValue(Calysto.DayOfWeek,NaN)].join(";");if(res1!="String,Boolean,Decimal,Number,Integer,Array,Function,DateTime,Date,Any;1,2,3,4,5,6,7,8,9,10;2;4;Decimal;Tuesday;1;true;false;false;true;false;false"){throw new Error("Error in Calysto.Enum tests, result: "+res1);}console.log("Enum tests successful")}),Calysto.TestTools.TestRunner.AddTest(()=>{function UsingCulture(culture,func){var original=Calysto.Globalization.CultureInfo.CurrentCulture;Calysto.Globalization.CultureInfo.CurrentCulture=culture||Calysto.Globalization.CultureInfo.USCulture,func(),Calysto.Globalization.CultureInfo.CurrentCulture=original}UsingCulture(Calysto.Globalization.CultureInfo.USCulture,function(){var isOldMsie=Calysto.Features.GetBrowser().KindName=="MSIE"&&Calysto.Features.GetBrowser().Version<=8,res1,vals1,res2,vals2,list,n,o1,res3,temp1,refOutArr,res4,res5;if(!isOldMsie){list=new Calysto.List,Calysto.Collections.ForEachProperties(Calysto.Type.KnownType,function(name,value){list.Add(name+":"+value)}),res1=list.ToStringJoined("; ");for(Calysto.TestTools.UnitTesting.Assert.AreEqual("1:String; 2:Boolean; 3:Decimal; 4:Number; 5:Integer; 6:Array; 7:Function; 8:DateTime; 9:Date; 10:Any; String:1; Boolean:2; Decimal:3; Number:4; Integer:5; Array:6; Function:7; DateTime:8; Date:9; Any:10",res1),vals1=["s1","",null,"true",true,false,undefined,2.34,541e3,64,[3,4,2],document.documentElement.childNodes,function(){return 3},Calysto.DateTime.Now(),new Date,{custom:"fsdfsad"}],list=new Calysto.List,n=0;n<vals1.length;n++){try{list.Add(Calysto.Type.TypeDescriptor.FromValue(vals1[n]).NullableTypeName)}catch(e){list.Add("unresolved")}}for(res2=list.ToStringJoined("; "),Calysto.TestTools.UnitTesting.Assert.AreEqual("String; String; Any?; String; Boolean; Boolean; Any?; Decimal; Decimal; Decimal; Array; Array; Function; DateTime; Date; unresolved",res2),vals2=["s1","",null,"true",true,false,undefined,{value:2.34,calystoFormat:"N3"},{value:5.41345,calystoFormat:"n2"},{value:541e3,calystoFormat:"N4"},{value:541e3,calystoFormat:"C4"},{value:541e3,calystoFormat:"C4",culture:Calysto.Globalization.CultureInfo.HRCulture},64,[3,4,2],{value:Calysto.DateTime.ParseDateTime("18.5.2016. 22:44:26","dd.MM.yyyy. HH:mm:ss"),culture:Calysto.Globalization.CultureInfo.USCulture},{value:Calysto.DateTime.ParseDateTime("18.5.2016. 22:44:26","dd.MM.yyyy. HH:mm:ss"),culture:Calysto.Globalization.CultureInfo.HRCulture},{value:Calysto.DateTime.ParseDateTime("18.5.2016. 22:44:26","dd.MM.yyyy. HH:mm:ss"),calystoFormat:"dd.MM.yyyy. HH:mm:ss.ff"},{value:new Calysto.DateTime("2016-05-19 02:44:00"),calystoFormat:"MM/dd/yyyy HH:mm"},{custom:"fsdfsad"},(new Calysto.TimeSpan).AddDays(2).AddHours(28).AddMinutes(14).AddSeconds(156).AddMilliseconds(1463).AddTicks(234534)],list=new Calysto.List,n=0;n<vals2.length;n++){try{o1=vals2[n],UsingCulture(o1&&o1.culture?o1.culture:null,function(){o1&&(o1.calystoFormat||o1.culture)?list.Add(Calysto.Type.TypeConverter.ToStringFormated(o1.value,o1.calystoFormat)):list.Add(Calysto.Type.TypeConverter.ToStringFormated(o1))})}catch(e){list.Add("unresolved")}}res3=list.ToStringJoined("; ");Calysto.TestTools.UnitTesting.Assert.AreEqual("s1; ; ; true; true; false; ; 2.340; 5.41; 541,000.0000; $541,000.0000; 541.000,0000 kn; 64; [3,4,2]; 5/18/2016 10:44:26 PM; 18.5.2016. 22:44:26; 18.05.2016. 22:44:26.00; 05/19/2016 02:44; unresolved; 76:20:31.997",res3);class BoxStack extends Calysto.BoxValue{constructor(){super(...arguments),this.Items=[]}SetValue(value){this.Items.push(value)}}temp1={},Calysto.DataBinder.SetValue(temp1,"prop1.prop2.prop3.prop4.prop5",234),Calysto.DataBinder.SetValue(temp1,"prop1.prop2.prop3.Value5",111),refOutArr=new BoxStack,res4=[Calysto.Type.TypeConverter.ChangeType("True","Boolean"),Calysto.Type.TypeConverter.ChangeType("true","Boolean"),Calysto.Type.TypeConverter.ChangeType("false","Boolean"),Calysto.Type.TypeConverter.ChangeType("False","Boolean"),Calysto.Type.TypeConverter.ChangeType("0","Boolean"),Calysto.Type.TypeConverter.ChangeType("1","Boolean"),Calysto.Type.TypeConverter.ChangeType(0,"Boolean"),Calysto.Type.TypeConverter.ChangeType(1,"Boolean"),Calysto.Type.TypeConverter.ChangeType(undefined,"Boolean?"),Calysto.Type.TypeConverter.ChangeType(undefined,"Integer",true),Calysto.Type.TypeConverter.ChangeType("","Decimal",true),Calysto.Type.TypeConverter.ChangeType("","Boolean",true),Calysto.Type.TypeConverter.ChangeType("","String",true),Calysto.Type.TypeConverter.ChangeType(null,"String",true),Calysto.Type.TypeConverter.ChangeType(undefined,"String?"),Calysto.Type.TypeConverter.ChangeType("-2.53","Decimal"),Calysto.Type.TypeConverter.ChangeType("-12.553","Number"),Calysto.Type.TypeConverter.ChangeType("-42.1234","Integer"),Calysto.Type.TypeConverter.ChangeType(-432.23432,"Decimal"),Calysto.Type.TypeConverter.ChangeType(-4435.53241,"Integer"),Calysto.Type.TypeConverter.ChangeType("[34,53,4325]","Array"),Calysto.DateTime.ParseDateTime("18.05.2016. 22:44:26.42","dd.MM.yyyy"),Calysto.DateTime.ParseDateTime("18.05.2016. 22:44:26.42","dd.MM.yyyy"),Calysto.DateTime.ParseDateTime("18.05.2016. 22:44:26.42","dd.MM.yyyy. HH:mm:ss.ff"),"valueTypeTest",Calysto.Type.TypeInspector.IsValueType(null),Calysto.Type.TypeInspector.IsValueType(""),Calysto.Type.TypeInspector.IsValueType(function(){}),Calysto.Type.TypeInspector.IsValueType({}),Calysto.Type.TypeInspector.IsValueType(2),Calysto.Type.TypeInspector.IsValueType(true),"containPropertyTest",Calysto.Type.TypeInspector.ContainsProperty({dva:43},"dva"),Calysto.Type.TypeInspector.ContainsProperty({dvatri:43},"dva"),"dataBinderTryGetValueTest",Calysto.DataBinder.TryGetValue({dva:2,trie:3},"dva2",refOutArr),Calysto.DataBinder.TryGetValue({dva:2,trie:{dva:2,trie:{dva:2,trie:3}}},"trie.trie.dva",refOutArr),Calysto.DataBinder.TryGetValue({dva:2,trie:3},"dva",refOutArr),Calysto.DataBinder.TryGetValue({},"dva",refOutArr),"temp1isnext",temp1,"trygetvalue11",Calysto.DataBinder.TryGetValue(temp1,"prop1.prop2.prop3.prop4.prop5",refOutArr),Calysto.DataBinder.TryGetValue(temp1,"prop1.prop2.prop3.Value5",refOutArr),Calysto.DataBinder.TryGetValue(temp1,"prop1.prop2",refOutArr),Calysto.DataBinder.TryGetValue(temp1,"prop1.prop2.",refOutArr),Calysto.DataBinder.TryGetValue(temp1,"prop1.prop4",refOutArr),"refOutArrStart",refOutArr.Items];res5=Calysto.Json.Serialize(res4),Calysto.TestTools.UnitTesting.Assert.AreEqual('[true,true,false,false,false,true,false,true,null,null,null,null,"",null,null,-2.53,-12.553,-42,-432.23432,-4435,["34","53","4325"],{"__calystotype":"Calysto_Date","Date":"2016-05-18T00:00:00.000"},{"__calystotype":"Calysto_Date","Date":"2016-05-18T00:00:00.000"},{"__calystotype":"Calysto_Date","Date":"2016-05-18T22:44:26.420"},"valueTypeTest",false,true,false,false,true,true,"containPropertyTest",true,false,"dataBinderTryGetValueTest",false,true,true,false,"temp1isnext",{"prop1":{"prop2":{"prop3":{"prop4":{"prop5":234},"Value5":111}}}},"trygetvalue11",true,true,true,true,false,"refOutArrStart",[2,2,234,111,{"prop3":{"prop4":{"prop5":234},"Value5":111}},{"prop3":{"prop4":{"prop5":234},"Value5":111}}]]',res5),console.log("DataBinder.SetValue test successful"),console.log("DataBinder.TryGetValue test successful"),console.log("DateTime.Parse test successful"),console.log("Type.ChangeType test successful"),console.log("Type test successful")}})}),Calysto.TestTools.TestRunner.AddTest(()=>{var text1="this is my text and chars žćčđšĐŠŽĆČ?",ss=Calysto.Utility.Encoding.RfcBase64.EncodeToBase64String(text1),dd,text2,hh,aa1,base64,res2,res4,res5;if(ss!="dGhpcyBpcyBteSB0ZXh0IGFuZCBjaGFycyDFvsSHxI3EkcWhxJDFoMW9xIbEjD8="){throw new Error("Calysto.Utility.Encoding.RfcBase64.EncodeToBase64String() self test error. Result: "+ss);}if(dd=Calysto.Utility.Encoding.RfcBase64.DecodeBase64StringToString(ss),dd!=text1){throw new Error("Calysto.Utility.Encoding.RfcBase64.DecodeBase64StringToString() self test error. Result: "+dd);}if(text2="http://sitežlkjđšžćč.com/?čščćžđaša fds žhsdf",hh=Calysto.Utility.Html.UrlEncode(text2),hh!="http%3A%2F%2Fsite%C3%85%C2%BElkj%C3%84%C2%91%C3%85%C2%A1%C3%85%C2%BE%C3%84%C2%87%C3%84%C2%8D.com%2F%3F%C3%84%C2%8D%C3%85%C2%A1%C3%84%C2%8D%C3%84%C2%87%C3%85%C2%BE%C3%84%C2%91a%C3%85%C2%A1a%20fds%20%C3%85%C2%BEhsdf"){throw new Error("Calysto.Utility.Html.UrlEncode() self test error. Result: "+hh);}if(aa1=Calysto.Utility.Html.UrlDecode(hh),aa1!=text2){throw new Error("Calysto.Utility.Html.UrlDecode() self test error. Result: "+hh);}var txt1="this is my žćčđšŽĆČĐŠ string",bytes=Calysto.Utility.Encoding.UTF8.GetBytes(txt1),res1=Calysto.Utility.Encoding.UTF8.GetString(bytes);if(res1!=txt1){throw new Error("Calysto.Utility.Encoding.UTF8.GetString() self test error. Result: "+res1+", expected: "+txt1);}if(base64=(new Calysto.Utility.Encoding.CalystoBaseConverter).EncodeToBaseString(bytes,6),res2=(new Calysto.Utility.Encoding.CalystoBaseConverter).DecodeBaseStringToString(base64,6),res2!=txt1){throw new Error("Calysto.Utility.Encoding.CalystoBaseConverter.DecodeBaseStringToString() self test error. Result: "+res2+", expected: "+txt1);}if(res4=[Calysto.Utility.Path.GetQueryString("\\fasdfs\\hhdfg\\yerrre.cs?fsfs=twerew"),Calysto.Utility.Path.GetDirectoryName("\\fasdfs\\hhdfg\\yerrre.cs?fsfs=twerew"),Calysto.Utility.Path.GetFilePath("\\fasdfs\\hhdfg\\yerrre.cs?fsfs=twerew"),Calysto.Utility.Path.GetFileName("\\fasdfs\\hhdfg\\yerrre.cs?fsfs=twerew"),Calysto.Utility.Path.GetExtension("\\fasdfs\\hhdfg\\yerrre.cs?fsfs=twerew")].join(", "),res5="?fsfs=twerew, \\fasdfs\\hhdfg, \\fasdfs\\hhdfg\\yerrre.cs, yerrre.cs, .cs",res4!=res5){throw new Error("Calysto.Utility.Path selftest error. Result: "+res4+", expected: "+res5);}if(Calysto.Utility.CalystoTools.ByteArrayToLong(Calysto.Utility.CalystoTools.LongToByteArray(20042362354623561))!=20042362354623561){throw new Error("Selftest ByteArrayToLong failed");}console.log("Utility test successful")}),Calysto.TestTools.TestRunner.AddTest(()=>{var res1=["hretygsadfewh/ghsd/.?gsadf".EndsWith("adf"),"hretygsadfewh/ghsd/.?gsadf".EndsWith("aDf",true),"hretygsadfewh/ghsd/.?gsadf".EndsWith("aDf"),"hretygshreadfewh/ghsd/.?gsadf".StartsWith("hre"),"hretygshreadfewh/ghsd/.?gsadf".StartsWith("hRe",true),"hretygshreadfewh/ghsd/.?gsadf".StartsWith("hRe"),"hretygsadfewh/ghsd/.?gsadf".Contains("gh"),"hretygsadfewh/ghsd/.?gsadf".Contains("G"),"hretygsadfewh/ghsd/.?gsadf".Contains("GH",true),"hretygsadfewh/ghsd/.?gsadf".GetHashCode(),"hretygsadfewh/ghsd/.?gsadf".Remove(4),"hretygsadfewh/ghsd/.?gsadf".Remove(324),"hretygsadfewh/ghsd/.?gsadf".Repeat(3),"hretygsadfewh/ghsd/.?gsadf".Repeat(0)].join("_"),res2;if(res1!="true_true_false_true_true_false_true_false_true_-914965447_hret_hretygsadfewh/ghsd/.?gsadf_hretygsadfewh/ghsd/.?gsadfhretygsadfewh/ghsd/.?gsadfhretygsadfewh/ghsd/.?gsadf_"){throw new Error("Error in String test1, result: "+res1);}if(res2=["testfunction(){reutrn false; {name1} was not {cars.1} {years.birth} {cars.2} hretygsadfewh/ghsd/.?gsadf}".FormatWith({name1:"John Bravo",years:{birth:22,school:8},cars:["ford","bmw","audi"]}),"hretygsadfewh/ghsd/.?gsadf".ReplaceAll("h","1"),"hretygsadfewh/ghsd/.?gsadf".TakeFirst(5),"hretygsadfewh/ghsd/.?gsadf".TakeFirst(5,"..."),"hretyy".TakeFirst(5,"..."),"hrety".TakeFirst(5,"..."),"hretyy".TakeFirst(4,"..."),"hretygsadfewh/ghsd/.?gsadf".TakeLast(5),"hretygsadfewh/ghsd/.?gsadf".TakeLast(5,"..."),"hretyg".TakeLast(7,"..."),"hretyg".TakeLast(6,"..."),"hretyg".TakeLast(5,"..."),"this is my word number one".TakeLast(15,"..."),"this is my word number one".TakeLast(15,"...",true),"this is my word number one".TakeFirst(15,"...",true),"this is my word number one".TakeFirst(14,"...",true),"this is my word number one".TakeFirst(16,"...",true),String.IsNullOrEmpty(),String.IsNullOrEmpty(""),String.IsNullOrEmpty("d"),String.IsNullOrEmpty("gsdf"),String.IsNullOrWhiteSpace(),String.IsNullOrWhiteSpace("false"),String.IsNullOrWhiteSpace(""),String.IsNullOrWhiteSpace(" "),String.IsNullOrWhiteSpace(" e"),String.IsNullOrWhiteSpace(" \r\n\t"),String.IsNullOrWhiteSpace("\t"),String.IsNullOrWhiteSpace("\t\n")].join("_"),res2!="testfunction(){reutrn false; John Bravo was not bmw 22 audi hretygsadfewh/ghsd/.?gsadf}_1retygsadfew1/g1sd/.?gsadf_hrety_hr..._hr..._hr..._h..._gsadf_...df_hretyg_...tyg_...yg_...d number one_...number one_this is my..._this is my..._this is my..._true_true_false_false_true_false_true_true_false_true_true_true"){throw new Error("Error in String test2, result: "+res2);}console.log("String test successful")}),Calysto.TestTools.TestRunner.AddTest(()=>{function UsingCulture2(culture,func){var original=Calysto.Globalization.CultureInfo.CurrentCulture;Calysto.Globalization.CultureInfo.CurrentCulture=culture||Calysto.Globalization.CultureInfo.USCulture,func(),Calysto.Globalization.CultureInfo.CurrentCulture=original}UsingCulture2(Calysto.Globalization.CultureInfo.USCulture,function(){let res1=[(-36324263299.49234).ToStringFormated("n6"),(-36324263299.49234).ToStringFormated("n8"),(-36324263299.49234).ToStringFormated("n7"),(-3.6324263299492343).ToStringFormated("n15"),(-3.6324263299492343).ToStringFormated("n12"),(-3.6324263299492343).ToStringFormated("n13"),(-3.6324263299492343).ToStringFormated("n10"),(-3.6324263299492343).ToStringFormated("n9"),(-3.6324263299492343).ToStringFormated("n3"),(-3.6324263299492343).ToStringFormated("n2"),(-3.6324263299492343).ToStringFormated("n1"),(-3.6324263299492343).ToStringFormated("n0"),(-3.6324263299492343).ToStringFormated("n6"),(-3.6324263299492343).ToStringFormated("n5"),3.6324263299492343.ToStringFormated("n5"),3.6324263299492343.ToStringFormated("n6"),3.6324263299492343.ToStringFormated("n3"),3.6324263299492343.ToStringFormated("n1"),3.6324263299492343.ToStringFormated("n0"),3.6324263299492343.ToStringFormated("n")],s1=res1.join(";"),exp1="-36,324,263,299.492350;-36,324,263,299.49234000;-36,324,263,299.4923400;-3.632426329949234;-3.632426329949;-3.6324263299492;-3.6324263299;-3.632426330;-3.632;-3.63;-3.6;-4;-3.632426;-3.63243;3.63243;3.632426;3.632;3.6;4;3.63";if(s1!=exp1){throw new Error("Error in Number test1, result: "+s1+", expected: "+exp1);}console.log("Number test successful")})}),Calysto.TestTools.TestRunner.AddTest(()=>{var aa1=new Calysto.QueryString("http://toolnix.com/widgetcontent?marker=1&balloon=0&width=400&height=200&mid=2004&sig=fsdaf"),res1=aa1.GetUrl();if("http://toolnix.com/widgetcontent?marker=1&balloon=0&width=400&height=200&mid=2004&sig=fsdaf"!=res1){throw new Error("Calysto.QueryString #1 selftest error. Result: "+res1+", expected: http://toolnix.com/widgetcontent?marker=1&balloon=0&width=400&height=200&mid=2004&sig=fsdaf");}if(aa1=new Calysto.QueryString("http://toolnix.com/widgetcontent"),res1=aa1.GetUrl(),"http://toolnix.com/widgetcontent"!=res1){throw new Error("Calysto.QueryString #2 selftest error. Result: "+res1+", expected: http://toolnix.com/widgetcontent");}if(aa1=new Calysto.QueryString("http://toolnix.com/widgetcontent?marker=1&balloon=0&width=400&height=200&mid=2004&#fasdf#fasdf"),aa1.SetValue("mmm",1043),aa1.RemoveValue("balloon"),res1=aa1.GetUrl(),"http://toolnix.com/widgetcontent?marker=1&width=400&height=200&mid=2004&mmm=1043#fasdf#fasdf"!=res1){throw new Error("Calysto.QueryString #3 selftest error. Result: "+res1+", expected: http://toolnix.com/widgetcontent?marker=1&width=400&height=200&mid=2004&mmm=1043");}if(aa1=new Calysto.QueryString("http://toolnix.com/widgetcontent?marker=1&balloon=0&width=400&height=200&mid=2004&#fasdf#fasdf"),aa1.SetValue("mmm",1043),aa1.RemoveValue("balloon"),res1=aa1.GetUrl(),"http://toolnix.com/widgetcontent?marker=1&width=400&height=200&mid=2004&mmm=1043#fasdf#fasdf"!=res1){throw new Error("Calysto.QueryString #4 selftest error. Result: "+res1+", expected: http://toolnix.com/widgetcontent?marker=1&width=400&height=200&mid=2004&mmm=1043#fasdf#fasdf");}if(aa1=new Calysto.QueryString("http://toolnix.com/widgetcontent?marker=1&balloon=0&width=400&height=200&mid=2004&"),aa1.SetValue("height",42353),res1=aa1.GetUrl(),"http://toolnix.com/widgetcontent?marker=1&balloon=0&width=400&height=42353&mid=2004"!=res1){throw new Error("Calysto.QueryString #5 selftest error. Result: "+res1+", expected: http://toolnix.com/widgetcontent?marker=1&balloon=0&width=400&height=42353&mid=2004");}console.log("QueryString test successful")}),Calysto.TestTools.TestRunner.AddTest(()=>{var str="fasdg423675wefdfhuioyfasdyqpoeriu7234rfdsdhlkj6rfa234fdashasdf",res1=new Calysto.Regex("fa").Matches(str).AsEnumerable().Select(function(o){return o.Value+", "+o.Success+", "+o.Index}).ToStringJoined(";"),res2,res3,res4,res5,res6;if(res1!="fa, true, 0;fa, true, 21;fa, true, 48"){throw new Error("Calysto.Regex selftest #1 failed, res: "+res1);}if(res2=new Calysto.Regex("fa").SelectMatches(str).Select(function(o){return o.Value+", "+o.Success+", "+o.Index}).ToStringJoined(";"),res2!="fa, true, 0;fa, true, 21;fa, true, 48"){throw new Error("Calysto.Regex selftest #2 failed, res: "+res2);}if(res3=new Calysto.Regex("fa").SelectSegments(str).Select(function(o){return o.Value+", "+o.Success+", "+o.Index}).ToStringJoined(";"),res3!="fa, true, 0;sdg423675wefdfhuioy, false, 2;fa, true, 21;sdyqpoeriu7234rfdsdhlkj6r, false, 23;fa, true, 48;234fdashasdf, false, 50"){throw new Error("Calysto.Regex selftest #3 failed, res: "+res3);}if(res4=new Calysto.Regex("fa").SelectSegments(str).Select(function(o){return o.Value}).ToStringJoined(";"),res4!="fa;sdg423675wefdfhuioy;fa;sdyqpoeriu7234rfdsdhlkj6r;fa;234fdashasdf"){throw new Error("Calysto.Regex selftest #4 failed, res: "+res4);}if(res5=new Calysto.Regex("fa").SelectSegments(str).Select(function(o){return o.Value}).ToStringJoined(""),res5!="fasdg423675wefdfhuioyfasdyqpoeriu7234rfdsdhlkj6rfa234fdashasdf"){throw new Error("Calysto.Regex selftest #5 failed, res: "+res5);}if(res6="pos-bottom-center, pos-bottom-center2".ReplaceAll("pos-","replacedText"),res6!="replacedTextbottom-center, replacedTextbottom-center2"){throw new Error("Calysto.Regex selftest #6 failed, res: "+res6);}console.log("Regex test successful")}),Calysto.TestTools.TestRunner.AddTest(()=>{var isOldMsie=Calysto.Features.GetBrowser().KindName=="MSIE"&&Calysto.Features.GetBrowser().Version<=8,res56,res56exp,arr23,cnt13;if(!isOldMsie){var o1=Calysto.Json.Deserialize('{"msg":"hasdfs","files":[{"DataUrl":"","BlobIndex":0,"FileName":"img_1.gif","MimeType":"image/gif","Size":56591,"__calystotype":"Calysto222222_Blob"},{"DataUrl":"","BlobIndex":1,"FileName":"img_2.gif","MimeType":"image/gif","Size":70622,"__calystotype":"Calysto222222_Blob"},{"DataUrl":"","BlobIndex":2,"FileName":"img_3.gif","MimeType":"image/gif","Size":68342,"__calystotype":"Calysto222222_Blob"},{"DataUrl":"","BlobIndex":3,"FileName":"img_4.gif","MimeType":"image/gif","Size":95296,"__calystotype":"Calysto222222_Blob"},{"DataUrl":"","BlobIndex":4,"FileName":"img_5.gif","MimeType":"image/gif","Size":87117,"__calystotype":"Calysto222222_Blob"}]}'),o2=new Calysto.Json.JsonNode(o1),res55=Calysto.Json.Serialize(o2.Descendants(true).Skip(1).Take(2).ToArray()),res55exp=`[{"Property":"msg","Level":1,"Type":1,"Value":"hasdfs","Parent":{"Property":"@","Level":0,"Type":2,"Value":{"msg":"hasdfs","files":[{"DataUrl":"","BlobIndex":0,"FileName":"img_1.gif","MimeType":"image/gif","Size":56591,"__calystotype":"Calysto222222_Blob"},{"DataUrl":"","BlobIndex":1,"FileName":"img_2.gif","MimeType":"image/gif","Size":70622,"__calystotype":"Calysto222222_Blob"},{"DataUrl":"","BlobIndex":2,"FileName":"img_3.gif","MimeType":"image/gif","Size":68342,"__calystotype":"Calysto222222_Blob"},{"DataUrl":"","BlobIndex":3,"FileName":"img_4.gif","MimeType":"image/gif","Size":95296,"__calystotype":"Calysto222222_Blob"},{"DataUrl":"","BlobIndex":4,"FileName":"img_5.gif","MimeType":"image/gif","Size":87117,"__calystotype":"Calysto222222_Blob"}]}}},{"Property":"files","Level":1,"Type":3,"Value":[{"DataUrl":"","BlobIndex":0,"FileName":"img_1.gif","MimeType":"image/gif","Size":56591,"__calystotype":"Calysto222222_Blob"},{"DataUrl":"","BlobIndex":1,"FileName":"img_2.gif","MimeType":"image/gif","Size":70622,"__calystotype":"Calysto222222_Blob"},{"DataUrl":"","BlobIndex":2,"FileName":"img_3.gif","MimeType":"image/gif","Size":68342,"__calystotype":"Calysto222222_Blob"},{"DataUrl":"","BlobIndex":3,"FileName":"img_4.gif","MimeType":"image/gif","Size":95296,"__calystotype":"Calysto222222_Blob"},{"DataUrl":"","BlobIndex":4,"FileName":"img_5.gif","MimeType":"image/gif","Size":87117,"__calystotype":"Calysto222222_Blob"}],"Parent":{"Property":"@","Level":0,"Type":2,"Value":{"msg":"hasdfs","files":[{"DataUrl":"","BlobIndex":0,"FileName":"img_1.gif","MimeType":"image/gif","Size":56591,"__calystotype":"Calysto222222_Blob"},{"DataUrl":"","BlobIndex":1,"FileName":"img_2.gif","MimeType":"image/gif","Size":70622,"__calystotype":"Calysto222222_Blob"},{"DataUrl":"","BlobIndex":2,"FileName":"img_3.gif","MimeType":"image/gif","Size":68342,"__calystotype":"Calysto222222_Blob"},{"DataUrl":"","BlobIndex":3,"FileName":"img_4.gif","MimeType":"image/gif","Size":95296,"__calystotype":"Calysto222222_Blob"},{"DataUrl":"","BlobIndex":4,"FileName":"img_5.gif","MimeType":"image/gif","Size":87117,"__calystotype":"Calysto222222_Blob"}]}}}]`;Calysto.TestTools.UnitTesting.Assert.AreEqual(res55exp,res55,"#ref res55exp"),res56=Calysto.Json.Serialize(o2.Children(true).Take(2).ToArray()),res56exp=`[{"Property":"@","Level":0,"Type":2,"Value":{"msg":"hasdfs","files":[{"DataUrl":"","BlobIndex":0,"FileName":"img_1.gif","MimeType":"image/gif","Size":56591,"__calystotype":"Calysto222222_Blob"},{"DataUrl":"","BlobIndex":1,"FileName":"img_2.gif","MimeType":"image/gif","Size":70622,"__calystotype":"Calysto222222_Blob"},{"DataUrl":"","BlobIndex":2,"FileName":"img_3.gif","MimeType":"image/gif","Size":68342,"__calystotype":"Calysto222222_Blob"},{"DataUrl":"","BlobIndex":3,"FileName":"img_4.gif","MimeType":"image/gif","Size":95296,"__calystotype":"Calysto222222_Blob"},{"DataUrl":"","BlobIndex":4,"FileName":"img_5.gif","MimeType":"image/gif","Size":87117,"__calystotype":"Calysto222222_Blob"}]}},{"Property":"msg","Level":1,"Type":1,"Value":"hasdfs","Parent":{"Property":"@","Level":0,"Type":2,"Value":{"msg":"hasdfs","files":[{"DataUrl":"","BlobIndex":0,"FileName":"img_1.gif","MimeType":"image/gif","Size":56591,"__calystotype":"Calysto222222_Blob"},{"DataUrl":"","BlobIndex":1,"FileName":"img_2.gif","MimeType":"image/gif","Size":70622,"__calystotype":"Calysto222222_Blob"},{"DataUrl":"","BlobIndex":2,"FileName":"img_3.gif","MimeType":"image/gif","Size":68342,"__calystotype":"Calysto222222_Blob"},{"DataUrl":"","BlobIndex":3,"FileName":"img_4.gif","MimeType":"image/gif","Size":95296,"__calystotype":"Calysto222222_Blob"},{"DataUrl":"","BlobIndex":4,"FileName":"img_5.gif","MimeType":"image/gif","Size":87117,"__calystotype":"Calysto222222_Blob"}]}}}]`,Calysto.TestTools.UnitTesting.Assert.AreEqual(res56exp,res56,"#ref res56exp");var all=o2.Descendants(true).Where(o=>o.Index>0||o.Index==0).Select(o=>o).Where(o=>!!o),arr1=all.ToArray(),all1=o2.Descendants(true).Where(o=>o.Index>0||o.Index==0).Skip(2).Take(1).ToArray(),all2=o2.Descendants(true).ToArray(),complete1=[all1],res1=Calysto.Json.Serialize(complete1),res11=Calysto.Json.Serialize(complete1,100),res11exp=`[[{"Index":2,"Property":"2","Level":2,"Type":2,"Value":{"DataUrl":"","BlobIndex":2,"FileName":"img_3.gif","MimeType":"image/gif","Size":68342,"__calystotype":"Calysto222222_Blob"},"Parent":{"Property":"files","Level":1,"Type":3,"Value":[{"DataUrl":"","BlobIndex":0,"FileName":"img_1.gif","MimeType":"image/gif","Size":56591,"__calystotype":"Calysto222222_Blob"},{"DataUrl":"","BlobIndex":1,"FileName":"img_2.gif","MimeType":"image/gif","Size":70622,"__calystotype":"Calysto222222_Blob"},{"DataUrl":"","BlobIndex":2,"FileName":"img_3.gif","MimeType":"image/gif","Size":68342,"__calystotype":"Calysto222222_Blob"},{"DataUrl":"","BlobIndex":3,"FileName":"img_4.gif","MimeType":"image/gif","Size":95296,"__calystotype":"Calysto222222_Blob"},{"DataUrl":"","BlobIndex":4,"FileName":"img_5.gif","MimeType":"image/gif","Size":87117,"__calystotype":"Calysto222222_Blob"}],"Parent":{"Property":"@","Level":0,"Type":2,"Value":{"msg":"hasdfs","files":[{"DataUrl":"","BlobIndex":0,"FileName":"img_1.gif","MimeType":"image/gif","Size":56591,"__calystotype":"Calysto222222_Blob"},{"DataUrl":"","BlobIndex":1,"FileName":"img_2.gif","MimeType":"image/gif","Size":70622,"__calystotype":"Calysto222222_Blob"},{"DataUrl":"","BlobIndex":2,"FileName":"img_3.gif","MimeType":"image/gif","Size":68342,"__calystotype":"Calysto222222_Blob"},{"DataUrl":"","BlobIndex":3,"FileName":"img_4.gif","MimeType":"image/gif","Size":95296,"__calystotype":"Calysto222222_Blob"},{"DataUrl":"","BlobIndex":4,"FileName":"img_5.gif","MimeType":"image/gif","Size":87117,"__calystotype":"Calysto222222_Blob"}]}}}}]]`;Calysto.TestTools.UnitTesting.Assert.AreEqual(res11exp,res11,"#ref res11exp");var lastOne=all.Last(),arr22=lastOne.Ancestors(true).ToArray(),cnt11=arr22.length;Calysto.TestTools.UnitTesting.Assert.AreEqual(3,cnt11,"#ref cnt11"),arr23=lastOne.Ancestors(false).ToArray(),cnt13=arr23.length,Calysto.TestTools.UnitTesting.Assert.AreEqual(2,cnt13,"#ref cnt13"),Calysto.TestTools.UnitTesting.Assert.AreEqual(res1,res11,"#ref res11");var obj1={a:new Calysto.DateTime("2016-07-02T11:08:25.244Z"),b:window.tqwefdhdasrtyqwer,c:null,d:parseInt(window.tqweyshasdfsg)},json1=Calysto.Json.Serialize(obj1),json2=Calysto.Json.Serialize(obj1,100);Calysto.TestTools.UnitTesting.Assert.AreEqual(`{"a":{"__calystotype":"Calysto_Date","Date":"2016-07-02T11:08:25.244"},"b":null,"c":null,"d":null}`,json1,"#ref json1"),Calysto.TestTools.UnitTesting.Assert.AreEqual(json1,json2),console.log("JsonNode1 test successful")}}),Calysto.TestTools.TestRunner.AddTest(()=>{let data1={Ime:"janko",Prezime:"bobetko",Sub1:{Name:"sub1",Sub2:{Name:"sub2",One:"jedan",Size:25}},Age:150,List1:[{a:10},{a:20},{a:30}],List2:[1,2,3,4,5]},tree1=new Calysto.Json.JsonNode(data1);Calysto.TestTools.UnitTesting.Assert.AreEqual(`{"Property":"@","Level":0,"Type":2,"Value":{"Ime":"janko","Prezime":"bobetko","Sub1":{"Name":"sub1","Sub2":{"Name":"sub2","One":"jedan","Size":25}},"Age":150,"List1":[{"a":10},{"a":20},{"a":30}],"List2":[1,2,3,4,5]}}`,JSON.stringify(tree1),"#reference tree1");let d3=tree1.Children(true).ToArray();Calysto.TestTools.UnitTesting.Assert.AreEqual(`[{"Property":"@","Level":0,"Type":2,"Value":{"Ime":"janko","Prezime":"bobetko","Sub1":{"Name":"sub1","Sub2":{"Name":"sub2","One":"jedan","Size":25}},"Age":150,"List1":[{"a":10},{"a":20},{"a":30}],"List2":[1,2,3,4,5]}},{"Property":"Ime","Level":1,"Type":1,"Value":"janko","Parent":{"Property":"@","Level":0,"Type":2,"Value":{"Ime":"janko","Prezime":"bobetko","Sub1":{"Name":"sub1","Sub2":{"Name":"sub2","One":"jedan","Size":25}},"Age":150,"List1":[{"a":10},{"a":20},{"a":30}],"List2":[1,2,3,4,5]}}},{"Property":"Prezime","Level":1,"Type":1,"Value":"bobetko","Parent":{"Property":"@","Level":0,"Type":2,"Value":{"Ime":"janko","Prezime":"bobetko","Sub1":{"Name":"sub1","Sub2":{"Name":"sub2","One":"jedan","Size":25}},"Age":150,"List1":[{"a":10},{"a":20},{"a":30}],"List2":[1,2,3,4,5]}}},{"Property":"Sub1","Level":1,"Type":2,"Value":{"Name":"sub1","Sub2":{"Name":"sub2","One":"jedan","Size":25}},"Parent":{"Property":"@","Level":0,"Type":2,"Value":{"Ime":"janko","Prezime":"bobetko","Sub1":{"Name":"sub1","Sub2":{"Name":"sub2","One":"jedan","Size":25}},"Age":150,"List1":[{"a":10},{"a":20},{"a":30}],"List2":[1,2,3,4,5]}}},{"Property":"Age","Level":1,"Type":1,"Value":150,"Parent":{"Property":"@","Level":0,"Type":2,"Value":{"Ime":"janko","Prezime":"bobetko","Sub1":{"Name":"sub1","Sub2":{"Name":"sub2","One":"jedan","Size":25}},"Age":150,"List1":[{"a":10},{"a":20},{"a":30}],"List2":[1,2,3,4,5]}}},{"Property":"List1","Level":1,"Type":3,"Value":[{"a":10},{"a":20},{"a":30}],"Parent":{"Property":"@","Level":0,"Type":2,"Value":{"Ime":"janko","Prezime":"bobetko","Sub1":{"Name":"sub1","Sub2":{"Name":"sub2","One":"jedan","Size":25}},"Age":150,"List1":[{"a":10},{"a":20},{"a":30}],"List2":[1,2,3,4,5]}}},{"Property":"List2","Level":1,"Type":3,"Value":[1,2,3,4,5],"Parent":{"Property":"@","Level":0,"Type":2,"Value":{"Ime":"janko","Prezime":"bobetko","Sub1":{"Name":"sub1","Sub2":{"Name":"sub2","One":"jedan","Size":25}},"Age":150,"List1":[{"a":10},{"a":20},{"a":30}],"List2":[1,2,3,4,5]}}}]`,JSON.stringify(d3),"#reference d3");let d2=tree1.Descendants(true).Where(o=>o.Level>=2).ToArray();Calysto.TestTools.UnitTesting.Assert.AreEqual(16,d2.length,"#reference d2");let d5=tree1.Descendants(false).ToArray();Calysto.TestTools.UnitTesting.Assert.AreEqual(22,d5.length,"#reference d5");let d1=tree1.Descendants().Where(o=>o.Property=="Sub1").Select(o=>o.Value).ToArray();Calysto.TestTools.UnitTesting.Assert.AreEqual(1,d1.length,"#reference d1");let d2a=tree1.Descendants(true).Where(o=>o.Level>=2).First();Calysto.TestTools.UnitTesting.Assert.AreEqual("Name",d2a.Property,"#reference d2a");let chain=d2a.SelectChain("Nest.Tamo.@.Sub1.Sub2.Size.Next.Home").ToArray(),chain22=chain.Select(o=>({Property:o.Property,Level:o.Level,Value:o.Value+""})).ToArray();Calysto.TestTools.UnitTesting.Assert.AreEqual(`[]`,JSON.stringify(chain22),"#reference chain22");let chain2=tree1.SelectChain("List1.2.a.c").ToArray();Calysto.TestTools.UnitTesting.Assert.AreEqual(`[{"Property":"List1","Level":1,"Type":3,"Value":[{"a":10},{"a":20},{"a":30}],"Parent":{"Property":"@","Level":0,"Type":2,"Value":{"Ime":"janko","Prezime":"bobetko","Sub1":{"Name":"sub1","Sub2":{"Name":"sub2","One":"jedan","Size":25}},"Age":150,"List1":[{"a":10},{"a":20},{"a":30}],"List2":[1,2,3,4,5]}}},{"Index":2,"Property":"2","Level":2,"Type":2,"Value":{"a":30},"Parent":{"Property":"List1","Level":1,"Type":3,"Value":[{"a":10},{"a":20},{"a":30}],"Parent":{"Property":"@","Level":0,"Type":2,"Value":{"Ime":"janko","Prezime":"bobetko","Sub1":{"Name":"sub1","Sub2":{"Name":"sub2","One":"jedan","Size":25}},"Age":150,"List1":[{"a":10},{"a":20},{"a":30}],"List2":[1,2,3,4,5]}}}},{"Property":"a","Level":3,"Type":1,"Value":30,"Parent":{"Index":2,"Property":"2","Level":2,"Type":2,"Value":{"a":30},"Parent":{"Property":"List1","Level":1,"Type":3,"Value":[{"a":10},{"a":20},{"a":30}],"Parent":{"Property":"@","Level":0,"Type":2,"Value":{"Ime":"janko","Prezime":"bobetko","Sub1":{"Name":"sub1","Sub2":{"Name":"sub2","One":"jedan","Size":25}},"Age":150,"List1":[{"a":10},{"a":20},{"a":30}],"List2":[1,2,3,4,5]}}}}}]`,JSON.stringify(chain2),"#reference chain2");let anc1=d2a.Ancestors(true).ToArray();Calysto.TestTools.UnitTesting.Assert.AreEqual(`[{"Property":"Name","Level":2,"Type":1,"Value":"sub1","Parent":{"Property":"Sub1","Level":1,"Type":2,"Value":{"Name":"sub1","Sub2":{"Name":"sub2","One":"jedan","Size":25}},"Parent":{"Property":"@","Level":0,"Type":2,"Value":{"Ime":"janko","Prezime":"bobetko","Sub1":{"Name":"sub1","Sub2":{"Name":"sub2","One":"jedan","Size":25}},"Age":150,"List1":[{"a":10},{"a":20},{"a":30}],"List2":[1,2,3,4,5]}}}},{"Property":"Sub1","Level":1,"Type":2,"Value":{"Name":"sub1","Sub2":{"Name":"sub2","One":"jedan","Size":25}},"Parent":{"Property":"@","Level":0,"Type":2,"Value":{"Ime":"janko","Prezime":"bobetko","Sub1":{"Name":"sub1","Sub2":{"Name":"sub2","One":"jedan","Size":25}},"Age":150,"List1":[{"a":10},{"a":20},{"a":30}],"List2":[1,2,3,4,5]}}},{"Property":"@","Level":0,"Type":2,"Value":{"Ime":"janko","Prezime":"bobetko","Sub1":{"Name":"sub1","Sub2":{"Name":"sub2","One":"jedan","Size":25}},"Age":150,"List1":[{"a":10},{"a":20},{"a":30}],"List2":[1,2,3,4,5]}}]`,JSON.stringify(anc1),"#reference anc1");let anc2=d2a.Ancestors(true).Reverse().Select(o=>o.Property).ToStringJoined(".");Calysto.TestTools.UnitTesting.Assert.AreEqual(`@.Sub1.Name`,anc2,"#reference anc2");let tree2=new Calysto.Json.JsonNode(data1.List1);var m1=tree2.Descendants(true).ToArray();Calysto.TestTools.UnitTesting.Assert.AreEqual(`[{"Property":"@","Level":0,"Type":3,"Value":[{"a":10},{"a":20},{"a":30}]},{"Index":0,"Property":"0","Level":1,"Type":2,"Value":{"a":10},"Parent":{"Property":"@","Level":0,"Type":3,"Value":[{"a":10},{"a":20},{"a":30}]}},{"Property":"a","Level":2,"Type":1,"Value":10,"Parent":{"Index":0,"Property":"0","Level":1,"Type":2,"Value":{"a":10},"Parent":{"Property":"@","Level":0,"Type":3,"Value":[{"a":10},{"a":20},{"a":30}]}}},{"Index":1,"Property":"1","Level":1,"Type":2,"Value":{"a":20},"Parent":{"Property":"@","Level":0,"Type":3,"Value":[{"a":10},{"a":20},{"a":30}]}},{"Property":"a","Level":2,"Type":1,"Value":20,"Parent":{"Index":1,"Property":"1","Level":1,"Type":2,"Value":{"a":20},"Parent":{"Property":"@","Level":0,"Type":3,"Value":[{"a":10},{"a":20},{"a":30}]}}},{"Index":2,"Property":"2","Level":1,"Type":2,"Value":{"a":30},"Parent":{"Property":"@","Level":0,"Type":3,"Value":[{"a":10},{"a":20},{"a":30}]}},{"Property":"a","Level":2,"Type":1,"Value":30,"Parent":{"Index":2,"Property":"2","Level":1,"Type":2,"Value":{"a":30},"Parent":{"Property":"@","Level":0,"Type":3,"Value":[{"a":10},{"a":20},{"a":30}]}}}]`,JSON.stringify(m1),"#reference m1"),console.log("JsonNode2 test successful")}),Calysto.TestTools.TestRunner.AddTest(()=>{}),Calysto.TestTools.TestRunner.AddTest(()=>{function UsingCulture(culture,func){var original=Calysto.Globalization.CultureInfo.CurrentCulture;Calysto.Globalization.CultureInfo.CurrentCulture=culture||Calysto.Globalization.CultureInfo.USCulture,func(),Calysto.Globalization.CultureInfo.CurrentCulture=original}UsingCulture(Calysto.Globalization.CultureInfo.USCulture,function(){var isOldMsie=Calysto.Features.GetBrowser().KindName=="MSIE"&&Calysto.Features.GetBrowser().Version<=8,res11,exp11,res12,exp12,json2,res2,exp2,res21,exp21,res22,exp22,json3,el3,res3,exp3,res31,exp31,res32,exp32;if(!isOldMsie){var divEl=Calysto.Utility.Dom.ConvertToElementsArray('<div id="divForm1" style="background:whitesmoke;padding:10px;margin-top:10px;border:solid 5px red;;">\t\t<input type="text" calysto-id="Game.Name" name="GameName" value="the name of the game" />\t\t<input type="text" calysto-id="Store.Name" name="StoreName" value="store name" />\t\t<input type="text" calysto-id="Realization.IncomeSum1" calysto-getter="()=>Calysto.Type.NumberConverter.ToDecimal(this.value, -5)" name="ctl00$clientNavigation1$IncomeSum1">\t\t<input type="text" calysto-id="Realization.IncomeSum2" calysto-setter="(a1)=>this.value=a1.ToStringFormated(\'n2\')" name="ctl00$clientNavigation1$IncomeSum2">\t\t<input type="text" calysto-id="Realization.IncomeSum3" name="ctl00$clientNavigation1$IncomeSum3" calysto-format="N3">\t\t<input type="text" calysto-id="Realization.IncomeSum4" calysto-setter="(a1)=>this.value=a1.ToStringFormated(\'n2\')" calysto-getter="()=>Calysto.Type.NumberConverter.ToDecimal(this.value, -1)" name="ctl00$clientNavigation1$IncomeSum4">\t\t<div class="right" calysto-id="Realization.IncomeSum5" calysto-setter="(a1)=>this.innerHTML=a1.ToStringFormated(\'n2\')"><\/div>\t\t<select calysto-id="Realization.Color" name="TheColor">\t\t\t<option value="red">Red color<\/option>\t\t\t<option value="blue">Blue color<\/option>\t\t\t<option selected="selected">No color<\/option>\t\t<\/select>\t\t<select calysto-id="Realization.Height" name="TheHeight" multiple="multiple">\t\t\t<option value="1">One inch<\/option>\t\t\t<option value="2" selected="selected">Two inch<\/option>\t\t\t<option value="3" selected="selected">Three inch<\/option>\t\t\t<option value="4">Four inch<\/option>\t\t\t<option selected="selected" value="">No height<\/option>\t\t<\/select>\t\t<input type="radio" calysto-id="Income.Salary" name="ctl00$clientNavigation1$Salary1" value="1000" />\t\t<input type="radio" calysto-id="Income.Salary" name="ctl00$clientNavigation1$Salary1" value="2000" />\t\t<input type="radio" calysto-id="Income.Salary" name="ctl00$clientNavigation1$Salary1" value="3000" />\t\t<input type="radio" calysto-id="Income.Salary" name="ctl00$clientNavigation1$Salary1" value="4000" checked="checked" calysto-type="Decimal" />\t\t<input type="radio" calysto-id="Income.Salary" name="ctl00$clientNavigation1$Salary1" value="5000" />\t\t<input type="checkbox" calysto-id="Addition.Bonus1" name="ctl00$clientNavigation1$Addition1" value="5000" />\t\t<input type="checkbox" calysto-id="Addition.Bonus2" name="ctl00$clientNavigation1$Addition2" value="6000" checked="checked" />\t\t<input type="checkbox" calysto-id="Addition.Bonus3" name="ctl00$clientNavigation1$Addition3" value="7000" checked="checked" />\t\t<input type="checkbox" calysto-id="Addition.Bonus4" name="ctl00$clientNavigation1$Addition4" value="8000" /><\/div>'),el3=$$calysto(divEl).CloneNodes().First(),res1=Calysto.Json.Serialize(Calysto.Forms.CalystoSerialize(el3));Calysto.TestTools.UnitTesting.Assert.AreEqual('{"Game":{"Name":"the name of the game"},"Store":{"Name":"store name"},"Realization":{"IncomeSum1":-5,"IncomeSum2":"","IncomeSum3":"","IncomeSum4":-1,"Color":"No color","Height":["2","3",""]},"Income":{"Salary":4000},"Addition":{"Bonus2":"6000","Bonus3":"7000"}}',res1),res11=Calysto.Json.Serialize(Calysto.Forms.MvcSerialize(el3)),exp11='{"GameName":"the name of the game","StoreName":"store name","ctl00$clientNavigation1$Addition2":"6000","ctl00$clientNavigation1$Addition3":"7000","TheColor":"No color","TheHeight":["2","3",""]}',Calysto.TestTools.UnitTesting.Assert.AreEqual(exp11,res11),res12=Calysto.Json.Serialize(Calysto.Forms.FormSerialize(el3)),exp12='{"GameName":"the name of the game","StoreName":"store name","ctl00$clientNavigation1$Addition2":"6000","ctl00$clientNavigation1$Addition3":"7000","TheColor":"No color","TheHeight":["2","3",""]}',Calysto.TestTools.UnitTesting.Assert.AreEqual(exp12,res12),json2='{"Game":{"Name":"game1"},"Store":{"Name":"store1"},"Realization":{"IncomeSum1":2,"IncomeSum2":-34.556,"IncomeSum3":"-23.63423","IncomeSum4":4,"Color":"blue","Height":["1","2","4"]},"Income":{"Salary":"2000"},"Addition":{"Bonus3":"7000","Bonus4":"8000"}}',el3=$$calysto(divEl).CloneNodes().First(),Calysto.Forms.CalystoDeserialize(Calysto.Json.Deserialize(json2),el3),res2=Calysto.Json.Serialize(Calysto.Forms.CalystoSerialize(el3)),exp2='{"Game":{"Name":"game1"},"Store":{"Name":"store1"},"Realization":{"IncomeSum1":2,"IncomeSum2":-34.56,"IncomeSum3":"-23.63423","IncomeSum4":4,"Color":"blue","Height":["1","2","4"]},"Income":{"Salary":"2000"},"Addition":{"Bonus2":"6000","Bonus3":"7000","Bonus4":"8000"}}',Calysto.TestTools.UnitTesting.Assert.AreEqual(exp2,res2),res21=Calysto.Json.Serialize(Calysto.Forms.MvcSerialize(el3)),exp21='{"GameName":"game1","StoreName":"store1","ctl00$clientNavigation1$IncomeSum3":"-23.63423","ctl00$clientNavigation1$Salary1":"2000","ctl00$clientNavigation1$Addition2":"6000","ctl00$clientNavigation1$Addition3":"7000","ctl00$clientNavigation1$Addition4":"8000","TheColor":"blue","TheHeight":["1","2","4"]}',Calysto.TestTools.UnitTesting.Assert.AreEqual(exp21,res21),res22=Calysto.Json.Serialize(Calysto.Forms.FormSerialize(el3)),exp22='{"GameName":"game1","StoreName":"store1","ctl00$clientNavigation1$IncomeSum3":"-23.63423","ctl00$clientNavigation1$Salary1":"2000","ctl00$clientNavigation1$Addition2":"6000","ctl00$clientNavigation1$Addition3":"7000","ctl00$clientNavigation1$Addition4":"8000","TheColor":"blue","TheHeight":["1","2","4"]}',Calysto.TestTools.UnitTesting.Assert.AreEqual(exp22,res22),json3='{"Game":{"Name":"game1"},"Store":{"Name":"store1"},"Realization":{"IncomeSum1":2,"IncomeSum2":-34.556,"IncomeSum3":-23.63463,"IncomeSum4":4,"Color":"blue","Height":[1,2,4]},"Income":{"Salary":20.0034},"Addition":{"Bonus3":70.00643,"Bonus4":-8.000435}}',el3=$$calysto(divEl).CloneNodes().First(),Calysto.Forms.CalystoDeserialize(Calysto.Json.Deserialize(json3),el3),res3=Calysto.Json.Serialize(Calysto.Forms.CalystoSerialize(el3)),exp3='{"Game":{"Name":"game1"},"Store":{"Name":"store1"},"Realization":{"IncomeSum1":2,"IncomeSum2":-34.56,"IncomeSum3":-23.635,"IncomeSum4":4,"Color":"blue","Height":["1","2","4"]},"Addition":{"Bonus2":"6000"}}',Calysto.TestTools.UnitTesting.Assert.AreEqual(exp3,res3),res31=Calysto.Json.Serialize(Calysto.Forms.MvcSerialize(el3)),exp31='{"GameName":"game1","StoreName":"store1","ctl00$clientNavigation1$Addition2":"6000","TheColor":"blue","TheHeight":["1","2","4"]}',Calysto.TestTools.UnitTesting.Assert.AreEqual(exp31,res31),res32=Calysto.Json.Serialize(Calysto.Forms.FormSerialize(el3)),exp32='{"GameName":"game1","StoreName":"store1","ctl00$clientNavigation1$Addition2":"6000","TheColor":"blue","TheHeight":["1","2","4"]}',Calysto.TestTools.UnitTesting.Assert.AreEqual(exp32,res32),console.log("Forms test succesful")}})}),Calysto.TestTools.TestRunner.AddTest(()=>{var test1=new Calysto.List(["one","aa","nemza","two","temza","bb","cc"]).GroupBy("o=>o.length").SelectMany(function(group){return group.ToArray()}).Select("o=>o.length + ': ' + o").ToStringJoined(", "),test11,test2;if(test1!="3: one, 3: two, 2: aa, 2: bb, 2: cc, 5: nemza, 5: temza"){throw new Error("Self test failed in Calysto.List GroupBy test 1! Result: "+test1);}if(test11=new Calysto.List(["one","two","nemza","temza","aa","bb","cc"]).OrderBy("o => o.length",true).ThenBy("o=>o",true).GroupBy("o=>o.length").Select("o=> o.Key + ', items: ' + o.ToArray().join('|')").ToStringJoined(", "),test11!="5, items: temza|nemza, 3, items: two|one, 2, items: cc|bb|aa"){throw new Error("Self test failed in Calysto.List test 1! Result: "+test11);}if(test2=new Calysto.List([1,2,3,4,5]).Where("o=>o > 2").Select("(o, n) => new {item: o, index: n}").OrderBy("o=>o.index",true).Select("(o, n) => 'index: ' + n + ', value: ' + o.item").ToStringJoined("; "),test2!="index: 0, value: 5; index: 1, value: 4; index: 2, value: 3"){throw new Error("Self test failed in Calysto.List test 2! Result: "+test2);}}),Calysto.TestTools.TestRunner.AddTest(()=>{var obj1=[{DataUrl:function(){},BlobIndex:1,FileName:"img_2.gif",MimeType:"image/gif",Size:70622,__calystotype:"Calysto22_Blob"},{DataUrl:function(){},BlobIndex:2,FileName:"img_2.gif",MimeType:"image/gif",Size:50622,__calystotype:"Calysto11_Blob"},{DataUrl:function(){return 3},BlobIndex:3,FileName:"img_3.gif",MimeType:"image/gif",Size:50622,__calystotype:"Calysto33_Blob"},{DataUrl:"",BlobIndex:4,FileName:"img_3.gif",MimeType:"image/gif",Size:70622,__calystotype:"Calysto222222_Blob"},{DataUrl:"",BlobIndex:5,FileName:"img_2.gif",MimeType:"image/gif",Size:70622,__calystotype:"Calysto222222_Blob"}],m1=obj1.AsEnumerable().Cycle(20).ToArray(),m2=obj1.AsEnumerable().Distinct(o=>o.DataUrl).ToArray(),arr1=obj1.AsEnumerable().Cycle(100).Distinct(function(o){return o.DataUrl}).ToArray(),arr2,res1,res2,res3,res4;if(arr1.length!=4){throw new Error("Self test failed in Distinct test 01, result: "+arr1.length);}if(arr2=obj1.AsEnumerable().Cycle(100).Distinct(function(o){return o}).ToArray(),arr2.length!=5){throw new Error("Self test failed in Distinct test 02, result: "+arr2.length);}if(res1=[2,3,4,5,6,null,-1,-6].AsEnumerable().Min(),res1!=-6){throw new Error("Self test failed in Min test 01, result: "+res1);}if(res2=[2,3,4,5,null,-1,-6].AsEnumerable().Max(),res2!=5){throw new Error("Self test failed in Max test 01, result: "+res1);}if(res3=[2,3,4,5,6,null,null,null,null,null,null,-1,-6].AsEnumerable().Average(),res3!=1.8571428571428572){throw new Error("Self test failed in Average test 01, result: "+res1);}if(res4=[2,3,4,5,6,null,null,null,null,null,null,-1,-6].AsEnumerable().Sum(),res4!=13){throw new Error("Self test failed in Sum test 01, result: "+res1);}}),Calysto.TestTools.TestRunner.AddTest(()=>{var js1='{"msg":"hasdfs","files":[{"DataUrl":"","BlobIndex":0,"FileName":"img_1.gif","MimeType":"image/gif","Size":56591,"__calystotype":"Calysto222222_Blob"},{"DataUrl":"","BlobIndex":1,"FileName":"img_2.gif","MimeType":"image/gif","Size":70622,"__calystotype":"Calysto222222_Blob"},{"DataUrl":"","BlobIndex":2,"FileName":"img_3.gif","MimeType":"image/gif","Size":68342,"__calystotype":"Calysto222222_Blob"},{"DataUrl":"","BlobIndex":3,"FileName":"img_4.gif","MimeType":"image/gif","Size":95296,"__calystotype":"Calysto222222_Blob"},{"DataUrl":"","BlobIndex":4,"FileName":"img_5.gif","MimeType":"image/gif","Size":87117,"__calystotype":"Calysto222222_Blob"}]}',item1,res1;if(window.JSON){if(res1=JSON.stringify(Calysto.Json.Deserialize(js1)),res1!=js1){throw new Error("Self test failed in Calysto.JSON test 01! Result: "+res1);}if(item1=JSON.parse(js1),res1=Calysto.Json.Serialize(item1),res1!=js1){throw new Error("Self test failed in Calysto.JSON test 02! Result: "+res1);}}}),Calysto.TestTools.TestRunner.AddTest(()=>{var kewsrc=[{name:"one",age:22,sub:{dva:22,tri:33,coll:[{nn:22},{nn:33},{nn:44}]}}].AsEnumerable().Select(o=>o).Select("o => o.sub").Where("o => !!o").Where("o => !!o").SelectMany("o => o.coll").Where("o => o.nn > 1").Intersect([{kk:22},{kk:23},{kk:44}],"(o1, o2) => o1.nn == o2.kk").Where("o => !!o.nn").ForEach('(o, n) => o.addedProperty = "ter-" + n'),kew=kewsrc.ToArray(),res1=Calysto.Json.Serialize(kew);if(res1!='[{"nn":22,"addedProperty":"ter-0"},{"nn":44,"addedProperty":"ter-1"}]'){throw new Error("Self test failed in Calysto.List test 03! Result: "+res1);}}),Calysto.TestTools.TestRunner.AddTest(()=>{var kewsrc=[{name:"one",age:22,sub:{dva:22,tri:33,coll:[{nn:22},{nn:33},{nn:44}]}}].AsEnumerable().Select(o=>o.sub).Where(o=>!!o).Where(o=>!!o).SelectMany(o=>o.coll).Where(o=>o.nn>1).Intersect([{kk:22},{kk:23},{kk:44}],(o1,o2)=>o1.nn==o2.kk).Where(o=>!!o.nn).ForEach((o,n)=>o.addedProperty="ter-"+n),kew=kewsrc.ToArray(),res1=Calysto.Json.Serialize(kew),dic33,res33,testconcat,test8,test9,test2b,kk,res,test1,test2a,bcolor,item,hh11,anim1,cnt11,cnt12,kk1,kk2,items11,isOldMsie,ddd;if(res1!='[{"nn":22,"addedProperty":"ter-0"},{"nn":44,"addedProperty":"ter-1"}]'){throw new Error("Self test failed in Calysto.List test 03! Result: "+res1);}if(dic33=kew.AsEnumerable().ToDictionary(key=>key.nn,o=>o).ToRawObject(),res1=Calysto.Json.Serialize(dic33),res1!='{"22":{"nn":22,"addedProperty":"ter-0"},"44":{"nn":44,"addedProperty":"ter-1"}}'){throw new Error("Self test failed in Calysto.List test 04! Result: "+res1);}if(res33=[[1,2,3,4],null,[8,7,5]].AsEnumerable().SelectMany(o=>o).ToArray().join(";"),res33!="1;2;3;4;8;7;5"){throw new Error("Self test failed in SelectMay when collection is null, result: "+res33);}if(testconcat=[1].AsEnumerable().Skip(1).Concat([3,4,5]).Concat([5,6]).ToArray(),testconcat.length!=5){throw new Error("Self test failed in Calysto.List test Concat 1! Result: "+testconcat.length);}if(test8=["one","aa","nemza","two","temza","bb","cc"].AsEnumerable().GroupBy(o=>o.length).SelectMany(function(group){return group.ToArray()}).Select(o=>o.length+": "+o).ToStringJoined(", "),test8!="3: one, 3: two, 2: aa, 2: bb, 2: cc, 5: nemza, 5: temza"){throw new Error("Self test failed in Calysto.List GroupBy test 1! Result: "+test8);}if(test9=["one","two","nemza","temza","aa","bb","cc"].AsEnumerable().OrderBy(o=>o.length,true).ThenBy(o=>o,true).GroupBy(o=>o.length).Select(o=>o.Key+", items: "+o.ToArray().join("|")).ToStringJoined(", "),test9!="5, items: temza|nemza, 3, items: two|one, 2, items: cc|bb|aa"){throw new Error("Self test failed in Calysto.List test 1! Result: "+test9);}if(test2b=[1,2,3,4,5].AsEnumerable().Where(o=>o>2).Select((o,n)=>({item:o,index:n})).OrderBy(o=>o.index,true).Select((o,n)=>"index: "+n+", value: "+o.item).ToStringJoined("; "),test2b!="index: 0, value: 5; index: 1, value: 4; index: 2, value: 3"){throw new Error("Self test failed in Calysto.List test 2b! Result: "+test2b);}var aaa=[{Ordinal:11,ParentCategoryID:5,Name:"111"},{Ordinal:11,ParentCategoryID:5,Name:"222"},{Ordinal:11,ParentCategoryID:5,Name:"333"},{Ordinal:11,ParentCategoryID:5,Name:""},{Ordinal:11,ParentCategoryID:5,Name:undefined},{Ordinal:11,ParentCategoryID:5,Name:undefined},{Ordinal:24,ParentCategoryID:22,Name:"SomeName"},{Ordinal:24,ParentCategoryID:22,Name:"555"},{Ordinal:24,ParentCategoryID:55,Name:"666"},{Ordinal:88,ParentCategoryID:33,Name:"Mark"},{Ordinal:88,ParentCategoryID:55,Name:undefined},{Ordinal:11,ParentCategoryID:22,Name:undefined},{Ordinal:11,ParentCategoryID:33,Name:undefined},{Ordinal:11,ParentCategoryID:55,Name:"Anthon"},{Ordinal:24,ParentCategoryID:22,Name:undefined},{Ordinal:24,ParentCategoryID:33,Name:undefined},{Ordinal:24,ParentCategoryID:55,Name:"Clara"},{Ordinal:11,ParentCategoryID:55,Name:"Runna"},{Ordinal:11,ParentCategoryID:55,Name:"Inta"},{Ordinal:11,ParentCategoryID:55,Name:"333"},{Ordinal:11,ParentCategoryID:55,Name:"333"},{Ordinal:88,ParentCategoryID:22,Name:undefined},{Ordinal:88,ParentCategoryID:33,Name:undefined},{Ordinal:88,ParentCategoryID:55,Name:undefined}],bb=aaa.AsEnumerable().OrderBy(o=>o.Ordinal,false).ThenBy(o=>o.ParentCategoryID,true).ThenBy(o=>o.Name,false).Skip(2).OrderBy(()=>1).ThenBy(o=>o.ParentCategoryID,true).ThenBy(o=>o.Ordinal),cc=bb.Select(o=>o.Ordinal+", "+o.ParentCategoryID+", "+o.Name).ToStringJoined("|");if(cc!="11, 55, Anthon|11, 55, Inta|11, 55, Runna|24, 55, 666|24, 55, Clara|88, 55, undefined|88, 55, undefined|11, 33, undefined|24, 33, undefined|88, 33, undefined|88, 33, Mark|11, 22, undefined|24, 22, undefined|24, 22, 555|24, 22, SomeName|88, 22, undefined|11, 5, undefined|11, 5, undefined|11, 5, |11, 5, 111|11, 5, 222|11, 5, 333"){throw new Error("Self test failed in Calysto.List test 3. Result: "+cc);}if(kk=bb.Count(),kk!=22){throw new Error("Self test failed in Calysto.List test 5. Result: "+kk);}var res1=["auto","autoo","aut","buton","1","2"].AsEnumerable().OrderBy(o=>o).ToArray().join(", "),res2=["auto","autoo","aut","buton","1","2","3"].AsEnumerable().OrderBy(o=>o).ToArray().join(", "),res3=["auao","autoo","aut","buton","1","2","3"].AsEnumerable().OrderBy(o=>o).ToArray().join(", "),res4=[undefined,1,NaN,null,"auto","autoo","aut","buton","1","2",3,NaN,undefined].AsEnumerable().OrderBy(o=>o).ToArray().join(", ");if(res1!="1, 2, aut, auto, autoo, buton"){throw new Error("Self test failed in OrderBy test 1, result: "+res1);}if(res2!="1, 2, 3, aut, auto, autoo, buton"){throw new Error("Self test failed in OrderBy test 2, result: "+res2);}if(res3!="1, 2, 3, auao, aut, autoo, buton"){throw new Error("Self test failed in OrderBy test 3, result: "+res3);}if(res4!=", , , NaN, NaN, 1, 3, 1, 2, aut, auto, autoo, buton"){throw new Error("Self test failed in OrderBy test 4, result: "+res4);}var list1="987654321".ToCharArray().AsEnumerable().Cycle(600).Select((ch,fromByte)=>({ch:ch.charCodeAt(0),fromByte:fromByte%4})).Take(100).OrderByDescending(function(o){return o.ch}).Select(function(o,toByte){return{ch:o.ch,fromByte:o.fromByte,toByte:toByte}}).ToList(),res11=list1.Select(function(o){return o.ch+"_"+o.fromByte+"_"+o.toByte}).ToArray(),res21=list1.OrderBy(o=>o.ch).ThenBy(o=>o.fromByte).Select(function(o){return o.ch+"_"+o.fromByte+"_"+o.toByte}).ToArray(),res31=list1.OrderBy(o=>o.ch).ThenByDescending(o=>o.fromByte).ThenByDescending(o=>o.toByte).Select(function(o){return o.ch+"_"+o.fromByte+"_"+o.toByte}).ToArray(),res41=list1.OrderBy(o=>o.ch).ThenBy(o=>o.fromByte).ThenByDescending(o=>o.toByte).Select(function(o){return o.ch+"_"+o.fromByte+"_"+o.toByte}).ToArray(),res51=list1.OrderByDescending(o=>o.ch).ThenByDescending(o=>o.fromByte).ThenBy(o=>o.toByte).Select(function(o){return o.ch+"_"+o.fromByte+"_"+o.toByte}).ToArray();if(res11.join(", ")!="57_0_0, 57_1_1, 57_2_2, 57_3_3, 57_0_4, 57_1_5, 57_2_6, 57_3_7, 57_0_8, 57_1_9, 57_2_10, 57_3_11, 56_1_12, 56_2_13, 56_3_14, 56_0_15, 56_1_16, 56_2_17, 56_3_18, 56_0_19, 56_1_20, 56_2_21, 56_3_22, 55_2_23, 55_3_24, 55_0_25, 55_1_26, 55_2_27, 55_3_28, 55_0_29, 55_1_30, 55_2_31, 55_3_32, 55_0_33, 54_3_34, 54_0_35, 54_1_36, 54_2_37, 54_3_38, 54_0_39, 54_1_40, 54_2_41, 54_3_42, 54_0_43, 54_1_44, 53_0_45, 53_1_46, 53_2_47, 53_3_48, 53_0_49, 53_1_50, 53_2_51, 53_3_52, 53_0_53, 53_1_54, 53_2_55, 52_1_56, 52_2_57, 52_3_58, 52_0_59, 52_1_60, 52_2_61, 52_3_62, 52_0_63, 52_1_64, 52_2_65, 52_3_66, 51_2_67, 51_3_68, 51_0_69, 51_1_70, 51_2_71, 51_3_72, 51_0_73, 51_1_74, 51_2_75, 51_3_76, 51_0_77, 50_3_78, 50_0_79, 50_1_80, 50_2_81, 50_3_82, 50_0_83, 50_1_84, 50_2_85, 50_3_86, 50_0_87, 50_1_88, 49_0_89, 49_1_90, 49_2_91, 49_3_92, 49_0_93, 49_1_94, 49_2_95, 49_3_96, 49_0_97, 49_1_98, 49_2_99"){throw new Error("Self test failed in Calysto.OrderBy test 4. res1: "+res11.join(", "));}if(res21.join(", ")!="49_0_89, 49_0_93, 49_0_97, 49_1_90, 49_1_94, 49_1_98, 49_2_91, 49_2_95, 49_2_99, 49_3_92, 49_3_96, 50_0_79, 50_0_83, 50_0_87, 50_1_80, 50_1_84, 50_1_88, 50_2_81, 50_2_85, 50_3_78, 50_3_82, 50_3_86, 51_0_69, 51_0_73, 51_0_77, 51_1_70, 51_1_74, 51_2_67, 51_2_71, 51_2_75, 51_3_68, 51_3_72, 51_3_76, 52_0_59, 52_0_63, 52_1_56, 52_1_60, 52_1_64, 52_2_57, 52_2_61, 52_2_65, 52_3_58, 52_3_62, 52_3_66, 53_0_45, 53_0_49, 53_0_53, 53_1_46, 53_1_50, 53_1_54, 53_2_47, 53_2_51, 53_2_55, 53_3_48, 53_3_52, 54_0_35, 54_0_39, 54_0_43, 54_1_36, 54_1_40, 54_1_44, 54_2_37, 54_2_41, 54_3_34, 54_3_38, 54_3_42, 55_0_25, 55_0_29, 55_0_33, 55_1_26, 55_1_30, 55_2_23, 55_2_27, 55_2_31, 55_3_24, 55_3_28, 55_3_32, 56_0_15, 56_0_19, 56_1_12, 56_1_16, 56_1_20, 56_2_13, 56_2_17, 56_2_21, 56_3_14, 56_3_18, 56_3_22, 57_0_0, 57_0_4, 57_0_8, 57_1_1, 57_1_5, 57_1_9, 57_2_2, 57_2_6, 57_2_10, 57_3_3, 57_3_7, 57_3_11"){throw new Error("Self test failed in Calysto.OrderBy test 4. res2: "+res21.join(", "));}if(res31.join(", ")!="49_3_96, 49_3_92, 49_2_99, 49_2_95, 49_2_91, 49_1_98, 49_1_94, 49_1_90, 49_0_97, 49_0_93, 49_0_89, 50_3_86, 50_3_82, 50_3_78, 50_2_85, 50_2_81, 50_1_88, 50_1_84, 50_1_80, 50_0_87, 50_0_83, 50_0_79, 51_3_76, 51_3_72, 51_3_68, 51_2_75, 51_2_71, 51_2_67, 51_1_74, 51_1_70, 51_0_77, 51_0_73, 51_0_69, 52_3_66, 52_3_62, 52_3_58, 52_2_65, 52_2_61, 52_2_57, 52_1_64, 52_1_60, 52_1_56, 52_0_63, 52_0_59, 53_3_52, 53_3_48, 53_2_55, 53_2_51, 53_2_47, 53_1_54, 53_1_50, 53_1_46, 53_0_53, 53_0_49, 53_0_45, 54_3_42, 54_3_38, 54_3_34, 54_2_41, 54_2_37, 54_1_44, 54_1_40, 54_1_36, 54_0_43, 54_0_39, 54_0_35, 55_3_32, 55_3_28, 55_3_24, 55_2_31, 55_2_27, 55_2_23, 55_1_30, 55_1_26, 55_0_33, 55_0_29, 55_0_25, 56_3_22, 56_3_18, 56_3_14, 56_2_21, 56_2_17, 56_2_13, 56_1_20, 56_1_16, 56_1_12, 56_0_19, 56_0_15, 57_3_11, 57_3_7, 57_3_3, 57_2_10, 57_2_6, 57_2_2, 57_1_9, 57_1_5, 57_1_1, 57_0_8, 57_0_4, 57_0_0"){throw new Error("Self test failed in Calysto.OrderBy test 4. res3: "+res31.join(", "));}if(res41.join(", ")!="49_0_97, 49_0_93, 49_0_89, 49_1_98, 49_1_94, 49_1_90, 49_2_99, 49_2_95, 49_2_91, 49_3_96, 49_3_92, 50_0_87, 50_0_83, 50_0_79, 50_1_88, 50_1_84, 50_1_80, 50_2_85, 50_2_81, 50_3_86, 50_3_82, 50_3_78, 51_0_77, 51_0_73, 51_0_69, 51_1_74, 51_1_70, 51_2_75, 51_2_71, 51_2_67, 51_3_76, 51_3_72, 51_3_68, 52_0_63, 52_0_59, 52_1_64, 52_1_60, 52_1_56, 52_2_65, 52_2_61, 52_2_57, 52_3_66, 52_3_62, 52_3_58, 53_0_53, 53_0_49, 53_0_45, 53_1_54, 53_1_50, 53_1_46, 53_2_55, 53_2_51, 53_2_47, 53_3_52, 53_3_48, 54_0_43, 54_0_39, 54_0_35, 54_1_44, 54_1_40, 54_1_36, 54_2_41, 54_2_37, 54_3_42, 54_3_38, 54_3_34, 55_0_33, 55_0_29, 55_0_25, 55_1_30, 55_1_26, 55_2_31, 55_2_27, 55_2_23, 55_3_32, 55_3_28, 55_3_24, 56_0_19, 56_0_15, 56_1_20, 56_1_16, 56_1_12, 56_2_21, 56_2_17, 56_2_13, 56_3_22, 56_3_18, 56_3_14, 57_0_8, 57_0_4, 57_0_0, 57_1_9, 57_1_5, 57_1_1, 57_2_10, 57_2_6, 57_2_2, 57_3_11, 57_3_7, 57_3_3"){throw new Error("Self test failed in Calysto.OrderBy test 4. res4: "+res41.join(", "));}if(res51.join(", ")!="57_3_3, 57_3_7, 57_3_11, 57_2_2, 57_2_6, 57_2_10, 57_1_1, 57_1_5, 57_1_9, 57_0_0, 57_0_4, 57_0_8, 56_3_14, 56_3_18, 56_3_22, 56_2_13, 56_2_17, 56_2_21, 56_1_12, 56_1_16, 56_1_20, 56_0_15, 56_0_19, 55_3_24, 55_3_28, 55_3_32, 55_2_23, 55_2_27, 55_2_31, 55_1_26, 55_1_30, 55_0_25, 55_0_29, 55_0_33, 54_3_34, 54_3_38, 54_3_42, 54_2_37, 54_2_41, 54_1_36, 54_1_40, 54_1_44, 54_0_35, 54_0_39, 54_0_43, 53_3_48, 53_3_52, 53_2_47, 53_2_51, 53_2_55, 53_1_46, 53_1_50, 53_1_54, 53_0_45, 53_0_49, 53_0_53, 52_3_58, 52_3_62, 52_3_66, 52_2_57, 52_2_61, 52_2_65, 52_1_56, 52_1_60, 52_1_64, 52_0_59, 52_0_63, 51_3_68, 51_3_72, 51_3_76, 51_2_67, 51_2_71, 51_2_75, 51_1_70, 51_1_74, 51_0_69, 51_0_73, 51_0_77, 50_3_78, 50_3_82, 50_3_86, 50_2_81, 50_2_85, 50_1_80, 50_1_84, 50_1_88, 50_0_79, 50_0_83, 50_0_87, 49_3_92, 49_3_96, 49_2_91, 49_2_95, 49_2_99, 49_1_90, 49_1_94, 49_1_98, 49_0_89, 49_0_93, 49_0_97"){throw new Error("Self test failed in Calysto.OrderBy test 4. res5: "+res51.join(", "));}res=new Calysto.List(["word1 word2 word3","this is next","menu item three"]).Cycle(10).Select((o,n)=>({Key:n,Value:o})).SkipWhile(o=>o.Key<2).TakeWhile(o=>o.Key<26).Select(o=>o.Key+"_"+o.Value).ToStringJoined(),Calysto.TestTools.UnitTesting.Assert.AreEqual("2_menu item three3_word1 word2 word34_this is next5_menu item three6_word1 word2 word37_this is next8_menu item three9_word1 word2 word3",res);var ddd=Calysto.DomQuery.FromHtml('<div class="search_v2" style="margin-right: 5px;" >\t\t<form id="form_search" name="search_main" onsubmit="return check_search_box_keyword()" action="/index.php" method="get">\t\t\t<input name="ctl" type="hidden" value=" ddfe nedgd search2iio" style="display: none" calysto-num="45"/>\t\t\t<label calysto-num="55" for="f_keywords">Upiši pojam...<\/label>\t\t\t<input name="f_keywords" id="f_keywords" type="text" style="width: 263px" onfocus="javascript:reset_search_style()" />\t\t\t<input calysto-num="25" class="mini_button" type="submit" value="Tražiiio" />\t\t\t<img alt="Beta" style="float: left; margin-top: -3px; padding-left: 5px;" />\t\t<\/form>\t<\/div>\t<div class="clear1" ><\/div>\t<div class="clear" ><\/div>'),results=[ddd.Query("div:is(>>input[name='ctl'])").Count(),ddd.Query("div:not(>>input[name=ctl])").Count(),ddd.Query("//input[type=hidden]").Count(),ddd.Query("//input[type]").Count(),ddd.Query("//[type]").Count(),ddd.Query("//[value^=Tra]").Count(),ddd.Query("//[value$=io]").Count(),ddd.Query("//[value~=ddfe]").Count(),ddd.Query("//[calysto-num]").Count(),ddd.Query("//[calysto-num==25]").Count(),ddd.Query("//[calysto-num > 25]").Count(),ddd.Query("//[calysto-num <= 45]").Count(),ddd.Query("div:not(>input[name])").Count()],attrTest1=results.join(", ");if(attrTest1!="1, 2, 1, 3, 3, 1, 2, 1, 3, 1, 2, 2, 3"){throw new Error("error in Calysto.DomQuery attribute test, result: "+attrTest1);}if(test1=ddd.Select(o=>o.tagName).Where(o=>!!o).ToStringJoined(", ").toLowerCase(),test1!="div, div, div"){throw new Error("error in Calysto.DomQuery test1, result: "+test1);}if(test2a=ddd.DescendantNodes().Query("form>label, a, IMG, input.mini_button").Select(o=>o.tagName+o.id+o.name+o.className).ToStringJoined(", ").toLowerCase(),test2a!="labelundefined, img, inputmini_button"){throw new Error("self test failed in Calysto.DomQuery test2a, result: "+test2a);}var html2='<div><span id="col333" style="background-color:aliceblue">fdsa<\/span> <span><\/span>   <div id="dd1" style="overflow:hidden; border:solid 1px red; width:900px; height:65px; position:absolute; margin-top:0;; top:200px; left:200px; background:red; "> prvi<\/div>\t<div>drugi<\/div>\t<div hrEF="hadsfmojurlfasd">treci<p><a class="mmkk" href="http://www.dd.com/somemylink1">moj link<\/a><\/p><\/div>\t<div hrEF="hadsfmojurlfasd">treci<p><a class="mmkk" href="http://www.dd.com/somemylink2">moj link<\/a><\/p><\/div>\t<div hrEF="hadsfmojurlfasd">treci<p><a class="mmkk" href="http://www.dd.com/somemylink31">moj link<\/a><a class="mmkk" href="http://www.dd.com/somemylink32">moj link<\/a><a class="mmkk" href="http://www.dd.com/somemylink33">moj link<\/a><\/p><\/div>\t<div>cetvrti<\/div>\t<div id="hh">peti<\/div><\/div>',bbb1=Calysto.DomQuery.FromHtml(html2),bbb=Calysto.DomQuery.FromSelector(document.documentElement).InsertChildren(html2).ChildNodes().Take(1),test3=bbb.DescendantNodes().Query("div>>a:reverse:take(4):skip(1):reverse").SelectAttribute("hrEF").ToStringJoined(", ");if(test3!="http://www.dd.com/somemylink2, http://www.dd.com/somemylink31, http://www.dd.com/somemylink32"){throw new Error("Self test failed in Calysto.DomQuery test3. Result: "+test3);}if(bcolor=$$calysto("#col333").SelectStyle("background-color").FirstOrDefault(),bcolor!="rgb(240, 248, 255)"&&bcolor!="aliceblue"){throw new Error("Self test failed in Calysto.DomQuery test5. Result: "+bcolor+", expected: rgb(240, 248, 255)");}item=bbb.DescendantNodes().Query("#dd1"),hh11=item.SelectStyle("height").FirstOrDefault(),item.ApplyStyleMap({width:"950px",opacity:"-=60",height:"+=500"});var hh1=item.SelectStyle("height").FirstOrDefault(),hh2=item.SelectStyle("width").FirstOrDefault(),hh3=item.SelectStyle("opacity").FirstOrDefault(),h5=$$calysto([hh11,hh1,hh2,hh3]).ToStringJoined(", ");if(h5!="65, 565, 950, 40"){throw new Error("Self test failed in Calysto.DomQuery test4. Result: "+h5);}if(item.ToAnimator({height:"+=460",opacity:"-=10"}).Easing("easeInOutExpo").OnComplete(sender=>{var gg11=sender.AsDomQuery(),kk1=gg11.SelectStyle("opacity").FirstOrDefault(),kk2=gg11.SelectStyle("height").FirstOrDefault(),kk6=$$calysto([kk1]).ToStringJoined(", ");if(kk6!="30"){throw new Error("Self test failed in Animator element style test. Result: "+kk6);}else console.log("Animator element style test successful")}).Start(),anim1=(new Calysto.Animator).AddValue(100,500).OnComplete(sender=>{var km1=sender.Items().Select(o=>o.numCurrent).pop();if(km1==500){console.log("Animator numeric value test successful")}else throw new Error("Self test failed in Animator numeric value test. Result: "+km1);}).Start(),cnt11=item.PreviousSiblings().Where(o=>o.nodeType!=3).Count(),cnt11!=2){throw new Error("Self test failed in Calysto.DomQuery test6. Result: "+cnt11);}if(cnt12=item.NextSiblings().Where(o=>o.nodeType!=3).Count(),cnt12!=6){throw new Error("Self test failed in Calysto.DomQuery test7. Result: "+cnt12);}if(bbb.RemoveFromDom(),kk1="my text is this".TakeFirst(9,"..."),kk2="my text is this".TakeLast(9,"..."),kk1!="my tex..."){throw new Error("Self test failed in String.TakeLast, result: "+kk1);}if(kk2!="...s this"){throw new Error("Self test failed in String.TakeFirst, result: "+kk2);}items11=Calysto.DomQuery.CreateElement("div").ApplyStyle("border:solid 1px blue; padding:5px;position:absolute;").AddAsChildrenTo(document.documentElement).AddChildren("<div style='position:absolute;border:solid 10px red;'>this is my div11<\/div>"),items11.ChildNodes().ApplyStyle("border:solid 1px green; padding:5px;").InsertBefore(Calysto.DomQuery.CreateElement("div").ApplyStyle("border:15px solid red;").ForEach(o=>o.innerHTML="div 2"),Calysto.DomQuery.CreateElement("div").ApplyStyle("border:15px solid red;").ForEach(o=>o.innerHTML="div 3"),Calysto.DomQuery.CreateElement("div").ApplyStyle("border:25px solid red;").ForEach(o=>o.innerHTML="div 4"),"<div>prvi div<\/div><div class='hhret435' style='border:solid 18px blue;width:200px;padding:5px;'>drugi div<\/div><div>third div11<\/div>","this is some text node",Calysto.DomQuery.CreateElement("div").ApplyStyle("border:5px solid red;width:auto;").ForEach(o=>o.innerHTML="div 5"));var dd00=items11.DescendantNodes("div").ToArray(),dd11=items11.DescendantNodes().WhereStyle("border-top-width",o=>o==18).ToArray(),dd12=items11.DescendantNodes().WhereStyle("width",o=>o==236).ToArray(),useBoxSizing=items11.DescendantNodes().SelectStyle("box-sizing").Where(function(o){return o=="border-box"}).Any();if(items11.RemoveFromDom(),dd00.length!=8){throw new Error("Self test dd00 failed in Calysto.DomQuery, result: "+dd00.length);}if(dd11.length!=1){throw new Error("Self test dd11 failed in Calysto.DomQuery, result: "+dd11.length);}if(isOldMsie=Calysto.Features.GetBrowser().KindName=="MSIE"&&Calysto.Features.GetBrowser().Version<=8,dd12.length!=1&&!isOldMsie&&!useBoxSizing){throw new Error("Self test dd12 failed in Calysto.DomQuery, result: "+dd12.length);}ddd=Calysto.DomQuery.CreateElement("div"),ddd.ApplyStyle("border:solid 1px blue; padding:5px;").AddChildren("<div style='position:absolute;border:solid 10px red;'>this is my div<\/div>").ChildNodes().ApplyStyle("border:solid 1px green; padding:5px;").InsertBefore(Calysto.DomQuery.CreateElement("div").ApplyStyle("border:5px solid red;").ForEach(o=>o.innerHTML="div 2"),Calysto.DomQuery.CreateElement("div").ApplyStyle("border:5px solid red;").ForEach(o=>o.innerHTML="div 3"),Calysto.DomQuery.CreateElement("div").ApplyStyle("border:5px solid red;").ForEach(o=>o.innerHTML="div 4"),"<div>first div<\/div><div>second div<\/div><div>third div<\/div>","some text node 4325",Calysto.DomQuery.CreateElement("div").ApplyStyle("border:5px solid red;").ForEach(o=>o.innerHTML="div 5")).ParentNodes().DescendantNodes().ApplyStyle("margin:5px;").Where(o=>o.childNodes&&o.childNodes.length==1);var html111=ddd.Select(function(o){return o.innerHTML.replace(/<[^>]+>/g,"")}).FirstOrDefault(),arr=ddd.DescendantNodes().Where(o=>o.nodeType==1).Select(o=>o.nodeValue||o.innerHTML).ToList(),hhtml=arr.ToStringJoined(", ");if(hhtml!="div 2, div 3, div 4, first div, second div, third div, div 5, this is my div"){throw new Error("SelfTest failed in test #html1, result: "+hhtml);}console.log("DomQuery test successful")}),Calysto.TestTools.TestRunner.AddTest(()=>{var text='{"OriginalFilename":"20.mp4","GuidFilename":"f553f4ac-0fda-486a-d501-f23afe25fb33.mp4","CreationDate":{"__calystotype":"Calysto_Date","Date":"2016-02-08 12:43:45.512"},"Size":405758,"Duration":5.534,"Description":"ywert","Items":[{"Url":"http://cms.24sata.hr/api/video-upload/get-media-id/","PostData":{"filename":"20.mp4","description":"ywert"},"ResponseXml":null,"Command":1,"FileID":null,"Extension":".mp4","Message":"The remote server returned an error: (403) Forbidden.","Path":null}],"FtpUploaders":[]}{"OriginalFilename":"120.mp4","GuidFilename":"f553f4ac-0fda-486a-d501-f23afe25fb33.mp4","CreationDate":{"__calystotype":"Calysto_Date","Date":"2016-02-08 12:43:45.512"},"Size":405758,"Duration":5.534,"Description":"ywert","Items":[{"Url":"http://cms.24sata.hr/api/video-upload/get-media-id/","PostData":{"filename":"20.mp4","description":"ywert"},"ResponseXml":null,"Command":1,"FileID":null,"Extension":".mp4","Message":"The remote server returned an error: (403) Forbidden.","Path":null}],"FtpUploaders":[]}{"OriginalFilename":"20.mp4","GuidFilename":"f553f4ac-0fda-486a-d501-f23afe25fb33.mp4","CreationDate":{"__calystotype":"Calysto_Date","Date":"2016-02-08 12:43:45.512"},"Size":405758,"Duration":5.534,"Description":"ywert","Items":[{"Url":"http://cms.24sata.hr/api/video-upload/get-media-id/","PostData":{"filename":"20.mp4","description":"ywert"},"ResponseXml":null,"Command":1,"FileID":null,"Extension":".mp4","Message":"The remote server returned an error: (403) Forbidden.","Path":null}],"FtpUploaders":[]}{"OriginalFilename":"120.mp4","GuidFilename":"f553f4ac-0fda-486a-d501-f23afe25fb33.mp4","CreationDate":{"__calystotype":"Calysto_Date","Date":"2016-02-08 12:43:45.512"},"Size":405758,"Duration":5.534,"Description":"ywert","Items":[{"Url":"http://cms.24sata.hr/api/video-upload/get-media-id/","PostData":{"filename":"20.mp4","description":"ywert"},"ResponseXml":null,"Command":1,"FileID":null,"Extension":".mp4","Message":"The remote server returned an error: (403) Forbidden.","Path":null}],"FtpUploaders":[]}{"OriginalFilename":"20.mp4","GuidFilename":"f553f4ac-0fda-486a-d501-f23afe25fb33.mp4","CreationDate":{"__calystotype":"Calysto_Date","Date":"2016-02-08 12:43:45.512"},"Size":405758,"Duration":5.534,"Description":"ywert","Items":[{"Url":"http://cms.24sata.hr/api/video-upload/get-media-id/","PostData":{"filename":"20.mp4","description":"ywert"},"ResponseXml":null,"Command":1,"FileID":null,"Extension":".mp4","Message":"The remote server returned an error: (403) Forbidden.","Path":null}],"FtpUploaders":[]}{"OriginalFilename":"120.mp4","GuidFilename":"f553f4ac-0fda-486a-d501-f23afe25fb33.mp4","CreationDate":{"__calystotype":"Calysto_Date","Date":"2016-02-08 12:43:45.512"},"Size":405758,"Duration":5.534,"Description":"ywert","Items":[{"Url":"http://cms.24sata.hr/api/video-upload/get-media-id/","PostData":{"filename":"20.mp4","description":"ywert"},"ResponseXml":null,"Command":1,"FileID":null,"Extension":".mp4","Message":"The remote server returned an error: (403) Forbidden.","Path":null}],"FtpUploaders":[]}{"OriginalFilename":"20.mp4","GuidFilename":"f553f4ac-0fda-486a-d501-f23afe25fb33.mp4","CreationDate":{"__calystotype":"Calysto_Date","Date":"2016-02-08 12:43:45.512"},"Size":405758,"Duration":5.534,"Description":"ywert","Items":[{"Url":"http://cms.24sata.hr/api/video-upload/get-media-id/","PostData":{"filename":"20.mp4","description":"ywert"},"ResponseXml":null,"Command":1,"FileID":null,"Extension":".mp4","Message":"The remote server returned an error: (403) Forbidden.","Path":null}],"FtpUploaders":[]}',c=new Calysto.Utility.StringCompressor,compr=c.Compress(text),decompr;if(compr==text){throw new Error("StringCompressor selftest error, compressed result: "+compr);}if(decompr=c.Decompress(compr),decompr!=text){throw new Error("StringCompressor selftest error, decompressed result: "+decompr);}console.log("StringCompressor test succesful")}),Calysto.TestTools.TestRunner.AddTest(()=>{var enc=new Calysto.Security.Cryptography.SimpleEncryptor("lozinka"),encrypted=Calysto.Utility.Encoding.RfcBase64.EncodeToBase64String(enc.Encrypt("this is my text čćžđš")),decrypted;if(encrypted!="LNnDGAHDGAFAkAEs5E8sAZMtkxl1IZNRdX4="){throw new Error("SimpleEncryptor.Encrypt() error, result: "+encrypted);}if(decrypted=enc.DecryptToString(Calysto.Utility.Encoding.RfcBase64.DecodeBase64StringToArray(encrypted)),decrypted!="this is my text čćžđš"){throw new Error("SimpleEncryptor.Decrypt() error, result: "+decrypted);}console.log("SimpleEncryptor test succesful")}),Calysto.TestTools.TestRunner.AddTest(()=>{var res1=[Calysto.Validate.IsEmail("myname@mfsd"),Calysto.Validate.IsEmail("myname@mfsd.com"),Calysto.Validate.IsEmail("myname.me@mfsd"),Calysto.Validate.IsEmail("myname.me@mfsd.com"),"---",Calysto.Validate.CanConvertToNumber("gasdfg"),Calysto.Validate.CanConvertToNumber("gasdf432523"),Calysto.Validate.CanConvertToNumber("234.532"),Calysto.Validate.CanConvertToNumber("23,4532.63"),"---",Calysto.Validate.CanConvertToDecimal("234.532"),Calysto.Validate.ContainsNumber("f423gsda6234"),"---",Calysto.Validate.CanConvertToInteger("-432.652354"),Calysto.Validate.IsIPv4Address("4234"),Calysto.Validate.IsIPv4Address("234"),Calysto.Validate.IsIPv4Address("234.23.4.5"),Calysto.Validate.IsIPv4Address("234.23.4")];if(res1.join(";")!="false;true;false;true;---;false;false;true;true;---;true;true;---;false;false;false;true;false"){throw new Error("Validate error, result: "+res1.join(";"));}console.log("Validate test successful")}),Calysto.TestTools.TestRunner.AddTest(()=>{function TestDiagnosticString(uri,expected){let s1=Object.getOwnPropertyNames(uri).Select(prop=>prop+":::"+uri[prop]).ToStringJoined(";;;");if(s1!=expected){throw new Error("Uri error, expected: "+expected+", result: "+s1);}}TestDiagnosticString(new Calysto.Uri("https://85.114.41.97/"),"Scheme:::https;;;Username:::;;;Password:::;;;Host:::85.114.41.97;;;Port:::;;;Path:::/;;;Query:::;;;Hash:::"),TestDiagnosticString(new Calysto.Uri("http://domena.com:43/nesto/dva/dru.aspx?qu=3&gr=3#dd=rel"),"Scheme:::http;;;Username:::;;;Password:::;;;Host:::domena.com;;;Port:::43;;;Path:::/nesto/dva/dru.aspx;;;Query:::?qu=3&gr=3;;;Hash:::#dd=rel"),TestDiagnosticString(new Calysto.Uri("http://domaena.com:233/../dva.aspx?a=10&b=22#dva"),"Scheme:::http;;;Username:::;;;Password:::;;;Host:::domaena.com;;;Port:::233;;;Path:::/../dva.aspx;;;Query:::?a=10&b=22;;;Hash:::#dva"),TestDiagnosticString(new Calysto.Uri("http://domain.com/?m=10"),"Scheme:::http;;;Username:::;;;Password:::;;;Host:::domain.com;;;Port:::;;;Path:::/;;;Query:::?m=10;;;Hash:::"),TestDiagnosticString(new Calysto.Uri("http://username:password@www.nesto.com:1233/mypath/bill.aspx?a=10&b=20#c=3&c=4"),"Scheme:::http;;;Username:::username;;;Password:::password;;;Host:::www.nesto.com;;;Port:::1233;;;Path:::/mypath/bill.aspx;;;Query:::?a=10&b=20;;;Hash:::#c=3&c=4"),TestDiagnosticString(new Calysto.Uri("/"),"Scheme:::;;;Username:::;;;Password:::;;;Host:::;;;Port:::;;;Path:::/;;;Query:::;;;Hash:::"),TestDiagnosticString(new Calysto.Uri("/some/path.aspx"),"Scheme:::;;;Username:::;;;Password:::;;;Host:::;;;Port:::;;;Path:::/some/path.aspx;;;Query:::;;;Hash:::"),TestDiagnosticString(new Calysto.Uri("?q=13&b=32"),"Scheme:::;;;Username:::;;;Password:::;;;Host:::;;;Port:::;;;Path:::;;;Query:::?q=13&b=32;;;Hash:::"),console.log("Uri test successful")}),Calysto.TestTools.TestRunner.AddTest(()=>{let results=[],OnTest=(new Calysto.MulticastDelegate).OnAdd(delegate=>{results.push("in_OnAdd"),delegate("ante",10,false)}).AsFunc({Prop1:true,Prop2:false});OnTest((name,age,isWhite)=>{results.push("Invocation"),results.push({name:name,age:age,isWhite:isWhite})}),OnTest.Invoke(f=>f("jura",22,true)),OnTest.Invoke(f=>f("karmen",55,false)),OnTest.Invoke(f=>f("junior",11,true)),OnTest.Invoke();let res1=Calysto.Json.Serialize(results);if(res1!=`["in_OnAdd","Invocation",{"name":"ante","age":10,"isWhite":false},"Invocation",{"name":"jura","age":22,"isWhite":true},"Invocation",{"name":"karmen","age":55,"isWhite":false},"Invocation",{"name":"junior","age":11,"isWhite":true},"Invocation",{"name":null,"age":null,"isWhite":null}]`){throw new Error("Error in Calysto.MulticastDelegate, result1: "+res1);}console.log("MulticastDelegate test successful")}),Calysto.TestTools.TestRunner.AddTest(()=>{let culture1=Calysto.Globalization.CultureInfo.CurrentCulture;Calysto.Globalization.CultureInfo.CurrentCulture=Calysto.Globalization.CultureInfo.USCulture;let pp=Calysto.Resources.CalystoLang.ResourceProvider;Calysto.TestTools.UnitTesting.Assert.AreEqual("Invocation forbidden",pp.GetString("MethodInvocationFobidden")),Calysto.TestTools.UnitTesting.Assert.AreEqual("Invocation forbidden",pp.GetString("MethodInvocationFobidden",["en-US"])),Calysto.TestTools.UnitTesting.Assert.AreEqual("Nemate dozvolu za ovu akciju",pp.GetString("MethodInvocationFobidden",["hr-HR"])),Calysto.TestTools.UnitTesting.Assert.ThrowsException(()=>pp.GetString("MethodInvocationFobidden",["nonexisting property"])),Calysto.TestTools.UnitTesting.Assert.AreEqual("Please wait, page is reloading...",pp.GetString("PageIsReloadingPleaseWait")),Calysto.TestTools.UnitTesting.Assert.AreEqual("Please wait, page is reloading...",pp.GetString("PageIsReloadingPleaseWait",["en-US"])),Calysto.TestTools.UnitTesting.Assert.AreEqual("Molimo pričekajte, stranica se osvježava...",pp.GetString("PageIsReloadingPleaseWait",["hr-HR"])),Calysto.TestTools.UnitTesting.Assert.ThrowsException(()=>pp.GetString("PageIsReloadingPleaseWait",["nonexisting property"])),Calysto.Globalization.CultureInfo.CurrentCulture=culture1}),function(Calysto){var Tasks;(function(Tasks){Calysto.TestTools.TestRunner.AddTest(()=>__awaiter(this,void 0,void 0,function*(){function PromiseTest(promiseName,promiseCtor){return __awaiter(this,void 0,void 0,function*(){function GetName(){return __awaiter(this,void 0,void 0,function*(){return new promiseCtor(resolve=>{result1.push("#1"),setTimeout(()=>resolve("success1"),t1)}).then(value=>{result1.push("#2"),result1.push(value);return value}).then(value=>{result1.push("#3"),result1.push(value);return new promiseCtor(resolve=>{setTimeout(()=>{result1.push("#4"),resolve("success2222")},t1)})}).then(value=>{result1.push("#5"),result1.push(value);return new promiseCtor(resolve=>{setTimeout(()=>{result1.push("#6"),resolve("success1111")},t1)})}).catch(err=>{result1.push("#7"),result1.push(err);return"dva"}).finally(()=>{result1.push("#8");return"amd"})})}function ShowResult(){return __awaiter(this,void 0,void 0,function*(){let res1=yield GetName();result1.push(res1)})}let t1=200,result1=[];result1.push("s0"),ShowResult(),result1.push("s1"),setTimeout(()=>{let str1=result1.ToStringJoined(", ");Calysto.TestTools.UnitTesting.Assert.AreEqual("s0, #1, s1, s2, s3, #2, success1, #3, success1, #4, #5, success2222, #6, #8, success1111",str1),console.log(promiseName+" test successful")},t1*3.5),result1.push("s2"),setTimeout(()=>{let str1=result1.ToStringJoined(", ");Calysto.TestTools.UnitTesting.Assert.AreEqual("s0, #1, s1, s2, s3, #2, success1, #3, success1, #4, #5, success2222",str1)},t1*2.5),result1.push("s3"),setTimeout(()=>{let str1=result1.ToStringJoined(", ");Calysto.TestTools.UnitTesting.Assert.AreEqual("s0, #1, s1, s2, s3",str1)},t1*.5);return new promiseCtor(resolve=>{setTimeout(()=>resolve(),t1*4)})})}yield PromiseTest("CPromise",Tasks.CPromise);yield PromiseTest("Promise",window.Promise)}))})(Tasks=Calysto.Tasks||(Calysto.Tasks={}))}(Calysto||(Calysto={}))